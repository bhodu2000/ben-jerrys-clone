[WARN ] 25-10-04 00:26:41 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=39m41s553ms).
[WARN ] 25-10-04 00:31:05 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=3m53s719ms).
[WARN ] 25-10-04 01:27:46 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=56m10s882ms).
[WARN ] 25-10-04 01:33:34 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=5m17s886ms).
[WARN ] 25-10-04 02:28:41 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=55m7s275ms).
[WARN ] 25-10-04 02:31:55 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m44s338ms).
[WARN ] 25-10-04 03:37:21 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h4m55s926ms).
[WARN ] 25-10-04 04:31:51 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=54m29s677ms).
[WARN ] 25-10-04 05:33:04 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h43s122ms).
[WARN ] 25-10-04 06:34:17 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h43s76ms).
[WARN ] 25-10-04 07:35:00 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h42s949ms).
[WARN ] 25-10-04 08:36:13 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h43s70ms).
[WARN ] 25-10-04 09:35:06 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=58m52s375ms).
[WARN ] 25-10-04 09:37:09 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m33s726ms).
[WARN ] 25-10-04 09:41:04 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=3m54s326ms).
[WARN ] 25-10-04 09:46:27 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=4m53s304ms).
[WARN ] 25-10-04 09:51:21 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=4m24s541ms).
[WARN ] 25-10-04 09:53:31 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m9s86ms).
[INFO ] 25-10-04 09:57:12 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 7606 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 09:57:12 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 09:57:12 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 09:57:16 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.344 seconds (process running for 6.3)
[INFO ] 25-10-04 09:58:43 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 09:58:43 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 09:58:43 [MyInterceptor:85] - [GET] http://localhost:8080/
[INFO ] 25-10-04 09:58:46 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 09:58:46 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 09:58:46 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[DEBUG] 25-10-04 09:58:47 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 09:58:47 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 09:58:47 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 09:58:47 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 09:58:47 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 09:58:47 [MyInterceptor:122] - running time: 945(ms)
[INFO ] 25-10-04 10:03:27 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 10:03:27 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 10:03:27 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/berry-berry-extraordinary-sorbet/
[INFO ] 25-10-04 10:03:27 [MyInterceptor:101] - - REFERER : time=279660, url=http://localhost:8080/flavours/ice-cream-shop-flavours
[DEBUG] 25-10-04 10:03:27 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 10:03:27 [existsCategorySlug:135] - ==> Parameters: berry-berry-extraordinary-sorbet(String)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'berry-berry-extraordinary-sorbet'

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 10:03:27 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 10:03:27 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 10:03:27 [selectVariantDetailDefault:135] - ==> Parameters: berry-berry-extraordinary-sorbet(String)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'berry-berry-extraordinary-sorbet'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|------|------------------------------------------------------------------------|------|---------------------------------|----------------|---------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                  |id    |slug                             |name_ko         |description_ko                   |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------|------|---------------------------------|----------------|---------------------------------|-------|-----------|------------------------|--------|
|30042 |벤앤제리스만의 특별한 베리 맛, 흔하게 맛 볼 수 없는 기쁨의 맛! 상큼한 베리의 조합은 당신이 생각한 무엇보다도 놀라울 거예요 |20018 |berry-berry-extraordinary-sorbet |베리베리 엑스트라 오디너리® |블루베리와 라즈베리 등 각종 베리류가 듬뿍 들어있는 소르베 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------|------|---------------------------------|----------------|---------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-04 10:03:27 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-04 10:03:27 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 10:03:27 [selectVariantMedia:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30042
  ORDER BY role, sort_order

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|---------|-----------------------------------------------------------------------------------|---------------------|-----------|
|role     |url                                                                                |alt_ko               |sort_order |
|---------|-----------------------------------------------------------------------------------|---------------------|-----------|
|PACKSHOT |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png |베리베리 엑스트라 오디너리 스쿱 팩샷 |0          |
|---------|-----------------------------------------------------------------------------------|---------------------|-----------|

[DEBUG] 25-10-04 10:03:27 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-04 10:03:27 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 10:03:27 [selectVariantGallery:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30042
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-04 10:03:27 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-04 10:03:27 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 10:03:27 [selectVariantIngredients:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30042

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                          |smartlabel_url |
|----------------------------------------------------------------------------------------------------------------------------------------|---------------|
|물, 액상당(설탕, 물), 블루베리 농축 퓨레, 라즈베리 퓨레, 고형 옥수수 시럽, 블루베리 농축액, 설탕, 이눌린(이눌린, 설탕, 과당, 포도당), 블루베리 농축액, 레몬 농축액, 펙틴, 로커스트빈검, 덱스트로오스, 엘더베리 농축액(색소). |null           |
|----------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 10:03:27 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 10:03:27 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 10:03:27 [selectVariantSourcing:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30042
ORDER BY vs.sort_order

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 10:03:27 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 10:03:27 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 10:03:27 [selectVariantCerts:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30042
ORDER BY vc.sort_order

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 10:03:27 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 10:03:27 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 10:03:27 [selectRecommendations:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30042
ORDER BY r.slot

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30037 |lemonade-sorbet                      |레모네이드 소르베   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                      |0         |
|30032 |chocolate-ice-cream                  |초콜릿         |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                  |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 10:03:27 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 10:03:27 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 10:03:27 [selectAvailableCategories:135] - ==> Parameters: 20018(Long)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20018
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30042 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 10:03:27 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 10:03:27 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 10:03:27 [findNextVariant:135] - ==> Parameters: 30042(Long), 30042(Long), 30042(Long), 30042(Long), 30042(Long), 30042(Long)
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30042))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30042)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30042)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30042)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30042)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30042)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|---|-----|-----|
|id |slug |slug |
|---|-----|-----|
|---|-----|-----|

[DEBUG] 25-10-04 10:03:27 [findNextVariant:135] - <==      Total: 0
[DEBUG] 25-10-04 10:03:27 [findFirstVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 10:03:27 [findFirstVariant:135] - ==> Parameters: 
[INFO ] 25-10-04 10:03:27 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 10:03:27 [resultsettable:610] - 
|------|-------------------------------------|-----|
|id    |slug                                 |slug |
|------|-------------------------------------|-----|
|30010 |new-york-super-fudge-chunk-ice-cream |pint |
|------|-------------------------------------|-----|

[DEBUG] 25-10-04 10:03:27 [findFirstVariant:135] - <==      Total: 1
[INFO ] 25-10-04 10:03:27 [MyInterceptor:122] - running time: 359(ms)
[INFO ] 25-10-04 10:03:34 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 10:03:34 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 10:03:34 [MyInterceptor:85] - [GET] http://localhost:8080/about-us/how-we-make-ice-cream
[INFO ] 25-10-04 10:03:34 [MyInterceptor:101] - - REFERER : time=7266, url=http://localhost:8080/flavours/berry-berry-extraordinary-sorbet/
[INFO ] 25-10-04 10:03:45 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 10:03:45 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 10:03:45 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-ice-cream/scoop-shop
[INFO ] 25-10-04 10:03:45 [MyInterceptor:101] - - REFERER : time=18035, url=http://localhost:8080/flavours/berry-berry-extraordinary-sorbet/
[DEBUG] 25-10-04 10:03:45 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 10:03:45 [selectVariantDetail:135] - ==> Parameters: chocolate-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-04 10:03:45 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-04 10:03:45 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                                |id    |slug                |name_ko |description_ko |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|30032 |저희 초콜릿 아이스크림은 공정무역 인증® 코코아에서 초콜릿 맛을 얻습니다. 공정무역은 코코아 재배자들이 그들의 수확에 대한 공정한 가격을 보장하고, 그들이 그들의 땅과 생계를 보호하고, 그들의 가족을 위해 제공하고, 그들의 미래에 투자할 수 있도록 합니다. 즐기세요! |20014 |chocolate-ice-cream |초콜릿     |초콜릿 아이스크림      |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-04 10:03:45 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 10:03:45 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 10:03:45 [selectVariantMedia:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 10:03:45 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30032
  ORDER BY role, sort_order

[INFO ] 25-10-04 10:03:45 [resultsettable:610] - 
|---------|----------------------------------------------------------------------|----------|-----------|
|role     |url                                                                   |alt_ko    |sort_order |
|---------|----------------------------------------------------------------------|----------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png |초콜릿 스쿱 팩샷 |0          |
|---------|----------------------------------------------------------------------|----------|-----------|

[DEBUG] 25-10-04 10:03:45 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-04 10:03:45 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 10:03:45 [selectVariantGallery:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 10:03:45 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30032
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 10:03:45 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-04 10:03:45 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-04 10:03:45 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 10:03:45 [selectVariantIngredients:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 10:03:45 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30032

[INFO ] 25-10-04 10:03:45 [resultsettable:610] - 
|--------------------------------------------------------|---------------|
|ingredients_ko                                          |smartlabel_url |
|--------------------------------------------------------|---------------|
|유크림, 설탕시럽(설탕, 정제수), 탈지농축우유, 정제수, 코코아분말, 가당난황, 구아검, 카라기난 |null           |
|--------------------------------------------------------|---------------|

[DEBUG] 25-10-04 10:03:45 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 10:03:45 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 10:03:45 [selectVariantSourcing:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 10:03:45 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30032
ORDER BY vs.sort_order

[INFO ] 25-10-04 10:03:45 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-04 10:03:45 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-04 10:03:45 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 10:03:45 [selectVariantCerts:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 10:03:45 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30032
ORDER BY vc.sort_order

[INFO ] 25-10-04 10:03:45 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 10:03:45 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 10:03:45 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 10:03:45 [selectRecommendations:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 10:03:45 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30032
ORDER BY r.slot

[INFO ] 25-10-04 10:03:45 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30038 |mint-chocolate-chunk-ice-cream       |민트 초콜릿 청크   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png       |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30031 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png              |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 10:03:45 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 10:03:45 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 10:03:45 [selectAvailableCategories:135] - ==> Parameters: 20014(Long)
[INFO ] 25-10-04 10:03:45 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20014
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 10:03:45 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30032 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 10:03:45 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 10:03:45 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 10:03:45 [findNextVariant:135] - ==> Parameters: 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long)
[INFO ] 25-10-04 10:03:45 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30032))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30032)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 10:03:45 [resultsettable:610] - 
|------|--------------------------------------|-----------|
|id    |slug                                  |slug       |
|------|--------------------------------------|-----------|
|30033 |chocolate-chip-cookie-dough-ice-cream |scoop-shop |
|------|--------------------------------------|-----------|

[DEBUG] 25-10-04 10:03:45 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 10:03:45 [MyInterceptor:122] - running time: 156(ms)
[INFO ] 25-10-04 10:04:54 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 10:04:54 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 10:04:54 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[INFO ] 25-10-04 10:04:54 [MyInterceptor:101] - - REFERER : time=68430, url=http://localhost:8080/flavours/berry-berry-extraordinary-sorbet/
[DEBUG] 25-10-04 10:04:54 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 10:04:54 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 10:04:54 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 10:04:54 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 10:04:54 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 10:04:54 [MyInterceptor:122] - running time: 83(ms)
[INFO ] 25-10-04 10:05:28 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 10:05:28 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 10:05:28 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[INFO ] 25-10-04 10:05:28 [MyInterceptor:101] - - REFERER : time=33880, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 10:05:28 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 10:05:28 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-04 10:05:28 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-04 10:05:28 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                          |id    |slug                                 |name_ko     |description_ko                              |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|
|30039 |오늘부턴 나도 뉴요커! 고소한 아몬드, 호두와 풍부한 초콜릿의 맛이 당신에게 잊을 수 없는 순간을 선물합니다. 뉴욕의 풍부하고 깊은 맛을 사랑하는 사람과 함께 즐겨보세요! |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-04 10:05:28 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 10:05:28 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 10:05:28 [selectVariantMedia:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 10:05:28 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30039
  ORDER BY role, sort_order

[INFO ] 25-10-04 10:05:28 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                       |alt_ko            |sort_order |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png    |뉴욕 수퍼 퍼지 청크 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-04 10:05:28 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-04 10:05:28 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 10:05:28 [selectVariantGallery:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 10:05:28 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30039
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 10:05:28 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                       |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 10:05:28 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-04 10:05:28 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 10:05:28 [selectVariantIngredients:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 10:05:28 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30039

[INFO ] 25-10-04 10:05:28 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                |smartlabel_url |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |null           |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 10:05:28 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 10:05:28 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 10:05:28 [selectVariantSourcing:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 10:05:28 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30039
ORDER BY vs.sort_order

[INFO ] 25-10-04 10:05:28 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 10:05:28 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 10:05:28 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 10:05:28 [selectVariantCerts:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 10:05:28 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30039
ORDER BY vc.sort_order

[INFO ] 25-10-04 10:05:28 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 10:05:28 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 10:05:28 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 10:05:28 [selectRecommendations:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 10:05:28 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30039
ORDER BY r.slot

[INFO ] 25-10-04 10:05:28 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|30035 |chunky-monkey-ice-cream               |청키 몽키®      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |0         |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |0         |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 10:05:28 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 10:05:28 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 10:05:28 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-04 10:05:28 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 10:05:28 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 10:05:28 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 10:05:28 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 10:05:28 [findNextVariant:135] - ==> Parameters: 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long)
[INFO ] 25-10-04 10:05:28 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30039))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30039)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 10:05:28 [resultsettable:610] - 
|------|-------------------------------|-----------|
|id    |slug                           |slug       |
|------|-------------------------------|-----------|
|30038 |mint-chocolate-chunk-ice-cream |scoop-shop |
|------|-------------------------------|-----------|

[DEBUG] 25-10-04 10:05:28 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 10:05:28 [MyInterceptor:122] - running time: 120(ms)
[INFO ] 25-10-04 10:05:43 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 10:05:43 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 10:05:43 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[INFO ] 25-10-04 10:05:43 [MyInterceptor:101] - - REFERER : time=15108, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[DEBUG] 25-10-04 10:05:43 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 10:05:43 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), pint(String)
[INFO ] 25-10-04 10:05:43 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 10:05:43 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                 |id    |slug                                 |name_ko     |description_ko                              |is_new |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----|----------------|--------|
|30010 |1985년에 벤앤제리스는 뉴욕만의 새로운 플레이버로 다양한 종류의 청크들을 넣은 뉴욕 수퍼 퍼지 청크를 탄생시켰습니다. 뉴욕에서도 인기있는 플레이버라면 어디서든 맛 볼 수 있을거라 생각했어요. 실제로도 그렇고요. |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-04 10:05:43 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 10:05:43 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 10:05:43 [selectVariantMedia:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 10:05:43 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30010
  ORDER BY role, sort_order

[INFO ] 25-10-04 10:05:43 [resultsettable:610] - 
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                     |alt_ko             |sort_order |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |뉴욕 수퍼 퍼지 청크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 10:05:43 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 10:05:43 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 10:05:43 [selectVariantGallery:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 10:05:43 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30010
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 10:05:43 [resultsettable:610] - 
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                     |alt_ko |sort_order |
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 10:05:43 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 10:05:43 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 10:05:43 [selectVariantIngredients:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 10:05:43 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30010

[INFO ] 25-10-04 10:05:43 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                |smartlabel_url                                                                                                           |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100149-0002-en-US-1670951315103/index.html#nutrition |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 10:05:43 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 10:05:43 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 10:05:43 [selectVariantSourcing:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 10:05:43 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30010
ORDER BY vs.sort_order

[INFO ] 25-10-04 10:05:43 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 10:05:43 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 10:05:43 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 10:05:43 [selectVariantCerts:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 10:05:43 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30010
ORDER BY vc.sort_order

[INFO ] 25-10-04 10:05:43 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 10:05:43 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 10:05:43 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 10:05:43 [selectRecommendations:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 10:05:43 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30010
ORDER BY r.slot

[INFO ] 25-10-04 10:05:43 [resultsettable:610] - 
|------|------------------------------|------------|-------|-----|----------------|--------|----------------------------------------------------------------------------|----------|
|id    |slug                          |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                    |sortorder |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream       |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg       |5         |
|30011 |peanut-butter-cup-ice-cream   |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30012 |pistachio-pistachio-ice-cream |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 10:05:43 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 10:05:43 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 10:05:43 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-04 10:05:43 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 10:05:43 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 10:05:43 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 10:05:43 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 10:05:43 [findNextVariant:135] - ==> Parameters: 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long)
[INFO ] 25-10-04 10:05:43 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30010))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30010)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 10:05:43 [resultsettable:610] - 
|------|--------------------------------|-----|
|id    |slug                            |slug |
|------|--------------------------------|-----|
|30009 |mint-chocolate-cookie-ice-cream |pint |
|------|--------------------------------|-----|

[DEBUG] 25-10-04 10:05:43 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 10:05:43 [MyInterceptor:122] - running time: 210(ms)
[INFO ] 25-10-04 10:08:01 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 10:08:01 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 10:08:01 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[INFO ] 25-10-04 10:08:01 [MyInterceptor:101] - - REFERER : time=137486, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 10:08:01 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 10:08:01 [selectVariantDetail:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String), pint(String)
[INFO ] 25-10-04 10:08:01 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-cheesecake-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 10:08:01 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                   |id    |slug                            |name_ko     |description_ko                    |is_new |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|
|30004 |항상 치즈케이크를 먹고 싶어하는 애호가들을 위해 딸기 과육이 가득하고, 부드러운 치즈케이크의 풍미와 환상적인 그라함 크래커 스월이 가득 찬 아이스크림 입니다. |20004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림 |true   |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-04 10:08:01 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 10:08:01 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 10:08:01 [selectVariantMedia:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 10:08:01 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30004
  ORDER BY role, sort_order

[INFO ] 25-10-04 10:08:01 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                            |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png    |스트로베리 치즈케이크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null               |1          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null               |5          |
|NUTRITION |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/nutrition/473ml.png  |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 10:08:01 [selectVariantMedia:135] - <==      Total: 4
[DEBUG] 25-10-04 10:08:01 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 10:08:01 [selectVariantGallery:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 10:08:01 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30004
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 10:08:01 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null   |1          |
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 10:08:01 [selectVariantGallery:135] - <==      Total: 2
[DEBUG] 25-10-04 10:08:01 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 10:08:01 [selectVariantIngredients:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 10:08:01 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30004

[INFO ] 25-10-04 10:08:01 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                    |smartlabel_url |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|아이스크림믹스[유크림, 탈지우유, 정제수, 설탕시럽 (설탕, 정제수), 가당난황, 구아검, 카라기난], 그라함크래커[기타설탕, 옥수수전분, 카놀라유, 대두유, 밀가루], 딸기다이스 [딸기, 설탕, 구아검, 레몬농축과즙], 치즈케이크베이스[설탕, 정제수, 크림치즈, 향료, 젖산], 딸기퓌레 |null           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 10:08:01 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 10:08:01 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 10:08:01 [selectVariantSourcing:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 10:08:01 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30004
ORDER BY vs.sort_order

[INFO ] 25-10-04 10:08:01 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Open Chain Sourcing           |/assets/img/misc/90008_Cocoa_Sourcing_VLS_Simpler_Icons.avif                |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 10:08:01 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-04 10:08:01 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 10:08:01 [selectVariantCerts:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 10:08:01 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30004
ORDER BY vc.sort_order

[INFO ] 25-10-04 10:08:01 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 10:08:01 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 10:08:01 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 10:08:01 [selectRecommendations:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 10:08:01 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30004
ORDER BY r.slot

[INFO ] 25-10-04 10:08:01 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream   |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30006 |cherry-garcia-ice-cream           |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg           |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 10:08:01 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 10:08:01 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 10:08:01 [selectAvailableCategories:135] - ==> Parameters: 20004(Long)
[INFO ] 25-10-04 10:08:01 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20004
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 10:08:01 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30004 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 10:08:01 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 10:08:01 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 10:08:01 [findNextVariant:135] - ==> Parameters: 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long)
[INFO ] 25-10-04 10:08:01 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30004))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30004)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 10:08:01 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30001 |chunky-monkey-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-04 10:08:01 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 10:08:01 [MyInterceptor:122] - running time: 122(ms)
[INFO ] 25-10-04 10:08:20 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 10:08:20 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 10:08:20 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[INFO ] 25-10-04 10:08:20 [MyInterceptor:101] - - REFERER : time=19391, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[DEBUG] 25-10-04 10:08:20 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 10:08:20 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 10:08:20 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 10:08:20 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-04 10:08:20 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 10:08:20 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 10:08:20 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 10:08:20 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 10:08:20 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 10:08:20 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 10:08:20 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 10:08:20 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 10:08:20 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 10:08:20 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 10:08:20 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 10:08:20 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 10:08:20 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 10:08:20 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 10:08:20 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 10:08:20 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 10:08:20 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 10:08:20 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 10:08:20 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 10:08:20 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 10:08:20 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 10:08:20 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 10:08:20 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 10:08:20 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 10:08:20 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 10:08:20 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 10:08:20 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 10:08:20 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 10:08:20 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 10:08:20 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 10:08:20 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 10:08:20 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 10:08:20 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 10:08:20 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 10:08:20 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 10:08:20 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 10:08:20 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 10:08:20 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 10:08:20 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 10:08:20 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 10:08:20 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 10:08:20 [MyInterceptor:122] - running time: 137(ms)
[INFO ] 25-10-04 10:17:39 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 7606 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 10:17:39 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 10:17:39 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 10:17:40 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.589 seconds (process running for 1230.405)
[INFO ] 25-10-04 10:25:55 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 7606 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 10:25:55 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 10:25:55 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[WARN ] 25-10-04 10:25:56 [AnnotationConfigServletWebServerApplicationContext:635] - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'flavourController' defined in file [/Users/sieun/ben-jerrys-clone/build/classes/java/main/kr/bhodu/benjerrysclone/controllers/FlavourController.class]: Unsatisfied dependency expressed through constructor parameter 0: No qualifying bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
[ERROR] 25-10-04 10:25:56 [LoggingFailureAnalysisReporter:40] - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in kr.bhodu.benjerrysclone.controllers.FlavourController required a bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' that could not be found.


Action:

Consider defining a bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' in your configuration.

[INFO ] 25-10-04 10:25:58 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 7606 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 10:25:58 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 10:25:58 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 10:25:58 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 0.729 seconds (process running for 1728.594)
[INFO ] 25-10-04 10:28:02 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 7606 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 10:28:02 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 10:28:02 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 10:28:03 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.024 seconds (process running for 1853.305)
[INFO ] 25-10-04 11:15:20 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 7606 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:15:20 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:15:20 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:15:21 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.386 seconds (process running for 4691.237)
[INFO ] 25-10-04 11:20:18 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 7606 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:20:18 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:20:18 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:20:19 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.094 seconds (process running for 4988.682)
[INFO ] 25-10-04 11:20:47 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 7606 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:20:47 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:20:47 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:20:48 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 0.94 seconds (process running for 5017.84)
[INFO ] 25-10-04 11:22:50 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 13762 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:22:50 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:22:50 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:22:54 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.433 seconds (process running for 6.339)
[INFO ] 25-10-04 11:23:13 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:23:13 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:23:13 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 11:23:14 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, ft.code AS flavourTypeCode FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:23:14 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:23:14 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
       ft.code AS flavourTypeCode
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:23:14 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |code               |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |ORIGINAL ICE CREAM |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|

[DEBUG] 25-10-04 11:23:14 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:23:14 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:23:14 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:23:14 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:23:14 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:23:14 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:23:14 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:23:14 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:23:14 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:23:14 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:23:14 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:23:14 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:23:14 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:23:14 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:23:14 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:23:14 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:23:14 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:23:14 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:23:14 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:23:14 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:23:14 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:23:14 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:23:14 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:23:14 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:23:14 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:23:14 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:23:14 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:23:14 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:23:14 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 11:23:14 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 11:23:14 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 11:23:14 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 11:23:14 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 11:23:14 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 11:23:14 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 11:23:14 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 11:23:14 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 11:23:14 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 11:23:14 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 11:23:14 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 11:23:14 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 11:23:14 [MyInterceptor:122] - running time: 1491(ms)
[WARN ] 25-10-04 11:30:00 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m46s541ms).
[INFO ] 25-10-04 11:32:18 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:32:18 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:32:18 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[INFO ] 25-10-04 11:32:18 [MyInterceptor:101] - - REFERER : time=543595, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[DEBUG] 25-10-04 11:32:18 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, ft.code AS flavourTypeCode FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:32:18 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:32:18 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
       ft.code AS flavourTypeCode
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:32:18 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |code               |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |ORIGINAL ICE CREAM |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|

[DEBUG] 25-10-04 11:32:18 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:32:18 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:32:18 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:18 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:32:18 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:32:18 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:32:18 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:32:18 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:18 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:32:18 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:32:18 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:32:18 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:32:18 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:18 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:32:18 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:32:18 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:32:18 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:32:18 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:18 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:32:18 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:32:18 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:32:18 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:32:18 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:18 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:32:18 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:32:18 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:32:18 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:32:18 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:18 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 11:32:18 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 11:32:18 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 11:32:18 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 11:32:18 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 11:32:18 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 11:32:18 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 11:32:18 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 11:32:18 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 11:32:18 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 11:32:18 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 11:32:18 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 11:32:18 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 11:32:18 [MyInterceptor:122] - running time: 212(ms)
[INFO ] 25-10-04 11:32:23 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:32:23 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:32:23 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 11:32:29 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:32:29 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:32:29 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[INFO ] 25-10-04 11:32:29 [MyInterceptor:101] - - REFERER : time=11147, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[DEBUG] 25-10-04 11:32:29 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, ft.code AS flavourTypeCode FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:32:29 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:32:29 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
       ft.code AS flavourTypeCode
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:32:29 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |code               |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |ORIGINAL ICE CREAM |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|

[DEBUG] 25-10-04 11:32:29 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:32:29 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:32:29 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:29 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:32:29 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:32:29 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:32:29 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:32:29 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:29 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:32:29 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:32:29 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:32:29 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:32:29 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:29 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:32:29 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:32:29 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:32:29 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:32:29 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:29 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:32:29 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:32:29 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:32:29 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:32:29 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:29 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:32:29 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:32:29 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:32:29 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:32:29 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:32:29 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 11:32:29 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 11:32:29 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 11:32:29 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 11:32:29 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 11:32:29 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 11:32:29 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 11:32:29 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 11:32:29 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 11:32:29 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 11:32:29 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 11:32:29 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 11:32:29 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 11:32:29 [MyInterceptor:122] - running time: 141(ms)
[INFO ] 25-10-04 11:32:29 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:32:29 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:32:29 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 11:33:40 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 13762 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:33:40 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:33:40 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:33:43 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 14455 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:33:43 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:33:43 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:33:48 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.06 seconds (process running for 5.847)
[INFO ] 25-10-04 11:33:55 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:33:56 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:33:56 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 11:33:56 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, ft.code AS flavourTypeCode FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:33:56 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:33:56 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
       ft.code AS flavourTypeCode
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:33:56 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |code               |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |ORIGINAL ICE CREAM |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|

[DEBUG] 25-10-04 11:33:56 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:33:57 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:33:57 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:33:57 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:33:57 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:33:57 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:33:57 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:33:57 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:33:57 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:33:57 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:33:57 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:33:57 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:33:57 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:33:57 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:33:57 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:33:57 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:33:57 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:33:57 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:33:57 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:33:57 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:33:57 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:33:57 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:33:57 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:33:57 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:33:57 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:33:57 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:33:57 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:33:57 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:33:57 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 11:33:57 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 11:33:57 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 11:33:57 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 11:33:57 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 11:33:57 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 11:33:57 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 11:33:57 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 11:33:57 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 11:33:57 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 11:33:57 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 11:33:57 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 11:33:57 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 11:33:57 [MyInterceptor:122] - running time: 1169(ms)
[INFO ] 25-10-04 11:33:57 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:33:58 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:33:58 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 11:34:09 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 14455 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:34:09 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:34:09 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:34:10 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.364 seconds (process running for 28.432)
[INFO ] 25-10-04 11:43:58 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 14455 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:43:58 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:43:58 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:43:59 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.195 seconds (process running for 617.607)
[INFO ] 25-10-04 11:44:12 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 15240 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:44:12 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:44:12 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:44:17 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.515 seconds (process running for 6.38)
[INFO ] 25-10-04 11:44:35 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:44:35 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:44:35 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 11:44:36 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, ft.code AS flavourTypeCode FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:44:36 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:44:36 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
       ft.code AS flavourTypeCode
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:44:36 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |code               |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |ORIGINAL ICE CREAM |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|

[DEBUG] 25-10-04 11:44:36 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:44:36 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:44:36 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:44:36 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:44:36 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:44:36 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:44:36 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:44:36 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:44:36 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:44:36 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:44:36 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:44:36 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:44:36 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:44:36 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:44:36 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:44:36 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:44:36 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:44:36 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:44:36 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:44:36 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:44:36 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:44:36 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:44:36 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:44:36 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:44:36 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:44:36 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:44:36 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:44:36 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:44:36 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[ERROR] 25-10-04 11:44:36 [sqlonly:144] - 1. PreparedStatement.execute() SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, ' at line 12
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:383)
	at net.sf.log4jdbc.sql.jdbcapi.PreparedStatementSpy.execute(PreparedStatementSpy.java:443)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:58)
	at jdk.proxy4/jdk.proxy4.$Proxy101.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:65)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:80)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:65)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:336)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:158)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:110)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:90)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:154)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:147)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:142)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:333)
	at jdk.proxy2/jdk.proxy2.$Proxy86.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:194)
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:147)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:80)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:141)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy3/jdk.proxy3.$Proxy88.selectRecommendations(Unknown Source)
	at kr.bhodu.benjerrysclone.services.impl.FlavourServiceImpl.hydrateVariantDetail(FlavourServiceImpl.java:102)
	at kr.bhodu.benjerrysclone.services.impl.FlavourServiceImpl.getVariantDetail(FlavourServiceImpl.java:70)
	at kr.bhodu.benjerrysclone.controllers.FlavourController.productDetailByCategory(FlavourController.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 11:44:36 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, ' at line 12
### The error may exist in kr/bhodu/benjerrysclone/mappers/FlavourMapper.java (best guess)
### The error may involve kr.bhodu.benjerrysclone.mappers.FlavourMapper.selectRecommendations-Inline
### The error occurred while setting parameters
### SQL: SELECT     v.id AS variantId,     f.slug AS flavourSlug,     f.name_ko AS flavourNameKo,     f.is_new AS isNew,     c.slug AS categorySlug,     c.list_slug AS categoryListSlug,     c.name_ko AS categoryNameKo,     f.flavour_type_id as flavourTypeId,     ft.code AS flavourTypeCode      COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,     COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder  FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id  LEFT JOIN variant_media vm_p        ON vm_p.variant_id = v.id       AND vm_p.role = 'PACKSHOT'  LEFT JOIN variant_media vm_g5        ON vm_g5.variant_id = v.id       AND vm_g5.role = 'GALLERY'       AND vm_g5.gallery_num_prefix = 5  WHERE r.source_variant_id = ? ORDER BY r.slot
### Cause: java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, ' at line 12
; bad SQL grammar []] with root cause
java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, ' at line 12
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:383)
	at net.sf.log4jdbc.sql.jdbcapi.PreparedStatementSpy.execute(PreparedStatementSpy.java:443)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:58)
	at jdk.proxy4/jdk.proxy4.$Proxy101.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:65)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:80)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:65)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:336)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:158)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:110)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:90)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:154)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:147)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:142)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:333)
	at jdk.proxy2/jdk.proxy2.$Proxy86.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:194)
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:147)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:80)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:141)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy3/jdk.proxy3.$Proxy88.selectRecommendations(Unknown Source)
	at kr.bhodu.benjerrysclone.services.impl.FlavourServiceImpl.hydrateVariantDetail(FlavourServiceImpl.java:102)
	at kr.bhodu.benjerrysclone.services.impl.FlavourServiceImpl.getVariantDetail(FlavourServiceImpl.java:70)
	at kr.bhodu.benjerrysclone.controllers.FlavourController.productDetailByCategory(FlavourController.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[INFO ] 25-10-04 11:44:37 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:44:37 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:44:37 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 11:46:14 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 15240 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:46:14 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:46:14 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:46:16 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.506 seconds (process running for 125.049)
[INFO ] 25-10-04 11:46:22 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:46:22 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:46:22 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 11:46:23 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, ft.code AS flavourTypeCode FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:46:23 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:46:23 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
       ft.code AS flavourTypeCode
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:46:23 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |code               |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |ORIGINAL ICE CREAM |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|

[DEBUG] 25-10-04 11:46:23 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:46:23 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:46:23 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:46:23 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:46:23 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:46:23 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:46:23 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:46:23 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:46:23 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:46:23 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:46:23 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:46:23 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:46:23 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:46:23 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:46:23 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:46:23 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:46:23 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:46:23 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:46:23 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:46:23 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:46:23 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:46:23 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:46:23 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:46:23 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:46:23 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:46:23 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:46:23 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:46:23 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:46:23 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 11:46:23 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 11:46:23 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 11:46:23 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 11:46:23 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 11:46:23 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 11:46:23 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 11:46:23 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 11:46:23 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 11:46:23 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 11:46:23 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 11:46:23 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 11:46:23 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 11:46:23 [MyInterceptor:122] - running time: 269(ms)
[INFO ] 25-10-04 11:46:23 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:46:24 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:46:24 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 11:46:46 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 15240 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:46:46 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:46:46 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:46:48 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.822 seconds (process running for 157.345)
[INFO ] 25-10-04 11:47:01 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 15546 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:47:01 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:47:01 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:47:06 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.402 seconds (process running for 6.228)
[INFO ] 25-10-04 11:47:10 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:47:10 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:47:10 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 11:47:11 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, ft.code AS flavourTypeCode FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:47:11 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:47:11 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
       ft.code AS flavourTypeCode
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:47:11 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |code               |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |ORIGINAL ICE CREAM |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|

[DEBUG] 25-10-04 11:47:11 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:47:11 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:47:11 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:47:11 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:47:11 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:47:11 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:47:11 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:47:11 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:47:11 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:47:11 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:47:11 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:47:11 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:47:11 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:47:11 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:47:11 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:47:11 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:47:11 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:47:11 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:47:11 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:47:11 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:47:11 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:47:11 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:47:11 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:47:11 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:47:11 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:47:11 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:47:11 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:47:11 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:47:11 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 11:47:11 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 11:47:11 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 11:47:11 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 11:47:11 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 11:47:11 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 11:47:11 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 11:47:11 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 11:47:11 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 11:47:11 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 11:47:11 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 11:47:11 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 11:47:11 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 11:47:11 [MyInterceptor:122] - running time: 1090(ms)
[INFO ] 25-10-04 11:47:12 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:47:12 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:47:12 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 11:47:52 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 15546 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:47:52 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:47:52 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:47:53 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.372 seconds (process running for 53.482)
[INFO ] 25-10-04 11:47:57 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:47:57 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:47:57 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 11:47:57 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:47:57 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:47:57 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[ERROR] 25-10-04 11:47:57 [sqlonly:144] - 11. PreparedStatement.execute() SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON ' at line 12
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:383)
	at net.sf.log4jdbc.sql.jdbcapi.PreparedStatementSpy.execute(PreparedStatementSpy.java:443)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:58)
	at jdk.proxy4/jdk.proxy4.$Proxy101.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:65)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:80)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:65)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:336)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:158)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:110)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:90)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:154)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:147)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:142)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:75)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:333)
	at jdk.proxy2/jdk.proxy2.$Proxy86.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:154)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:87)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:141)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy5/jdk.proxy5.$Proxy103.selectVariantDetail(Unknown Source)
	at kr.bhodu.benjerrysclone.services.impl.FlavourServiceImpl.getVariantDetail(FlavourServiceImpl.java:67)
	at kr.bhodu.benjerrysclone.controllers.FlavourController.productDetailByCategory(FlavourController.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 11:47:58 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON ' at line 12
### The error may exist in kr/bhodu/benjerrysclone/mappers/FlavourMapper.java (best guess)
### The error may involve kr.bhodu.benjerrysclone.mappers.FlavourMapper.selectVariantDetail-Inline
### The error occurred while setting parameters
### SQL: SELECT v.id         AS variantId,       v.variant_description_ko     AS variantDescriptionKo,        f.id         AS flavourId,        f.slug       AS flavourSlug,        f.name_ko    AS flavourNameKo,        f.description_ko AS flavourDescriptionKo,        f.is_new     AS isNew,        f.flavour_type_id as flavourTypeId,        c.slug       AS categorySlug,        c.list_slug  AS categoryListSlug,        c.name_ko    AS categoryNameKo, FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1   AND f.slug = ?   AND c.slug = ?
### Cause: java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON ' at line 12
; bad SQL grammar []] with root cause
java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON ' at line 12
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:383)
	at net.sf.log4jdbc.sql.jdbcapi.PreparedStatementSpy.execute(PreparedStatementSpy.java:443)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:58)
	at jdk.proxy4/jdk.proxy4.$Proxy101.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:65)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:80)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:65)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:336)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:158)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:110)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:90)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:154)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:147)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:142)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:75)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:333)
	at jdk.proxy2/jdk.proxy2.$Proxy86.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:154)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:87)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:141)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy5/jdk.proxy5.$Proxy103.selectVariantDetail(Unknown Source)
	at kr.bhodu.benjerrysclone.services.impl.FlavourServiceImpl.getVariantDetail(FlavourServiceImpl.java:67)
	at kr.bhodu.benjerrysclone.controllers.FlavourController.productDetailByCategory(FlavourController.java:72)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[INFO ] 25-10-04 11:47:58 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:47:58 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:47:58 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 11:48:58 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 15546 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:48:58 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:48:58 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:48:59 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.739 seconds (process running for 119.893)
[INFO ] 25-10-04 11:49:00 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:49:00 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:49:00 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 11:49:00 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, ft.code AS flavourTypeCode FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:49:00 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:49:00 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
       ft.code AS flavourTypeCode
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:49:00 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |code               |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |ORIGINAL ICE CREAM |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|

[DEBUG] 25-10-04 11:49:00 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:49:00 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:49:00 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:49:00 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:49:00 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:49:00 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:49:00 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:49:00 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:49:00 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:49:00 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:49:00 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:49:00 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:49:00 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:49:00 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:49:00 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:49:00 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:49:00 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:49:00 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:49:00 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:49:00 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:49:00 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:49:00 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:49:00 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:49:00 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:49:00 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:49:00 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:49:00 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:49:00 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:49:00 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 11:49:00 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 11:49:00 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 11:49:00 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 11:49:00 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 11:49:00 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 11:49:00 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 11:49:00 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 11:49:00 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 11:49:00 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 11:49:00 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 11:49:00 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 11:49:00 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 11:49:00 [MyInterceptor:122] - running time: 212(ms)
[INFO ] 25-10-04 11:49:01 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:49:01 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:49:01 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 11:52:53 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:52:53 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:52:53 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[INFO ] 25-10-04 11:52:53 [MyInterceptor:101] - - REFERER : time=232484, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[DEBUG] 25-10-04 11:52:53 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, ft.code AS flavourTypeCode FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:52:53 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:52:53 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo,
       ft.code AS flavourTypeCode
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:52:53 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |code               |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |ORIGINAL ICE CREAM |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|-------------------|

[DEBUG] 25-10-04 11:52:53 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:52:53 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:52:53 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:52:53 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:52:53 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:52:53 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:52:53 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:52:53 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:52:53 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:52:53 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:52:53 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:52:53 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:52:53 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:52:53 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:52:53 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:52:53 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:52:53 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:52:53 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:52:53 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:52:53 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:52:53 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:52:53 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:52:53 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:52:53 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:52:53 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:52:53 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:52:53 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:52:53 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:52:53 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 11:52:53 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 11:52:53 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 11:52:53 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 11:52:53 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 11:52:53 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 11:52:53 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 11:52:53 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 11:52:53 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 11:52:53 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 11:52:53 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 11:52:53 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 11:52:53 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 11:52:53 [MyInterceptor:122] - running time: 195(ms)
[INFO ] 25-10-04 11:52:53 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:52:53 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:52:53 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 11:56:36 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 15546 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:56:36 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:56:36 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:56:37 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.231 seconds (process running for 577.324)
[INFO ] 25-10-04 11:56:49 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 16297 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 11:56:49 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 11:56:49 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 11:56:53 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.751 seconds (process running for 6.622)
[INFO ] 25-10-04 11:56:57 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:56:57 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:56:57 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 11:56:58 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 11:56:58 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 11:56:58 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 11:56:58 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 11:56:58 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 11:56:58 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 11:56:58 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:56:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 11:56:58 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 11:56:58 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 11:56:58 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 11:56:58 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:56:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 11:56:58 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 11:56:58 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 11:56:58 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 11:56:58 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:56:58 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 11:56:58 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:56:58 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 11:56:58 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 11:56:58 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:56:58 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 11:56:58 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 11:56:58 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 11:56:58 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 11:56:58 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:56:58 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 11:56:58 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 11:56:58 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 11:56:58 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 11:56:58 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 11:56:58 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 11:56:58 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 11:56:58 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 11:56:58 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 11:56:58 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 11:56:58 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 11:56:58 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 11:56:58 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 11:56:58 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 11:56:58 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 11:56:58 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 11:56:58 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 11:56:58 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 11:56:58 [MyInterceptor:122] - running time: 1272(ms)
[INFO ] 25-10-04 11:56:59 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 11:56:59 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 11:56:59 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[WARN ] 25-10-04 12:05:01 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=5m3s192ms).
[WARN ] 25-10-04 12:26:29 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m57s200ms).
[WARN ] 25-10-04 12:33:08 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m39s561ms).
[WARN ] 25-10-04 12:45:18 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=9m40s119ms).
[WARN ] 25-10-04 13:08:17 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=15m27s991ms).
[WARN ] 25-10-04 13:56:42 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=3m23s420ms).
[INFO ] 25-10-04 15:02:45 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 16297 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:02:45 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:02:45 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:02:47 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.906 seconds (process running for 9047.456)
[INFO ] 25-10-04 15:02:49 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 16297 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:02:49 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:02:49 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:02:50 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.144 seconds (process running for 9050.124)
[INFO ] 25-10-04 15:03:56 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 27087 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:03:56 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:03:56 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:04:00 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.511 seconds (process running for 6.399)
[INFO ] 25-10-04 15:23:20 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 28485 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:23:20 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:23:20 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:23:24 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.418 seconds (process running for 6.263)
[INFO ] 25-10-04 15:23:35 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:23:35 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:23:35 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 15:23:36 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 15:23:36 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 15:23:36 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 15:23:36 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 15:23:36 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 15:23:36 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 15:23:36 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 15:23:36 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 15:23:36 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 15:23:36 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 15:23:36 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 15:23:36 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 15:23:36 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 15:23:36 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 15:23:36 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 15:23:36 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 15:23:36 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 15:23:36 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 15:23:36 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:23:36 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 15:23:36 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 15:23:36 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 15:23:36 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 15:23:36 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:23:36 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 15:23:36 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 15:23:36 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 15:23:36 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 15:23:36 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 15:23:36 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 15:23:36 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 15:23:36 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 15:23:36 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 15:23:36 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 15:23:36 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 15:23:36 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 15:23:36 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 15:23:36 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 15:23:36 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 15:23:36 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 15:23:36 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 15:23:36 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 15:23:36 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 15:23:36 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 15:23:36 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 15:23:36 [MyInterceptor:122] - running time: 1193(ms)
[INFO ] 25-10-04 15:23:37 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:23:37 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:23:37 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 15:23:50 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:23:50 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:23:50 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-pints
[INFO ] 25-10-04 15:23:50 [MyInterceptor:101] - - REFERER : time=13729, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 15:23:50 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:23:50 [existsCategorySlug:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 15:23:50 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-pints'

[INFO ] 25-10-04 15:23:50 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 15:23:50 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:23:50 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:23:50 [selectByCategory:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 15:23:50 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-pints'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 15:23:50 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|id    |slug                                   |name_ko      |is_new |flavour_type_id |list_slug       |name_ko |url                                                                                |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크  |true   |1               |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png   |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |
|30013 |vanilla-ice-cream                      |바닐라          |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                      |
|30001 |chunky-monkey-ice-cream                |청키 몽키®       |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®     |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png  |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png      |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png            |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png          |
|30002 |half-baked-ice-cream                   |하프베이크드®      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                   |
|30008 |karamel-sutra-core                     |카라멜 수트라      |false  |2               |ice-cream-pints |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                     |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:23:50 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-04 15:23:50 [MyInterceptor:122] - running time: 183(ms)
[INFO ] 25-10-04 15:23:56 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:23:56 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:23:56 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/
[INFO ] 25-10-04 15:23:56 [MyInterceptor:101] - - REFERER : time=5683, url=http://localhost:8080/flavours/ice-cream-pints
[DEBUG] 25-10-04 15:23:56 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:23:56 [existsCategorySlug:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'strawberry-cheesecake-ice-cream'

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 15:23:56 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:23:56 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 15:23:56 [selectVariantDetailDefault:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-cheesecake-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                   |id    |slug                            |name_ko     |description_ko                    |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|30004 |항상 치즈케이크를 먹고 싶어하는 애호가들을 위해 딸기 과육이 가득하고, 부드러운 치즈케이크의 풍미와 환상적인 그라함 크래커 스월이 가득 찬 아이스크림 입니다. |20004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림 |true   |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 15:23:56 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-04 15:23:56 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 15:23:56 [selectVariantMedia:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30004
  ORDER BY role, sort_order

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                            |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png    |스트로베리 치즈케이크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null               |1          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null               |5          |
|NUTRITION |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/nutrition/473ml.png  |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 15:23:56 [selectVariantMedia:135] - <==      Total: 4
[DEBUG] 25-10-04 15:23:56 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 15:23:56 [selectVariantGallery:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30004
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null   |1          |
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 15:23:56 [selectVariantGallery:135] - <==      Total: 2
[DEBUG] 25-10-04 15:23:56 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 15:23:56 [selectVariantIngredients:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30004

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                    |smartlabel_url |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|아이스크림믹스[유크림, 탈지우유, 정제수, 설탕시럽 (설탕, 정제수), 가당난황, 구아검, 카라기난], 그라함크래커[기타설탕, 옥수수전분, 카놀라유, 대두유, 밀가루], 딸기다이스 [딸기, 설탕, 구아검, 레몬농축과즙], 치즈케이크베이스[설탕, 정제수, 크림치즈, 향료, 젖산], 딸기퓌레 |null           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 15:23:56 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 15:23:56 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 15:23:56 [selectVariantSourcing:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30004
ORDER BY vs.sort_order

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Open Chain Sourcing           |/assets/img/misc/90008_Cocoa_Sourcing_VLS_Simpler_Icons.avif                |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:23:56 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-04 15:23:56 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 15:23:56 [selectVariantCerts:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30004
ORDER BY vc.sort_order

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 15:23:56 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 15:23:56 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 15:23:56 [selectRecommendations:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30004
ORDER BY r.slot

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream   |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30006 |cherry-garcia-ice-cream           |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg           |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 15:23:56 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 15:23:56 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 15:23:56 [selectAvailableCategories:135] - ==> Parameters: 20004(Long)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20004
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30004 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 15:23:56 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 15:23:56 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 15:23:56 [findNextVariant:135] - ==> Parameters: 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long)
[INFO ] 25-10-04 15:23:56 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30004))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30004)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 15:23:56 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30001 |chunky-monkey-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-04 15:23:56 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 15:23:56 [MyInterceptor:122] - running time: 153(ms)
[INFO ] 25-10-04 15:24:00 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:24:00 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:24:00 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[INFO ] 25-10-04 15:24:00 [MyInterceptor:101] - - REFERER : time=4409, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/
[DEBUG] 25-10-04 15:24:00 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:24:00 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 15:24:00 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 15:24:00 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:24:00 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 15:24:00 [MyInterceptor:122] - running time: 84(ms)
[INFO ] 25-10-04 15:24:33 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:24:33 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:24:33 [MyInterceptor:85] - [GET] http://localhost:8080/.well-known/appspecific/com.chrome.devtools.json
[INFO ] 25-10-04 15:28:57 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 28910 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:28:57 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:28:57 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:29:02 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.437 seconds (process running for 6.244)
[INFO ] 25-10-04 15:29:29 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:29:29 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:29:29 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-cups
[DEBUG] 25-10-04 15:29:30 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:29:30 [existsCategorySlug:135] - ==> Parameters: ice-cream-cups(String)
[INFO ] 25-10-04 15:29:30 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-cups'

[INFO ] 25-10-04 15:29:30 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 15:29:30 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:29:30 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:29:30 [selectByCategory:135] - ==> Parameters: ice-cream-cups(String)
[INFO ] 25-10-04 15:29:30 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-cups'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 15:29:30 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|----------------|---------------|--------|--------------------------------------------------------------------------------------|
|id    |slug                                  |name_ko     |is_new |flavour_type_id |list_slug      |name_ko |url                                                                                   |
|------|--------------------------------------|------------|-------|----------------|---------------|--------|--------------------------------------------------------------------------------------|
|30023 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |1               |ice-cream-cups |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png               |
|30022 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |1               |ice-cream-cups |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png |
|30021 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니 |false  |1               |ice-cream-cups |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png     |
|------|--------------------------------------|------------|-------|----------------|---------------|--------|--------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:29:30 [selectByCategory:135] - <==      Total: 3
[INFO ] 25-10-04 15:29:30 [MyInterceptor:122] - running time: 1067(ms)
[INFO ] 25-10-04 15:41:55 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 29947 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:41:55 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:41:55 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:41:59 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.377 seconds (process running for 6.28)
[INFO ] 25-10-04 15:42:24 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:42:24 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:42:24 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/search-results
[DEBUG] 25-10-04 15:42:25 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:42:25 [existsCategorySlug:135] - ==> Parameters: search-results(String)
[INFO ] 25-10-04 15:42:25 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'search-results'

[INFO ] 25-10-04 15:42:25 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 15:42:25 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:42:25 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 15:42:25 [selectVariantDetailDefault:135] - ==> Parameters: search-results(String)
[INFO ] 25-10-04 15:42:25 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'search-results'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 15:42:25 [resultsettable:610] - 
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|id |variant_description_ko |id |slug |name_ko |description_ko |is_new |flavour_type_id |slug |list_slug |name_ko |
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|

[DEBUG] 25-10-04 15:42:25 [selectVariantDetailDefault:135] - <==      Total: 0
[INFO ] 25-10-04 15:42:25 [MyInterceptor:122] - running time: 1139(ms)
[ERROR] 25-10-04 15:42:25 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-1] Exception processing template "errors/404": Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:42:25 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers] with root cause
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[INFO ] 25-10-04 15:42:29 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:42:29 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:42:29 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/search-result
[DEBUG] 25-10-04 15:42:29 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:42:29 [existsCategorySlug:135] - ==> Parameters: search-result(String)
[INFO ] 25-10-04 15:42:29 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'search-result'

[INFO ] 25-10-04 15:42:29 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 15:42:29 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:42:29 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 15:42:29 [selectVariantDetailDefault:135] - ==> Parameters: search-result(String)
[INFO ] 25-10-04 15:42:29 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'search-result'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 15:42:29 [resultsettable:610] - 
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|id |variant_description_ko |id |slug |name_ko |description_ko |is_new |flavour_type_id |slug |list_slug |name_ko |
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|

[DEBUG] 25-10-04 15:42:29 [selectVariantDetailDefault:135] - <==      Total: 0
[INFO ] 25-10-04 15:42:29 [MyInterceptor:122] - running time: 153(ms)
[ERROR] 25-10-04 15:42:29 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-3] Exception processing template "errors/404": Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:42:29 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers] with root cause
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[INFO ] 25-10-04 15:42:31 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:42:31 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:42:31 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/search-result
[DEBUG] 25-10-04 15:42:31 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:42:31 [existsCategorySlug:135] - ==> Parameters: search-result(String)
[INFO ] 25-10-04 15:42:31 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'search-result'

[INFO ] 25-10-04 15:42:31 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 15:42:31 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:42:31 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 15:42:31 [selectVariantDetailDefault:135] - ==> Parameters: search-result(String)
[INFO ] 25-10-04 15:42:31 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'search-result'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 15:42:31 [resultsettable:610] - 
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|id |variant_description_ko |id |slug |name_ko |description_ko |is_new |flavour_type_id |slug |list_slug |name_ko |
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|

[DEBUG] 25-10-04 15:42:31 [selectVariantDetailDefault:135] - <==      Total: 0
[INFO ] 25-10-04 15:42:31 [MyInterceptor:122] - running time: 126(ms)
[ERROR] 25-10-04 15:42:31 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-4] Exception processing template "errors/404": Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:42:31 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers] with root cause
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[INFO ] 25-10-04 15:42:38 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:42:38 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:42:38 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/search
[DEBUG] 25-10-04 15:42:38 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:42:38 [existsCategorySlug:135] - ==> Parameters: search(String)
[INFO ] 25-10-04 15:42:38 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'search'

[INFO ] 25-10-04 15:42:38 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 15:42:38 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:42:38 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 15:42:38 [selectVariantDetailDefault:135] - ==> Parameters: search(String)
[INFO ] 25-10-04 15:42:38 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'search'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 15:42:38 [resultsettable:610] - 
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|id |variant_description_ko |id |slug |name_ko |description_ko |is_new |flavour_type_id |slug |list_slug |name_ko |
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|

[DEBUG] 25-10-04 15:42:38 [selectVariantDetailDefault:135] - <==      Total: 0
[INFO ] 25-10-04 15:42:38 [MyInterceptor:122] - running time: 163(ms)
[ERROR] 25-10-04 15:42:38 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-6] Exception processing template "errors/404": Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:42:38 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers] with root cause
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[INFO ] 25-10-04 15:43:06 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:43:07 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:43:07 [MyInterceptor:85] - [GET] http://localhost:8080/search
[INFO ] 25-10-04 15:43:07 [MyInterceptor:122] - running time: 101(ms)
[ERROR] 25-10-04 15:43:07 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-8] Exception processing template "flavours/search-results": An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:241)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.attoparser.ParseException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:393)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	... 56 common frames omitted
Caused by: org.thymeleaf.exceptions.TemplateProcessingException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:292)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	... 58 common frames omitted
Caused by: org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	... 77 common frames omitted
[ERROR] 25-10-04 15:43:07 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] with root cause
org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:43:07 [ErrorMvcAutoConfiguration$StaticView:202] - Cannot render error page for request [/search] and exception [An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] as the response has already been committed. As a result, the response may have the wrong status code.
[INFO ] 25-10-04 15:43:10 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:43:10 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:43:10 [MyInterceptor:85] - [GET] http://localhost:8080/search
[INFO ] 25-10-04 15:43:10 [MyInterceptor:122] - running time: 85(ms)
[ERROR] 25-10-04 15:43:10 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-1] Exception processing template "flavours/search-results": An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:241)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.attoparser.ParseException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:393)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	... 56 common frames omitted
Caused by: org.thymeleaf.exceptions.TemplateProcessingException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:292)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	... 58 common frames omitted
Caused by: org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	... 77 common frames omitted
[ERROR] 25-10-04 15:43:10 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] with root cause
org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:43:10 [ErrorMvcAutoConfiguration$StaticView:202] - Cannot render error page for request [/search] and exception [An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] as the response has already been committed. As a result, the response may have the wrong status code.
[INFO ] 25-10-04 15:43:45 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:43:46 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:43:46 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/search-results
[DEBUG] 25-10-04 15:43:46 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:43:46 [existsCategorySlug:135] - ==> Parameters: search-results(String)
[INFO ] 25-10-04 15:43:46 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'search-results'

[INFO ] 25-10-04 15:43:46 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 15:43:46 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:43:46 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 15:43:46 [selectVariantDetailDefault:135] - ==> Parameters: search-results(String)
[INFO ] 25-10-04 15:43:46 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'search-results'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 15:43:46 [resultsettable:610] - 
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|id |variant_description_ko |id |slug |name_ko |description_ko |is_new |flavour_type_id |slug |list_slug |name_ko |
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|
|---|-----------------------|---|-----|--------|---------------|-------|----------------|-----|----------|--------|

[DEBUG] 25-10-04 15:43:46 [selectVariantDetailDefault:135] - <==      Total: 0
[INFO ] 25-10-04 15:43:46 [MyInterceptor:122] - running time: 138(ms)
[ERROR] 25-10-04 15:43:46 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-10] Exception processing template "errors/404": Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:43:46 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers] with root cause
org.thymeleaf.exceptions.TemplateInputException: Error resolving template [errors/404], template might not exist or might not be accessible by any of the configured Template Resolvers
	at org.thymeleaf.engine.TemplateManager.resolveTemplate(TemplateManager.java:869)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:607)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[INFO ] 25-10-04 15:47:10 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 30334 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:47:10 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:47:10 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:47:15 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.702 seconds (process running for 6.511)
[INFO ] 25-10-04 15:47:27 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:47:28 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:47:28 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[DEBUG] 25-10-04 15:47:28 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 15:47:28 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-04 15:47:28 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-04 15:47:28 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                          |id    |slug                                 |name_ko     |description_ko                              |is_new |flavour_type_id |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----------|------------------------|--------|
|30039 |오늘부턴 나도 뉴요커! 고소한 아몬드, 호두와 풍부한 초콜릿의 맛이 당신에게 잊을 수 없는 순간을 선물합니다. 뉴욕의 풍부하고 깊은 맛을 사랑하는 사람과 함께 즐겨보세요! |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |1               |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----------|------------------------|--------|

[DEBUG] 25-10-04 15:47:28 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 15:47:28 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 15:47:28 [selectVariantMedia:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 15:47:28 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30039
  ORDER BY role, sort_order

[INFO ] 25-10-04 15:47:28 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                       |alt_ko            |sort_order |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png    |뉴욕 수퍼 퍼지 청크 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-04 15:47:28 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-04 15:47:28 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 15:47:28 [selectVariantGallery:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 15:47:28 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30039
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 15:47:28 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                       |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 15:47:28 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-04 15:47:28 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 15:47:28 [selectVariantIngredients:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 15:47:28 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30039

[INFO ] 25-10-04 15:47:28 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                |smartlabel_url |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |null           |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 15:47:28 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 15:47:28 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 15:47:28 [selectVariantSourcing:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 15:47:28 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30039
ORDER BY vs.sort_order

[INFO ] 25-10-04 15:47:28 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:47:28 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 15:47:28 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 15:47:28 [selectVariantCerts:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 15:47:28 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30039
ORDER BY vc.sort_order

[INFO ] 25-10-04 15:47:28 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 15:47:28 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 15:47:28 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 15:47:28 [selectRecommendations:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 15:47:28 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30039
ORDER BY r.slot

[INFO ] 25-10-04 15:47:28 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |flavour_type_id |code               |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|
|30035 |chunky-monkey-ice-cream               |청키 몽키®      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |0         |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |0         |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 15:47:28 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 15:47:28 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 15:47:28 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-04 15:47:28 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 15:47:28 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 15:47:28 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 15:47:28 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 15:47:28 [findNextVariant:135] - ==> Parameters: 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long)
[INFO ] 25-10-04 15:47:28 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30039))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30039)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 15:47:28 [resultsettable:610] - 
|------|-------------------------------|-----------|
|id    |slug                           |slug       |
|------|-------------------------------|-----------|
|30038 |mint-chocolate-chunk-ice-cream |scoop-shop |
|------|-------------------------------|-----------|

[DEBUG] 25-10-04 15:47:28 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 15:47:28 [MyInterceptor:122] - running time: 1139(ms)
[INFO ] 25-10-04 15:47:32 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:47:32 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:47:32 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-pints
[INFO ] 25-10-04 15:47:32 [MyInterceptor:101] - - REFERER : time=3704, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[DEBUG] 25-10-04 15:47:32 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:47:32 [existsCategorySlug:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 15:47:32 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-pints'

[INFO ] 25-10-04 15:47:32 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 15:47:32 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:47:32 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:47:32 [selectByCategory:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 15:47:32 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-pints'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 15:47:32 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|id    |slug                                   |name_ko      |is_new |flavour_type_id |list_slug       |name_ko |url                                                                                |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크  |true   |1               |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png   |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |
|30013 |vanilla-ice-cream                      |바닐라          |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                      |
|30001 |chunky-monkey-ice-cream                |청키 몽키®       |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®     |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png  |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png      |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png            |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png          |
|30002 |half-baked-ice-cream                   |하프베이크드®      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                   |
|30008 |karamel-sutra-core                     |카라멜 수트라      |false  |2               |ice-cream-pints |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                     |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:47:32 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-04 15:47:32 [MyInterceptor:122] - running time: 198(ms)
[INFO ] 25-10-04 15:47:48 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:47:49 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:47:49 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%E3%84%B7
[INFO ] 25-10-04 15:47:49 [MyInterceptor:92] - (param) <-- q = ㄷ
[INFO ] 25-10-04 15:47:49 [MyInterceptor:101] - - REFERER : time=16091, url=http://localhost:8080/flavours/ice-cream-pints
[DEBUG] 25-10-04 15:47:49 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:47:49 [searchFlavoursAll:135] - ==> Parameters: ㄷ(String), ㄷ(String), ㄷ(String), ㄷ(String), ㄷ(String), ㄷ(String), ㄷ(String), ㄷ(String), ㄷ(String)
[INFO ] 25-10-04 15:47:49 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('ㄷ')                               AS q,
REPLACE(TRIM('ㄷ'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('ㄷ'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('ㄷ'), '%')                  AS q_prefix,
CONCAT('%', TRIM('ㄷ'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('ㄷ'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('ㄷ'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('ㄷ'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('ㄷ'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:47:49 [resultsettable:610] - 
|---|-----|--------|-------|-----|----------|--------|---------|----------------|-----|
|id |slug |name_ko |is_new |slug |list_slug |name_ko |imageurl |flavour_type_id |code |
|---|-----|--------|-------|-----|----------|--------|---------|----------------|-----|
|---|-----|--------|-------|-----|----------|--------|---------|----------------|-----|

[DEBUG] 25-10-04 15:47:49 [searchFlavoursAll:135] - <==      Total: 0
[INFO ] 25-10-04 15:47:49 [MyInterceptor:122] - running time: 224(ms)
[ERROR] 25-10-04 15:47:49 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-10] Exception processing template "flavours/search-results": An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:241)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.attoparser.ParseException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:393)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	... 56 common frames omitted
Caused by: org.thymeleaf.exceptions.TemplateProcessingException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:292)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	... 58 common frames omitted
Caused by: org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	... 77 common frames omitted
[ERROR] 25-10-04 15:47:49 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] with root cause
org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:47:49 [ErrorMvcAutoConfiguration$StaticView:202] - Cannot render error page for request [/search] and exception [An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] as the response has already been committed. As a result, the response may have the wrong status code.
[INFO ] 25-10-04 15:48:16 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:48:16 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:48:16 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=strawberry
[INFO ] 25-10-04 15:48:16 [MyInterceptor:92] - (param) <-- q = strawberry
[INFO ] 25-10-04 15:48:16 [MyInterceptor:101] - - REFERER : time=27498, url=http://localhost:8080/flavours/ice-cream-pints
[DEBUG] 25-10-04 15:48:16 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:48:16 [searchFlavoursAll:135] - ==> Parameters: strawberry(String), strawberry(String), strawberry(String), strawberry(String), strawberry(String), strawberry(String), strawberry(String), strawberry(String), strawberry(String)
[INFO ] 25-10-04 15:48:16 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('strawberry')                               AS q,
REPLACE(TRIM('strawberry'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('strawberry'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('strawberry'), '%')                  AS q_prefix,
CONCAT('%', TRIM('strawberry'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('strawberry'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('strawberry'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('strawberry'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('strawberry'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:48:16 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                      |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png        |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 15:48:16 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 15:48:16 [MyInterceptor:122] - running time: 115(ms)
[INFO ] 25-10-04 15:49:27 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:49:27 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:49:27 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 15:49:27 [MyInterceptor:92] - (param) <-- q = 딸기
[INFO ] 25-10-04 15:49:27 [MyInterceptor:101] - - REFERER : time=70514, url=http://localhost:8080/search?q=strawberry
[DEBUG] 25-10-04 15:49:27 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:49:27 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 15:49:27 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:49:27 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                      |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png        |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 15:49:27 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 15:49:27 [MyInterceptor:122] - running time: 82(ms)
[INFO ] 25-10-04 15:49:32 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:49:32 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:49:32 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EC%B4%88%EC%BD%94
[INFO ] 25-10-04 15:49:32 [MyInterceptor:92] - (param) <-- q = 초코
[INFO ] 25-10-04 15:49:32 [MyInterceptor:101] - - REFERER : time=4859, url=http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[DEBUG] 25-10-04 15:49:32 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:49:32 [searchFlavoursAll:135] - ==> Parameters: 초코(String), 초코(String), 초코(String), 초코(String), 초코(String), 초코(String), 초코(String), 초코(String), 초코(String)
[INFO ] 25-10-04 15:49:32 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('초코')                               AS q,
REPLACE(TRIM('초코'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('초코'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('초코'), '%')                  AS q_prefix,
CONCAT('%', TRIM('초코'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('초코'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('초코'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('초코'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('초코'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:49:32 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|-----------|------------------------|--------|-------------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                                   |name_ko      |is_new |slug       |list_slug               |name_ko |imageurl                                                                             |flavour_type_id |code               |
|------|---------------------------------------|-------------|-------|-----------|------------------------|--------|-------------------------------------------------------------------------------------|----------------|-------------------|
|30032 |chocolate-ice-cream                    |초콜릿          |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                |1               |ORIGINAL ICE CREAM |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크  |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg   |1               |ORIGINAL ICE CREAM |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png     |1               |ORIGINAL ICE CREAM |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg        |1               |ORIGINAL ICE CREAM |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png  |1               |ORIGINAL ICE CREAM |
|30001 |chunky-monkey-ice-cream                |청키 몽키®       |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg                |1               |ORIGINAL ICE CREAM |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®     |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg                |1               |ORIGINAL ICE CREAM |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png  |1               |ORIGINAL ICE CREAM |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니  |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg      |1               |ORIGINAL ICE CREAM |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/05-hero.jpg |1               |ORIGINAL ICE CREAM |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵      |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg            |1               |ORIGINAL ICE CREAM |
|30002 |half-baked-ice-cream                   |하프베이크드®      |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg                   |1               |ORIGINAL ICE CREAM |
|30008 |karamel-sutra-core                     |카라멜 수트라      |false  |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/gallery/05-hero.jpg                     |2               |CORE               |
|------|---------------------------------------|-------------|-------|-----------|------------------------|--------|-------------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 15:49:32 [searchFlavoursAll:135] - <==      Total: 13
[INFO ] 25-10-04 15:49:32 [MyInterceptor:122] - running time: 119(ms)
[INFO ] 25-10-04 15:49:42 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:49:42 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:49:42 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%84%9B%EC%B8%A0
[INFO ] 25-10-04 15:49:42 [MyInterceptor:92] - (param) <-- q = 넛츠
[INFO ] 25-10-04 15:49:42 [MyInterceptor:101] - - REFERER : time=10102, url=http://localhost:8080/search?q=%EC%B4%88%EC%BD%94
[DEBUG] 25-10-04 15:49:42 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:49:42 [searchFlavoursAll:135] - ==> Parameters: 넛츠(String), 넛츠(String), 넛츠(String), 넛츠(String), 넛츠(String), 넛츠(String), 넛츠(String), 넛츠(String), 넛츠(String)
[INFO ] 25-10-04 15:49:42 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('넛츠')                               AS q,
REPLACE(TRIM('넛츠'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('넛츠'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('넛츠'), '%')                  AS q_prefix,
CONCAT('%', TRIM('넛츠'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('넛츠'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('넛츠'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('넛츠'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('넛츠'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:49:42 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |flavour_type_id |code               |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------------|-------------------|
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |1               |ORIGINAL ICE CREAM |
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |1               |ORIGINAL ICE CREAM |
|30012 |pistachio-pistachio-ice-cream        |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg        |1               |ORIGINAL ICE CREAM |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 15:49:42 [searchFlavoursAll:135] - <==      Total: 3
[INFO ] 25-10-04 15:49:42 [MyInterceptor:122] - running time: 90(ms)
[INFO ] 25-10-04 15:51:42 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 30660 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:51:42 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:51:42 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:51:46 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.449 seconds (process running for 6.25)
[INFO ] 25-10-04 15:51:52 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:51:52 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:51:52 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-shop-flavours
[DEBUG] 25-10-04 15:51:53 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:51:53 [existsCategorySlug:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-04 15:51:53 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-shop-flavours'

[INFO ] 25-10-04 15:51:53 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 15:51:53 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:51:53 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:51:53 [selectByCategory:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-04 15:51:53 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-shop-flavours'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 15:51:53 [resultsettable:610] - 
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                  |name_ko         |is_new |flavour_type_id |list_slug               |name_ko |url                                                                                     |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|30032 |chocolate-ice-cream                   |초콜릿             |true   |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream  |뉴욕 수퍼 퍼지 청크     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream        |민트 초콜릿 청크       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                     |바닐라             |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream     |스위트 크림&쿠키       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                  |스트로베리           |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream               |청키 몽키®          |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®        |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                  |하프베이크드®         |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                       |레모네이드 소르베       |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet      |베리베리 엑스트라 오디너리® |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:51:53 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-04 15:51:53 [MyInterceptor:122] - running time: 1382(ms)
[INFO ] 25-10-04 15:51:54 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:51:54 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:51:54 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[INFO ] 25-10-04 15:51:54 [MyInterceptor:101] - - REFERER : time=607, url=http://localhost:8080/search?q=%EB%84%9B%EC%B8%A0
[DEBUG] 25-10-04 15:51:54 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 15:51:54 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), pint(String)
[INFO ] 25-10-04 15:51:54 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 15:51:54 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                 |id    |slug                                 |name_ko     |description_ko                              |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|
|30010 |1985년에 벤앤제리스는 뉴욕만의 새로운 플레이버로 다양한 종류의 청크들을 넣은 뉴욕 수퍼 퍼지 청크를 탄생시켰습니다. 뉴욕에서도 인기있는 플레이버라면 어디서든 맛 볼 수 있을거라 생각했어요. 실제로도 그렇고요. |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 15:51:54 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 15:51:54 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 15:51:54 [selectVariantMedia:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:54 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30010
  ORDER BY role, sort_order

[INFO ] 25-10-04 15:51:54 [resultsettable:610] - 
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                     |alt_ko             |sort_order |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |뉴욕 수퍼 퍼지 청크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 15:51:54 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 15:51:54 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 15:51:54 [selectVariantGallery:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:54 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30010
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 15:51:54 [resultsettable:610] - 
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                     |alt_ko |sort_order |
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 15:51:54 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 15:51:54 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 15:51:54 [selectVariantIngredients:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:54 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30010

[INFO ] 25-10-04 15:51:54 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                |smartlabel_url                                                                                                           |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100149-0002-en-US-1670951315103/index.html#nutrition |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:51:54 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 15:51:54 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 15:51:54 [selectVariantSourcing:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:54 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30010
ORDER BY vs.sort_order

[INFO ] 25-10-04 15:51:54 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:51:54 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 15:51:54 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 15:51:54 [selectVariantCerts:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:54 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30010
ORDER BY vc.sort_order

[INFO ] 25-10-04 15:51:54 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 15:51:54 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 15:51:54 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 15:51:54 [selectRecommendations:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:54 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30010
ORDER BY r.slot

[INFO ] 25-10-04 15:51:54 [resultsettable:610] - 
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|
|id    |slug                          |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                    |sortorder |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream       |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg       |5         |
|30011 |peanut-butter-cup-ice-cream   |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30012 |pistachio-pistachio-ice-cream |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 15:51:54 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 15:51:54 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 15:51:54 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-04 15:51:54 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 15:51:54 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 15:51:54 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 15:51:54 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 15:51:54 [findNextVariant:135] - ==> Parameters: 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long)
[INFO ] 25-10-04 15:51:54 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30010))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30010)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 15:51:54 [resultsettable:610] - 
|------|--------------------------------|-----|
|id    |slug                            |slug |
|------|--------------------------------|-----|
|30009 |mint-chocolate-cookie-ice-cream |pint |
|------|--------------------------------|-----|

[DEBUG] 25-10-04 15:51:54 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 15:51:54 [MyInterceptor:122] - running time: 294(ms)
[INFO ] 25-10-04 15:51:58 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:51:58 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:51:58 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[INFO ] 25-10-04 15:51:58 [MyInterceptor:101] - - REFERER : time=3650, url=http://localhost:8080/search?q=%EB%84%9B%EC%B8%A0
[DEBUG] 25-10-04 15:51:58 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 15:51:58 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), pint(String)
[INFO ] 25-10-04 15:51:58 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 15:51:58 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                 |id    |slug                                 |name_ko     |description_ko                              |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|
|30010 |1985년에 벤앤제리스는 뉴욕만의 새로운 플레이버로 다양한 종류의 청크들을 넣은 뉴욕 수퍼 퍼지 청크를 탄생시켰습니다. 뉴욕에서도 인기있는 플레이버라면 어디서든 맛 볼 수 있을거라 생각했어요. 실제로도 그렇고요. |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 15:51:58 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 15:51:58 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 15:51:58 [selectVariantMedia:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30010
  ORDER BY role, sort_order

[INFO ] 25-10-04 15:51:58 [resultsettable:610] - 
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                     |alt_ko             |sort_order |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |뉴욕 수퍼 퍼지 청크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 15:51:58 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 15:51:58 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 15:51:58 [selectVariantGallery:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30010
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 15:51:58 [resultsettable:610] - 
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                     |alt_ko |sort_order |
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 15:51:58 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 15:51:58 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 15:51:58 [selectVariantIngredients:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:58 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30010

[INFO ] 25-10-04 15:51:58 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                |smartlabel_url                                                                                                           |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100149-0002-en-US-1670951315103/index.html#nutrition |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:51:58 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 15:51:58 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 15:51:58 [selectVariantSourcing:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:58 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30010
ORDER BY vs.sort_order

[INFO ] 25-10-04 15:51:58 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:51:58 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 15:51:58 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 15:51:58 [selectVariantCerts:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:58 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30010
ORDER BY vc.sort_order

[INFO ] 25-10-04 15:51:58 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 15:51:58 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 15:51:58 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 15:51:58 [selectRecommendations:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 15:51:58 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30010
ORDER BY r.slot

[INFO ] 25-10-04 15:51:58 [resultsettable:610] - 
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|
|id    |slug                          |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                    |sortorder |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream       |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg       |5         |
|30011 |peanut-butter-cup-ice-cream   |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30012 |pistachio-pistachio-ice-cream |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 15:51:58 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 15:51:58 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 15:51:58 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-04 15:51:58 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 15:51:58 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 15:51:58 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 15:51:58 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 15:51:58 [findNextVariant:135] - ==> Parameters: 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long)
[INFO ] 25-10-04 15:51:58 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30010))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30010)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 15:51:58 [resultsettable:610] - 
|------|--------------------------------|-----|
|id    |slug                            |slug |
|------|--------------------------------|-----|
|30009 |mint-chocolate-cookie-ice-cream |pint |
|------|--------------------------------|-----|

[DEBUG] 25-10-04 15:51:58 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 15:51:58 [MyInterceptor:122] - running time: 224(ms)
[INFO ] 25-10-04 15:52:08 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:52:08 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:52:08 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 15:52:08 [MyInterceptor:92] - (param) <-- q = 딸기
[INFO ] 25-10-04 15:52:08 [MyInterceptor:101] - - REFERER : time=9962, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[DEBUG] 25-10-04 15:52:08 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:52:08 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 15:52:08 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:52:08 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                      |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png        |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 15:52:08 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 15:52:08 [MyInterceptor:122] - running time: 167(ms)
[INFO ] 25-10-04 15:52:14 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:52:14 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:52:14 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 15:52:14 [MyInterceptor:92] - (param) <-- q = 딸기
[INFO ] 25-10-04 15:52:14 [MyInterceptor:101] - - REFERER : time=5712, url=http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[DEBUG] 25-10-04 15:52:14 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:52:14 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 15:52:14 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:52:14 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                      |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png        |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 15:52:14 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 15:52:14 [MyInterceptor:122] - running time: 89(ms)
[INFO ] 25-10-04 15:52:22 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:52:23 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:52:23 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-shop-flavours
[INFO ] 25-10-04 15:52:23 [MyInterceptor:101] - - REFERER : time=8308, url=http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[DEBUG] 25-10-04 15:52:23 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:52:23 [existsCategorySlug:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-04 15:52:23 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-shop-flavours'

[INFO ] 25-10-04 15:52:23 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 15:52:23 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:52:23 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:52:23 [selectByCategory:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-04 15:52:23 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-shop-flavours'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 15:52:23 [resultsettable:610] - 
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                  |name_ko         |is_new |flavour_type_id |list_slug               |name_ko |url                                                                                     |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|30032 |chocolate-ice-cream                   |초콜릿             |true   |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream  |뉴욕 수퍼 퍼지 청크     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream        |민트 초콜릿 청크       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                     |바닐라             |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream     |스위트 크림&쿠키       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                  |스트로베리           |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream               |청키 몽키®          |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®        |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                  |하프베이크드®         |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                       |레모네이드 소르베       |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet      |베리베리 엑스트라 오디너리® |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:52:23 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-04 15:52:23 [MyInterceptor:122] - running time: 89(ms)
[INFO ] 25-10-04 15:52:24 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:52:24 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:52:24 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-ice-cream/
[INFO ] 25-10-04 15:52:24 [MyInterceptor:101] - - REFERER : time=1519, url=http://localhost:8080/flavours/ice-cream-shop-flavours
[DEBUG] 25-10-04 15:52:24 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:52:24 [existsCategorySlug:135] - ==> Parameters: chocolate-ice-cream(String)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'chocolate-ice-cream'

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 15:52:24 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:52:24 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 15:52:24 [selectVariantDetailDefault:135] - ==> Parameters: chocolate-ice-cream(String)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|----------------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                                |id    |slug                |name_ko |description_ko |is_new |flavour_type_id |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|----------------|-----------|------------------------|--------|
|30032 |저희 초콜릿 아이스크림은 공정무역 인증® 코코아에서 초콜릿 맛을 얻습니다. 공정무역은 코코아 재배자들이 그들의 수확에 대한 공정한 가격을 보장하고, 그들이 그들의 땅과 생계를 보호하고, 그들의 가족을 위해 제공하고, 그들의 미래에 투자할 수 있도록 합니다. 즐기세요! |20014 |chocolate-ice-cream |초콜릿     |초콜릿 아이스크림      |true   |1               |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|----------------|-----------|------------------------|--------|

[DEBUG] 25-10-04 15:52:24 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-04 15:52:24 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 15:52:24 [selectVariantMedia:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30032
  ORDER BY role, sort_order

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|---------|----------------------------------------------------------------------|----------|-----------|
|role     |url                                                                   |alt_ko    |sort_order |
|---------|----------------------------------------------------------------------|----------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png |초콜릿 스쿱 팩샷 |0          |
|---------|----------------------------------------------------------------------|----------|-----------|

[DEBUG] 25-10-04 15:52:24 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-04 15:52:24 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 15:52:24 [selectVariantGallery:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30032
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-04 15:52:24 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-04 15:52:24 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 15:52:24 [selectVariantIngredients:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30032

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|--------------------------------------------------------|---------------|
|ingredients_ko                                          |smartlabel_url |
|--------------------------------------------------------|---------------|
|유크림, 설탕시럽(설탕, 정제수), 탈지농축우유, 정제수, 코코아분말, 가당난황, 구아검, 카라기난 |null           |
|--------------------------------------------------------|---------------|

[DEBUG] 25-10-04 15:52:24 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 15:52:24 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 15:52:24 [selectVariantSourcing:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30032
ORDER BY vs.sort_order

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-04 15:52:24 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-04 15:52:24 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 15:52:24 [selectVariantCerts:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30032
ORDER BY vc.sort_order

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 15:52:24 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 15:52:24 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 15:52:24 [selectRecommendations:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30032
ORDER BY r.slot

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |flavour_type_id |code               |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|---------------------------------------------------------------------------------------|----------|
|30038 |mint-chocolate-chunk-ice-cream       |민트 초콜릿 청크   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png       |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30031 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png              |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 15:52:24 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 15:52:24 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 15:52:24 [selectAvailableCategories:135] - ==> Parameters: 20014(Long)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20014
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30032 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 15:52:24 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 15:52:24 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 15:52:24 [findNextVariant:135] - ==> Parameters: 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long)
[INFO ] 25-10-04 15:52:24 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30032))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30032)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 15:52:24 [resultsettable:610] - 
|------|--------------------------------------|-----------|
|id    |slug                                  |slug       |
|------|--------------------------------------|-----------|
|30033 |chocolate-chip-cookie-dough-ice-cream |scoop-shop |
|------|--------------------------------------|-----------|

[DEBUG] 25-10-04 15:52:24 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 15:52:24 [MyInterceptor:122] - running time: 124(ms)
[INFO ] 25-10-04 15:52:29 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:52:29 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:52:29 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%3C%21--+%EC%98%A4%ED%86%A0%EC%84%9C%EC%A0%9C%EC%8A%A4%ED%8A%B8+%28%EC%83%81%EB%8B%A8%29+--%3E+++++++++++++++++++++++++++++++++++++%3Csection+id%3D%22search-auto-suggest%22+data-modu
[INFO ] 25-10-04 15:52:29 [MyInterceptor:92] - (param) <-- q = <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu
[INFO ] 25-10-04 15:52:29 [MyInterceptor:101] - - REFERER : time=4658, url=http://localhost:8080/flavours/chocolate-ice-cream/
[DEBUG] 25-10-04 15:52:29 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:52:29 [searchFlavoursAll:135] - ==> Parameters: <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu(String), <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu(String), <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu(String), <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu(String), <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu(String), <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu(String), <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu(String), <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu(String), <!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu(String)
[INFO ] 25-10-04 15:52:29 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('<!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu')                               AS q,
REPLACE(TRIM('<!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('<!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('<!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu'), '%')                  AS q_prefix,
CONCAT('%', TRIM('<!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('<!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('<!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('<!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('<!-- 오토서제스트 (상단) -->                                     <section id="search-auto-suggest" data-modu'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:52:29 [resultsettable:610] - 
|---|-----|--------|-------|-----|----------|--------|---------|----------------|-----|
|id |slug |name_ko |is_new |slug |list_slug |name_ko |imageurl |flavour_type_id |code |
|---|-----|--------|-------|-----|----------|--------|---------|----------------|-----|
|---|-----|--------|-------|-----|----------|--------|---------|----------------|-----|

[DEBUG] 25-10-04 15:52:29 [searchFlavoursAll:135] - <==      Total: 0
[INFO ] 25-10-04 15:52:29 [MyInterceptor:122] - running time: 82(ms)
[ERROR] 25-10-04 15:52:29 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-2] Exception processing template "flavours/search-results": An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:241)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.attoparser.ParseException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:393)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	... 56 common frames omitted
Caused by: org.thymeleaf.exceptions.TemplateProcessingException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:292)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	... 58 common frames omitted
Caused by: org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	... 77 common frames omitted
[ERROR] 25-10-04 15:52:29 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] with root cause
org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:52:29 [ErrorMvcAutoConfiguration$StaticView:202] - Cannot render error page for request [/search] and exception [An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] as the response has already been committed. As a result, the response may have the wrong status code.
[INFO ] 25-10-04 15:52:37 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:52:37 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:52:37 [MyInterceptor:85] - [GET] http://localhost:8080/search
[INFO ] 25-10-04 15:52:37 [MyInterceptor:101] - - REFERER : time=7672, url=http://localhost:8080/flavours/chocolate-ice-cream/
[INFO ] 25-10-04 15:52:37 [MyInterceptor:122] - running time: 42(ms)
[ERROR] 25-10-04 15:52:37 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-1] Exception processing template "flavours/search-results": An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:241)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.attoparser.ParseException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:393)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	... 56 common frames omitted
Caused by: org.thymeleaf.exceptions.TemplateProcessingException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:292)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	... 58 common frames omitted
Caused by: org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	... 77 common frames omitted
[ERROR] 25-10-04 15:52:37 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] with root cause
org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:52:37 [ErrorMvcAutoConfiguration$StaticView:202] - Cannot render error page for request [/search] and exception [An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] as the response has already been committed. As a result, the response may have the wrong status code.
[INFO ] 25-10-04 15:52:43 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:52:43 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:52:43 [MyInterceptor:85] - [GET] http://localhost:8080/
[INFO ] 25-10-04 15:52:43 [MyInterceptor:101] - - REFERER : time=6811, url=http://localhost:8080/flavours/chocolate-ice-cream/
[INFO ] 25-10-04 15:52:46 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:52:46 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:52:46 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-pints
[INFO ] 25-10-04 15:52:46 [MyInterceptor:101] - - REFERER : time=9331, url=http://localhost:8080/flavours/chocolate-ice-cream/
[DEBUG] 25-10-04 15:52:46 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 15:52:46 [existsCategorySlug:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 15:52:46 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-pints'

[INFO ] 25-10-04 15:52:46 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 15:52:46 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 15:52:46 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:52:46 [selectByCategory:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 15:52:46 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-pints'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 15:52:46 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|id    |slug                                   |name_ko      |is_new |flavour_type_id |list_slug       |name_ko |url                                                                                |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크  |true   |1               |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png   |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |
|30013 |vanilla-ice-cream                      |바닐라          |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                      |
|30001 |chunky-monkey-ice-cream                |청키 몽키®       |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®     |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png  |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png      |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png            |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png          |
|30002 |half-baked-ice-cream                   |하프베이크드®      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                   |
|30008 |karamel-sutra-core                     |카라멜 수트라      |false  |2               |ice-cream-pints |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                     |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:52:46 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-04 15:52:46 [MyInterceptor:122] - running time: 73(ms)
[INFO ] 25-10-04 15:52:52 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:52:52 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:52:52 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[INFO ] 25-10-04 15:52:52 [MyInterceptor:101] - - REFERER : time=5816, url=http://localhost:8080/flavours/ice-cream-pints
[DEBUG] 25-10-04 15:52:52 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:52:52 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 15:52:52 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 15:52:52 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:52:52 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 15:52:52 [MyInterceptor:122] - running time: 59(ms)
[INFO ] 25-10-04 15:55:11 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 30966 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:55:11 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:55:11 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:55:16 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.449 seconds (process running for 6.237)
[INFO ] 25-10-04 15:55:21 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:55:21 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:55:21 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[DEBUG] 25-10-04 15:55:22 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:55:22 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 15:55:22 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 15:55:22 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:55:22 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 15:55:22 [MyInterceptor:122] - running time: 1013(ms)
[INFO ] 25-10-04 15:57:47 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 31188 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 15:57:47 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 15:57:47 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 15:57:52 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.527 seconds (process running for 6.326)
[INFO ] 25-10-04 15:58:02 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:58:02 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:58:02 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[DEBUG] 25-10-04 15:58:02 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:58:02 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 15:58:02 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 15:58:03 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 15:58:03 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 15:58:03 [MyInterceptor:122] - running time: 1052(ms)
[INFO ] 25-10-04 15:58:06 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:58:06 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:58:06 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 15:58:06 [MyInterceptor:92] - (param) <-- q = 딸기
[INFO ] 25-10-04 15:58:06 [MyInterceptor:101] - - REFERER : time=3499, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 15:58:06 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:58:06 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 15:58:06 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:58:06 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                      |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png        |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 15:58:06 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 15:58:06 [MyInterceptor:122] - running time: 232(ms)
[INFO ] 25-10-04 15:58:23 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:58:23 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:58:23 [MyInterceptor:85] - [GET] http://localhost:8080/search
[INFO ] 25-10-04 15:58:23 [MyInterceptor:101] - - REFERER : time=16589, url=http://localhost:8080/flavours
[INFO ] 25-10-04 15:58:23 [MyInterceptor:122] - running time: 122(ms)
[ERROR] 25-10-04 15:58:23 [TemplateEngine:1141] - [THYMELEAF][http-nio-8080-exec-1] Exception processing template "flavours/search-results": An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:241)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.attoparser.ParseException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:393)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	... 56 common frames omitted
Caused by: org.thymeleaf.exceptions.TemplateProcessingException: Exception evaluating SpringEL expression: "q != null && #strings.isNotEmpty(q) ? ('“' + q + '” 에 대한 결과가 없어요.') : '검색어를 입력해 주세요.'" (template: "flavours/search-results" - line 238, col 51)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:292)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	... 58 common frames omitted
Caused by: org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	... 77 common frames omitted
[ERROR] 25-10-04 15:58:23 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] with root cause
org.springframework.expression.spel.SpelEvaluationException: EL1004E: Method call: Method isNotEmpty(java.lang.String) cannot be found on type org.thymeleaf.expression.Strings
	at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:238)
	at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:148)
	at org.springframework.expression.spel.ast.MethodReference$MethodValueRef.getValue(MethodReference.java:398)
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.OpAnd.getBooleanValue(OpAnd.java:58)
	at org.springframework.expression.spel.ast.OpAnd.getValueInternal(OpAnd.java:53)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:203)
	at org.springframework.expression.spel.ast.Ternary.getValueInternal(Ternary.java:54)
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:116)
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:338)
	at org.thymeleaf.spring6.expression.SPELVariableExpressionEvaluator.evaluate(SPELVariableExpressionEvaluator.java:265)
	at org.thymeleaf.standard.expression.VariableExpression.executeVariableExpression(VariableExpression.java:166)
	at org.thymeleaf.standard.expression.SimpleExpression.executeSimple(SimpleExpression.java:66)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:109)
	at org.thymeleaf.standard.expression.Expression.execute(Expression.java:138)
	at org.thymeleaf.standard.processor.AbstractStandardExpressionAttributeTagProcessor.doProcess(AbstractStandardExpressionAttributeTagProcessor.java:144)
	at org.thymeleaf.processor.element.AbstractAttributeTagProcessor.doProcess(AbstractAttributeTagProcessor.java:74)
	at org.thymeleaf.processor.element.AbstractElementTagProcessor.process(AbstractElementTagProcessor.java:95)
	at org.thymeleaf.util.ProcessorConfigurationUtils$ElementTagProcessorWrapper.process(ProcessorConfigurationUtils.java:633)
	at org.thymeleaf.engine.ProcessorTemplateHandler.handleOpenElement(ProcessorTemplateHandler.java:1314)
	at org.thymeleaf.engine.TemplateHandlerAdapterMarkupHandler.handleOpenElementEnd(TemplateHandlerAdapterMarkupHandler.java:304)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler$InlineMarkupAdapterPreProcessorHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:278)
	at org.thymeleaf.standard.inline.OutputExpressionInlinePreProcessorHandler.handleOpenElementEnd(OutputExpressionInlinePreProcessorHandler.java:186)
	at org.thymeleaf.templateparser.markup.InlinedOutputExpressionMarkupHandler.handleOpenElementEnd(InlinedOutputExpressionMarkupHandler.java:124)
	at org.attoparser.HtmlElement.handleOpenElementEnd(HtmlElement.java:109)
	at org.attoparser.HtmlMarkupHandler.handleOpenElementEnd(HtmlMarkupHandler.java:297)
	at org.attoparser.MarkupEventProcessorHandler.handleOpenElementEnd(MarkupEventProcessorHandler.java:402)
	at org.attoparser.ParsingElementMarkupUtil.parseOpenElement(ParsingElementMarkupUtil.java:159)
	at org.attoparser.MarkupParser.parseBuffer(MarkupParser.java:710)
	at org.attoparser.MarkupParser.parseDocument(MarkupParser.java:301)
	at org.attoparser.MarkupParser.parse(MarkupParser.java:257)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:230)
	at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100)
	at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103)
	at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077)
	at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372)
	at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 15:58:23 [ErrorMvcAutoConfiguration$StaticView:202] - Cannot render error page for request [/search] and exception [An error happened during template parsing (template: "class path resource [templates/flavours/search-results.html]")] as the response has already been committed. As a result, the response may have the wrong status code.
[INFO ] 25-10-04 15:58:43 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:58:43 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:58:43 [MyInterceptor:85] - [GET] http://localhost:8080/
[INFO ] 25-10-04 15:58:43 [MyInterceptor:101] - - REFERER : time=19783, url=http://localhost:8080/flavours
[INFO ] 25-10-04 15:59:15 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 15:59:15 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 15:59:15 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 15:59:15 [MyInterceptor:92] - (param) <-- q = 딸기
[INFO ] 25-10-04 15:59:15 [MyInterceptor:101] - - REFERER : time=52275, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 15:59:15 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 15:59:15 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 15:59:15 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 15:59:15 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                      |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png        |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 15:59:15 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 15:59:15 [MyInterceptor:122] - running time: 128(ms)
[INFO ] 25-10-04 16:05:08 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 31806 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 16:05:08 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 16:05:08 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 16:05:13 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.438 seconds (process running for 6.229)
[INFO ] 25-10-04 16:06:08 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:06:09 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:06:09 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 16:06:09 [MyInterceptor:92] - (param) <-- q = 딸기
[DEBUG] 25-10-04 16:06:09 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:06:09 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 16:06:09 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 16:06:09 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                      |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png        |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 16:06:09 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 16:06:09 [MyInterceptor:122] - running time: 1110(ms)
[INFO ] 25-10-04 16:16:58 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:16:58 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:16:58 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 16:16:58 [MyInterceptor:92] - (param) <-- q = 딸기
[INFO ] 25-10-04 16:16:58 [MyInterceptor:101] - - REFERER : time=648949, url=http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[DEBUG] 25-10-04 16:16:58 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:16:58 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 16:16:58 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 16:16:58 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                      |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png        |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 16:16:58 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 16:16:58 [MyInterceptor:122] - running time: 172(ms)
[INFO ] 25-10-04 16:17:00 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:17:01 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:17:01 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[INFO ] 25-10-04 16:17:01 [MyInterceptor:101] - - REFERER : time=1970, url=http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[DEBUG] 25-10-04 16:17:01 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:17:01 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 16:17:01 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 16:17:01 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:01 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 16:17:01 [MyInterceptor:122] - running time: 143(ms)
[INFO ] 25-10-04 16:17:07 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:17:07 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:17:07 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[INFO ] 25-10-04 16:17:07 [MyInterceptor:101] - - REFERER : time=6360, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 16:17:07 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:17:07 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 16:17:07 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 16:17:07 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:07 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 16:17:07 [MyInterceptor:122] - running time: 122(ms)
[WARN ] 25-10-04 16:17:09 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=5m29s447ms).
[INFO ] 25-10-04 16:17:18 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:17:18 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:17:18 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-pints
[INFO ] 25-10-04 16:17:18 [MyInterceptor:101] - - REFERER : time=10815, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 16:17:18 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 16:17:18 [existsCategorySlug:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 16:17:18 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-pints'

[INFO ] 25-10-04 16:17:18 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 16:17:18 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:18 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:17:18 [selectByCategory:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 16:17:18 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-pints'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 16:17:18 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|id    |slug                                   |name_ko      |is_new |flavour_type_id |list_slug       |name_ko |url                                                                                |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크  |true   |1               |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png   |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |
|30013 |vanilla-ice-cream                      |바닐라          |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                      |
|30001 |chunky-monkey-ice-cream                |청키 몽키®       |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®     |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png  |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png      |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png            |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png          |
|30002 |half-baked-ice-cream                   |하프베이크드®      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                   |
|30008 |karamel-sutra-core                     |카라멜 수트라      |false  |2               |ice-cream-pints |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                     |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:18 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-04 16:17:18 [MyInterceptor:122] - running time: 134(ms)
[INFO ] 25-10-04 16:17:23 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:17:23 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:17:23 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/
[INFO ] 25-10-04 16:17:23 [MyInterceptor:101] - - REFERER : time=5245, url=http://localhost:8080/flavours/ice-cream-pints
[DEBUG] 25-10-04 16:17:23 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 16:17:23 [existsCategorySlug:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'strawberry-cheesecake-ice-cream'

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 16:17:23 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:23 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 16:17:23 [selectVariantDetailDefault:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-cheesecake-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                   |id    |slug                            |name_ko     |description_ko                    |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|30004 |항상 치즈케이크를 먹고 싶어하는 애호가들을 위해 딸기 과육이 가득하고, 부드러운 치즈케이크의 풍미와 환상적인 그라함 크래커 스월이 가득 찬 아이스크림 입니다. |20004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림 |true   |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:17:23 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:23 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:17:23 [selectVariantMedia:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30004
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                            |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png    |스트로베리 치즈케이크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null               |1          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null               |5          |
|NUTRITION |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/nutrition/473ml.png  |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:17:23 [selectVariantMedia:135] - <==      Total: 4
[DEBUG] 25-10-04 16:17:23 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:17:23 [selectVariantGallery:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30004
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null   |1          |
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:17:23 [selectVariantGallery:135] - <==      Total: 2
[DEBUG] 25-10-04 16:17:23 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:17:23 [selectVariantIngredients:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30004

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                    |smartlabel_url |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|아이스크림믹스[유크림, 탈지우유, 정제수, 설탕시럽 (설탕, 정제수), 가당난황, 구아검, 카라기난], 그라함크래커[기타설탕, 옥수수전분, 카놀라유, 대두유, 밀가루], 딸기다이스 [딸기, 설탕, 구아검, 레몬농축과즙], 치즈케이크베이스[설탕, 정제수, 크림치즈, 향료, 젖산], 딸기퓌레 |null           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 16:17:23 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:23 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:17:23 [selectVariantSourcing:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30004
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Open Chain Sourcing           |/assets/img/misc/90008_Cocoa_Sourcing_VLS_Simpler_Icons.avif                |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:23 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-04 16:17:23 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:17:23 [selectVariantCerts:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30004
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:17:23 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:17:23 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:17:23 [selectRecommendations:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30004
ORDER BY r.slot

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream   |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30006 |cherry-garcia-ice-cream           |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg           |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:17:23 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:23 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:17:23 [selectAvailableCategories:135] - ==> Parameters: 20004(Long)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20004
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30004 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 16:17:23 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:23 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:17:23 [findNextVariant:135] - ==> Parameters: 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long)
[INFO ] 25-10-04 16:17:23 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30004))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30004)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:17:23 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30001 |chunky-monkey-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-04 16:17:23 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:17:23 [MyInterceptor:122] - running time: 193(ms)
[INFO ] 25-10-04 16:17:29 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:17:29 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:17:29 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[INFO ] 25-10-04 16:17:29 [MyInterceptor:101] - - REFERER : time=5536, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/
[DEBUG] 25-10-04 16:17:29 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:17:29 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:17:29 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:17:29 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:17:29 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:29 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:17:29 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:29 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:17:29 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 16:17:29 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:17:29 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:17:29 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:29 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:17:29 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:17:29 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:17:29 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:17:29 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:29 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 16:17:29 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:29 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:29 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:17:29 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:29 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:17:29 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:29 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:17:29 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:17:29 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:29 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:17:29 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:17:29 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:29 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:17:29 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:29 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 16:17:29 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:17:29 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:29 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:17:29 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 16:17:29 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:17:29 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 16:17:29 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:29 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:17:29 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 16:17:29 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:17:29 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 16:17:29 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:17:29 [MyInterceptor:122] - running time: 113(ms)
[INFO ] 25-10-04 16:17:31 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:17:31 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:17:31 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/mini-cup
[INFO ] 25-10-04 16:17:31 [MyInterceptor:101] - - REFERER : time=2266, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 16:17:31 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:17:31 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), mini-cup(String)
[INFO ] 25-10-04 16:17:31 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'mini-cup'

[INFO ] 25-10-04 16:17:31 [resultsettable:610] - 
|------|--------------------------------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|---------|---------------|--------|
|id    |variant_description_ko                                                                                                                |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug     |list_slug      |name_ko |
|------|--------------------------------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|---------|---------------|--------|
|30023 |기타리스트인 제리 가르시아 (Jerry Garcia)와 그레이트 풀 데드 (Grateful Dead) 팬들에게 헌사하는 벤앤제리스의 대표 메뉴. 록 전설의 이름을 딴 최초의 아이스크림이자 벤앤제리스의 팬들이 추천하는 가장 유명한 맛입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |mini-cup |ice-cream-cups |미니컵     |
|------|--------------------------------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|---------|---------------|--------|

[DEBUG] 25-10-04 16:17:31 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:31 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:17:31 [selectVariantMedia:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-04 16:17:31 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30023
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:17:31 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png    |체리 가르시아 미니컵 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/gallery/01-tower.png |null           |1          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/nutrition/120ml.png  |영양성분표 120ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 16:17:31 [selectVariantMedia:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:31 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:17:31 [selectVariantGallery:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-04 16:17:31 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30023
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:17:31 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/gallery/01-tower.png |null   |1          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:17:31 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:31 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:17:31 [selectVariantIngredients:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-04 16:17:31 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30023

[INFO ] 25-10-04 16:17:31 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840200153-0003-en-US-1701785653440/index.html#nutrition |
|---------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:31 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:31 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:17:31 [selectVariantSourcing:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-04 16:17:31 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30023
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:17:31 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:31 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:17:31 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:17:31 [selectVariantCerts:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-04 16:17:31 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30023
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:17:31 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:17:31 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:17:31 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:17:31 [selectRecommendations:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-04 16:17:31 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30023
ORDER BY r.slot

[INFO ] 25-10-04 16:17:31 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:17:31 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:31 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:17:32 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 16:17:32 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:17:32 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 16:17:32 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:32 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:17:32 [findNextVariant:135] - ==> Parameters: 30023(Long), 30023(Long), 30023(Long), 30023(Long), 30023(Long), 30023(Long)
[INFO ] 25-10-04 16:17:32 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30023))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30023)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30023)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30023)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30023)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30023)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:17:32 [resultsettable:610] - 
|------|--------------------------------------|---------|
|id    |slug                                  |slug     |
|------|--------------------------------------|---------|
|30022 |chocolate-chip-cookie-dough-ice-cream |mini-cup |
|------|--------------------------------------|---------|

[DEBUG] 25-10-04 16:17:32 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:17:32 [MyInterceptor:122] - running time: 118(ms)
[INFO ] 25-10-04 16:17:33 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:17:33 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:17:33 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/scoop-shop
[INFO ] 25-10-04 16:17:33 [MyInterceptor:101] - - REFERER : time=1696, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/mini-cup
[DEBUG] 25-10-04 16:17:33 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:17:33 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-04 16:17:33 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-04 16:17:33 [resultsettable:610] - 
|------|-----------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----------|------------------------|--------|
|id    |variant_description_ko                               |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug       |list_slug               |name_ko |
|------|-----------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----------|------------------------|--------|
|30031 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|-----------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----------|------------------------|--------|

[DEBUG] 25-10-04 16:17:33 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:33 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:17:33 [selectVariantMedia:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-04 16:17:33 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30031
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:17:33 [resultsettable:610] - 
|---------|-----------------------------------------------------------------------------|--------------|-----------|
|role     |url                                                                          |alt_ko        |sort_order |
|---------|-----------------------------------------------------------------------------|--------------|-----------|
|PACKSHOT |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png    |체리 가르시아 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/gallery/01-tower.png |null          |1          |
|---------|-----------------------------------------------------------------------------|--------------|-----------|

[DEBUG] 25-10-04 16:17:33 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-04 16:17:33 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:17:33 [selectVariantGallery:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-04 16:17:33 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30031
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:17:33 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                          |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|-----------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:17:33 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:33 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:17:33 [selectVariantIngredients:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-04 16:17:33 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30031

[INFO ] 25-10-04 16:17:33 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                   |smartlabel_url |
|---------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |null           |
|---------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 16:17:33 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:33 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:17:33 [selectVariantSourcing:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-04 16:17:33 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30031
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:17:33 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:33 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:17:33 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:17:33 [selectVariantCerts:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-04 16:17:33 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30031
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:17:33 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:17:33 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:17:33 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:17:33 [selectRecommendations:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-04 16:17:33 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30031
ORDER BY r.slot

[INFO ] 25-10-04 16:17:33 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |flavour_type_id |code               |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|---------------------------------------------------------------------------------------|----------|
|30035 |chunky-monkey-ice-cream              |청키 몽키®      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png              |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30032 |chocolate-ice-cream                  |초콜릿         |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                  |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:17:33 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:33 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:17:33 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 16:17:33 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:17:33 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 16:17:33 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:33 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:17:33 [findNextVariant:135] - ==> Parameters: 30031(Long), 30031(Long), 30031(Long), 30031(Long), 30031(Long), 30031(Long)
[INFO ] 25-10-04 16:17:33 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30031))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30031)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30031)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30031)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30031)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30031)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:17:33 [resultsettable:610] - 
|------|--------------------|-----------|
|id    |slug                |slug       |
|------|--------------------|-----------|
|30032 |chocolate-ice-cream |scoop-shop |
|------|--------------------|-----------|

[DEBUG] 25-10-04 16:17:33 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:17:33 [MyInterceptor:122] - running time: 117(ms)
[INFO ] 25-10-04 16:17:36 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:17:36 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:17:36 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[INFO ] 25-10-04 16:17:36 [MyInterceptor:101] - - REFERER : time=2705, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/scoop-shop
[DEBUG] 25-10-04 16:17:36 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:17:36 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:17:36 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:17:36 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:17:36 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:36 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:17:36 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:36 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:17:36 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 16:17:36 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:17:36 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:17:36 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:36 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:17:36 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:17:36 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:17:36 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:17:36 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:36 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 16:17:36 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:36 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:36 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:17:36 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:36 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:17:36 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:17:36 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:17:36 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:17:36 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:36 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:17:36 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:17:36 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:17:36 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:17:36 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:17:36 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 16:17:36 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:17:36 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:36 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:17:36 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 16:17:36 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:17:36 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 16:17:36 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 16:17:36 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:17:36 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 16:17:36 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:17:36 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 16:17:36 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:17:36 [MyInterceptor:122] - running time: 100(ms)
[INFO ] 25-10-04 16:17:58 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:17:59 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:17:59 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 16:17:59 [MyInterceptor:92] - (param) <-- q = 딸기
[INFO ] 25-10-04 16:17:59 [MyInterceptor:101] - - REFERER : time=22335, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 16:17:59 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:17:59 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 16:17:59 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
LEFT JOIN variant_media vm_g5
ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 16:17:59 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                      |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png        |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 16:17:59 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 16:17:59 [MyInterceptor:122] - running time: 64(ms)
[INFO ] 25-10-04 16:18:21 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:18:21 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:18:21 [MyInterceptor:85] - [GET] http://localhost:8080/ice-cream-near-me
[INFO ] 25-10-04 16:18:21 [MyInterceptor:101] - - REFERER : time=21984, url=http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 16:18:47 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:18:47 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:18:47 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[INFO ] 25-10-04 16:18:47 [MyInterceptor:101] - - REFERER : time=48262, url=http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[DEBUG] 25-10-04 16:18:47 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:18:47 [selectVariantDetail:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:18:47 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-cheesecake-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:18:47 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                   |id    |slug                            |name_ko     |description_ko                    |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|30004 |항상 치즈케이크를 먹고 싶어하는 애호가들을 위해 딸기 과육이 가득하고, 부드러운 치즈케이크의 풍미와 환상적인 그라함 크래커 스월이 가득 찬 아이스크림 입니다. |20004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림 |true   |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:18:47 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:18:47 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:18:47 [selectVariantMedia:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:18:47 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30004
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:18:47 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                            |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png    |스트로베리 치즈케이크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null               |1          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null               |5          |
|NUTRITION |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/nutrition/473ml.png  |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:18:47 [selectVariantMedia:135] - <==      Total: 4
[DEBUG] 25-10-04 16:18:47 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:18:47 [selectVariantGallery:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:18:47 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30004
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:18:47 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null   |1          |
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:18:47 [selectVariantGallery:135] - <==      Total: 2
[DEBUG] 25-10-04 16:18:47 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:18:47 [selectVariantIngredients:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:18:47 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30004

[INFO ] 25-10-04 16:18:47 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                    |smartlabel_url |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|아이스크림믹스[유크림, 탈지우유, 정제수, 설탕시럽 (설탕, 정제수), 가당난황, 구아검, 카라기난], 그라함크래커[기타설탕, 옥수수전분, 카놀라유, 대두유, 밀가루], 딸기다이스 [딸기, 설탕, 구아검, 레몬농축과즙], 치즈케이크베이스[설탕, 정제수, 크림치즈, 향료, 젖산], 딸기퓌레 |null           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 16:18:47 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:18:47 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:18:47 [selectVariantSourcing:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:18:47 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30004
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:18:47 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Open Chain Sourcing           |/assets/img/misc/90008_Cocoa_Sourcing_VLS_Simpler_Icons.avif                |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:18:47 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-04 16:18:47 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:18:47 [selectVariantCerts:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:18:47 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30004
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:18:47 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:18:47 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:18:47 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:18:47 [selectRecommendations:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:18:47 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30004
ORDER BY r.slot

[INFO ] 25-10-04 16:18:47 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream   |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30006 |cherry-garcia-ice-cream           |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg           |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:18:47 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:18:47 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:18:47 [selectAvailableCategories:135] - ==> Parameters: 20004(Long)
[INFO ] 25-10-04 16:18:47 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20004
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:18:47 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30004 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 16:18:47 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 16:18:47 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:18:47 [findNextVariant:135] - ==> Parameters: 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long)
[INFO ] 25-10-04 16:18:47 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30004))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30004)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:18:47 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30001 |chunky-monkey-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-04 16:18:47 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:18:47 [MyInterceptor:122] - running time: 93(ms)
[INFO ] 25-10-04 16:18:56 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:18:56 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:18:56 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[INFO ] 25-10-04 16:18:56 [MyInterceptor:101] - - REFERER : time=9309, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[DEBUG] 25-10-04 16:18:56 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:18:56 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 16:18:56 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 16:18:56 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:18:56 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 16:18:56 [MyInterceptor:122] - running time: 68(ms)
[INFO ] 25-10-04 16:19:18 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:19:18 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:19:18 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream
[INFO ] 25-10-04 16:19:18 [MyInterceptor:101] - - REFERER : time=21605, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 16:19:18 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 16:19:18 [existsCategorySlug:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'chocolate-chip-cookie-dough-ice-cream'

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-04 16:19:18 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 16:19:18 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-04 16:19:18 [selectVariantDetailDefault:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|----------------|-----|----------------|--------|
|30005 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:19:18 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-04 16:19:18 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:19:18 [selectVariantMedia:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30005
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                      |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png        |초콜릿 칩 쿠키 도우 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null               |5          |
|NUTRITION |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:19:18 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:19:18 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:19:18 [selectVariantGallery:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30005
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                      |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null   |5          |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:19:18 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:19:18 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:19:18 [selectVariantIngredients:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30005

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100583-0002-en-US-1669211882662/index.html |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:19:18 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:19:18 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:19:18 [selectVariantSourcing:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30005
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:19:18 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:19:18 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:19:18 [selectVariantCerts:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30005
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:19:18 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:19:18 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:19:18 [selectRecommendations:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30005
ORDER BY r.slot

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30013 |vanilla-ice-cream                    |바닐라         |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                    |5         |
|30002 |half-baked-ice-cream                 |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:19:18 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:19:18 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:19:18 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 16:19:18 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 16:19:18 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:19:18 [findNextVariant:135] - ==> Parameters: 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long)
[INFO ] 25-10-04 16:19:18 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30005))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30005)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:19:18 [resultsettable:610] - 
|------|----------------------------------|-----|
|id    |slug                              |slug |
|------|----------------------------------|-----|
|30003 |chocolate-fudge-brownie-ice-cream |pint |
|------|----------------------------------|-----|

[DEBUG] 25-10-04 16:19:18 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:19:18 [MyInterceptor:122] - running time: 84(ms)
[INFO ] 25-10-04 16:19:27 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:19:28 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:19:28 [MyInterceptor:85] - [GET] http://localhost:8080/about-us/how-we-make-ice-cream
[INFO ] 25-10-04 16:19:28 [MyInterceptor:101] - - REFERER : time=9542, url=http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream
[INFO ] 25-10-04 16:19:33 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:19:33 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:19:33 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/half-baked-ice-cream/pint
[INFO ] 25-10-04 16:19:33 [MyInterceptor:101] - - REFERER : time=15088, url=http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream
[DEBUG] 25-10-04 16:19:33 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:19:33 [selectVariantDetail:135] - ==> Parameters: half-baked-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:19:33 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'half-baked-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:19:33 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                                                                                                                                                                                         |id    |slug                 |name_ko |description_ko                                   |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|----------------|-----|----------------|--------|
|30002 |우리는 스쿱샵에 들릴 때 마다 우리의 친구들이 가장 맛있을 법한 새롭고 쿨한 콤보를 만들기 위해 다양한 맛의 조합을 시도하는 것을 알게 되었습니다. 그때 우리는 이것이 정말 엄청난 아이디어라고 생각 했어요. 그래서 우리는 여러분이 사랑하는 벤앤제리스의 맛과 절묘하게 어우러진 새로운 맛을 찾기 위해 여러분이 새롭게 조합한 맛을 함께 섞어 보았습니다. 여러분은 우리가 엉뚱하다고 말할지도 모르겠지만, 우리는 말할 수 있어요. 이건 하프 베이크드 라고 해! Enjoy! 벤앤제리스를 사랑하는 모든 이들에게 감사해요. |20002 |half-baked-ice-cream |하프베이크드® |초코칩 쿠키도우와 퍼지 브라우니의 청크가 절묘하게 어우러진 초콜릿 & 바닐라 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:19:33 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:19:33 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:19:33 [selectVariantMedia:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:19:33 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30002
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:19:33 [resultsettable:610] - 
|----------|------------------------------------------------------------------------|--------------|-----------|
|role      |url                                                                     |alt_ko        |sort_order |
|----------|------------------------------------------------------------------------|--------------|-----------|
|PACKSHOT  |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png        |하프베이크드 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/01-tower.png     |null          |1          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/02-envirolid.jpg |null          |2          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/03-scooped.jpg   |null          |3          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/04-enviro.jpg    |null          |4          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg      |null          |5          |
|NUTRITION |/assets/img/flavours/half-baked-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml   |0          |
|----------|------------------------------------------------------------------------|--------------|-----------|

[DEBUG] 25-10-04 16:19:33 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:19:33 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:19:33 [selectVariantGallery:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:19:33 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30002
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:19:33 [resultsettable:610] - 
|--------|------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                     |alt_ko |sort_order |
|--------|------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:19:33 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:19:33 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:19:33 [selectVariantIngredients:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:19:33 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30002

[INFO ] 25-10-04 16:19:33 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                     |smartlabel_url                                                                                                           |
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽, 탈지농축우유, 정제수, 설탕, 밀가루, 코코아분말, 갈색 설탕, 가당난황, 대두유, 버터, 계란, 전화당, 초콜릿 리커, 바닐라 추출물, 소금, 계란 흰자, 구아검, 카라기난, 당밀, 코코아버터, 천연향료, 맥아분말 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840101320-0002-en-US-1669212157071/index.html#nutrition |
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:19:33 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:19:33 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:19:33 [selectVariantSourcing:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:19:33 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30002
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:19:33 [resultsettable:610] - 
|----------------|--------------------------------------------------------------|
|name_ko         |icon_url                                                      |
|----------------|--------------------------------------------------------------|
|Non-GMO         |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif         |
|Fairtrade       |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif       |
|Free Range Eggs |/assets/img/misc/90003_Free-range_Eggs_VLS_Simpler_Icons.webp |
|----------------|--------------------------------------------------------------|

[DEBUG] 25-10-04 16:19:33 [selectVariantSourcing:135] - <==      Total: 3
[DEBUG] 25-10-04 16:19:33 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:19:33 [selectVariantCerts:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:19:33 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30002
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:19:33 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:19:33 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:19:33 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:19:33 [selectRecommendations:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:19:33 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30002
ORDER BY r.slot

[INFO ] 25-10-04 16:19:33 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                            |sortorder |
|------|--------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------------|----------|
|30005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png |5         |
|30003 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg     |5         |
|30009 |mint-chocolate-cookie-ice-cream       |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg       |5         |
|------|--------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:19:33 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:19:33 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:19:33 [selectAvailableCategories:135] - ==> Parameters: 20002(Long)
[INFO ] 25-10-04 16:19:33 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20002
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:19:33 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30002 |
|SCOOP |scoop-shop |스쿱 샵    |30036 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:19:33 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:19:33 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:19:33 [findNextVariant:135] - ==> Parameters: 30002(Long), 30002(Long), 30002(Long), 30002(Long), 30002(Long), 30002(Long)
[INFO ] 25-10-04 16:19:33 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30002))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30002)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30002)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30002)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30002)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30002)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:19:33 [resultsettable:610] - 
|------|-------------------|-----|
|id    |slug               |slug |
|------|-------------------|-----|
|30008 |karamel-sutra-core |pint |
|------|-------------------|-----|

[DEBUG] 25-10-04 16:19:33 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:19:33 [MyInterceptor:122] - running time: 104(ms)
[INFO ] 25-10-04 16:22:12 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:22:12 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:22:12 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[INFO ] 25-10-04 16:22:12 [MyInterceptor:101] - - REFERER : time=159222, url=http://localhost:8080/flavours/half-baked-ice-cream/pint
[DEBUG] 25-10-04 16:22:12 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:22:12 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 16:22:12 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 16:22:12 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:22:12 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 16:22:12 [MyInterceptor:122] - running time: 84(ms)
[INFO ] 25-10-04 16:22:29 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:22:29 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:22:29 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[INFO ] 25-10-04 16:22:29 [MyInterceptor:101] - - REFERER : time=16550, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 16:22:29 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:22:29 [selectVariantDetail:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:22:29 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-cheesecake-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:22:29 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                   |id    |slug                            |name_ko     |description_ko                    |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|30004 |항상 치즈케이크를 먹고 싶어하는 애호가들을 위해 딸기 과육이 가득하고, 부드러운 치즈케이크의 풍미와 환상적인 그라함 크래커 스월이 가득 찬 아이스크림 입니다. |20004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림 |true   |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:22:29 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:22:29 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:22:29 [selectVariantMedia:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:22:29 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30004
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:22:29 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                            |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png    |스트로베리 치즈케이크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null               |1          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null               |5          |
|NUTRITION |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/nutrition/473ml.png  |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:22:29 [selectVariantMedia:135] - <==      Total: 4
[DEBUG] 25-10-04 16:22:29 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:22:29 [selectVariantGallery:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:22:29 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30004
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:22:29 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null   |1          |
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:22:29 [selectVariantGallery:135] - <==      Total: 2
[DEBUG] 25-10-04 16:22:29 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:22:29 [selectVariantIngredients:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:22:29 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30004

[INFO ] 25-10-04 16:22:29 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                    |smartlabel_url |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|아이스크림믹스[유크림, 탈지우유, 정제수, 설탕시럽 (설탕, 정제수), 가당난황, 구아검, 카라기난], 그라함크래커[기타설탕, 옥수수전분, 카놀라유, 대두유, 밀가루], 딸기다이스 [딸기, 설탕, 구아검, 레몬농축과즙], 치즈케이크베이스[설탕, 정제수, 크림치즈, 향료, 젖산], 딸기퓌레 |null           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 16:22:29 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:22:29 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:22:29 [selectVariantSourcing:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:22:29 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30004
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:22:29 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Open Chain Sourcing           |/assets/img/misc/90008_Cocoa_Sourcing_VLS_Simpler_Icons.avif                |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:22:29 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-04 16:22:29 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:22:29 [selectVariantCerts:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:22:29 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30004
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:22:29 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:22:29 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:22:29 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:22:29 [selectRecommendations:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:22:29 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30004
ORDER BY r.slot

[INFO ] 25-10-04 16:22:29 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream   |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30006 |cherry-garcia-ice-cream           |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg           |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:22:29 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:22:29 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:22:29 [selectAvailableCategories:135] - ==> Parameters: 20004(Long)
[INFO ] 25-10-04 16:22:29 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20004
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:22:29 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30004 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 16:22:29 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 16:22:29 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:22:29 [findNextVariant:135] - ==> Parameters: 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long)
[INFO ] 25-10-04 16:22:29 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30004))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30004)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:22:29 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30001 |chunky-monkey-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-04 16:22:29 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:22:29 [MyInterceptor:122] - running time: 91(ms)
[INFO ] 25-10-04 16:24:26 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:24:26 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:24:26 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-pints
[INFO ] 25-10-04 16:24:26 [MyInterceptor:101] - - REFERER : time=117159, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 16:24:26 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 16:24:26 [existsCategorySlug:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 16:24:26 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-pints'

[INFO ] 25-10-04 16:24:26 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 16:24:26 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 16:24:26 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:24:26 [selectByCategory:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 16:24:26 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-pints'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 16:24:26 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|id    |slug                                   |name_ko      |is_new |flavour_type_id |list_slug       |name_ko |url                                                                                |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크  |true   |1               |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png   |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |
|30013 |vanilla-ice-cream                      |바닐라          |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                      |
|30001 |chunky-monkey-ice-cream                |청키 몽키®       |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®     |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png  |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png      |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png            |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png          |
|30002 |half-baked-ice-cream                   |하프베이크드®      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                   |
|30008 |karamel-sutra-core                     |카라멜 수트라      |false  |2               |ice-cream-pints |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                     |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:24:26 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-04 16:24:26 [MyInterceptor:122] - running time: 47(ms)
[INFO ] 25-10-04 16:24:51 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:24:51 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:24:51 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-pints
[INFO ] 25-10-04 16:24:51 [MyInterceptor:101] - - REFERER : time=24610, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 16:24:51 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 16:24:51 [existsCategorySlug:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 16:24:51 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-pints'

[INFO ] 25-10-04 16:24:51 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 16:24:51 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 16:24:51 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:24:51 [selectByCategory:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-04 16:24:51 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-pints'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 16:24:51 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|id    |slug                                   |name_ko      |is_new |flavour_type_id |list_slug       |name_ko |url                                                                                |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크  |true   |1               |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png   |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |
|30013 |vanilla-ice-cream                      |바닐라          |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                      |
|30001 |chunky-monkey-ice-cream                |청키 몽키®       |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®     |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png  |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png      |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png            |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png          |
|30002 |half-baked-ice-cream                   |하프베이크드®      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                   |
|30008 |karamel-sutra-core                     |카라멜 수트라      |false  |2               |ice-cream-pints |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                     |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:24:51 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-04 16:24:51 [MyInterceptor:122] - running time: 49(ms)
[INFO ] 25-10-04 16:25:06 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:06 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:06 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[INFO ] 25-10-04 16:25:06 [MyInterceptor:101] - - REFERER : time=15382, url=http://localhost:8080/flavours/ice-cream-pints
[DEBUG] 25-10-04 16:25:06 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:25:06 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 16:25:06 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 16:25:06 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:06 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 16:25:06 [MyInterceptor:122] - running time: 51(ms)
[INFO ] 25-10-04 16:25:10 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:10 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:10 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-cups
[INFO ] 25-10-04 16:25:10 [MyInterceptor:101] - - REFERER : time=3699, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 16:25:10 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-04 16:25:10 [existsCategorySlug:135] - ==> Parameters: ice-cream-cups(String)
[INFO ] 25-10-04 16:25:10 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-cups'

[INFO ] 25-10-04 16:25:10 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-04 16:25:10 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:10 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:25:10 [selectByCategory:135] - ==> Parameters: ice-cream-cups(String)
[INFO ] 25-10-04 16:25:10 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-cups'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-04 16:25:10 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|----------------|---------------|--------|--------------------------------------------------------------------------------------|
|id    |slug                                  |name_ko     |is_new |flavour_type_id |list_slug      |name_ko |url                                                                                   |
|------|--------------------------------------|------------|-------|----------------|---------------|--------|--------------------------------------------------------------------------------------|
|30023 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |1               |ice-cream-cups |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png               |
|30022 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |1               |ice-cream-cups |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png |
|30021 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니 |false  |1               |ice-cream-cups |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png     |
|------|--------------------------------------|------------|-------|----------------|---------------|--------|--------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:10 [selectByCategory:135] - <==      Total: 3
[INFO ] 25-10-04 16:25:10 [MyInterceptor:122] - running time: 70(ms)
[INFO ] 25-10-04 16:25:17 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:17 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:17 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[INFO ] 25-10-04 16:25:17 [MyInterceptor:101] - - REFERER : time=7120, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 16:25:17 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:17 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:17 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:17 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                 |id    |slug                                 |name_ko     |description_ko                              |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|
|30010 |1985년에 벤앤제리스는 뉴욕만의 새로운 플레이버로 다양한 종류의 청크들을 넣은 뉴욕 수퍼 퍼지 청크를 탄생시켰습니다. 뉴욕에서도 인기있는 플레이버라면 어디서든 맛 볼 수 있을거라 생각했어요. 실제로도 그렇고요. |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:17 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:17 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:17 [selectVariantMedia:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:17 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30010
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:17 [resultsettable:610] - 
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                     |alt_ko             |sort_order |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |뉴욕 수퍼 퍼지 청크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:25:17 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:17 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:17 [selectVariantGallery:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:17 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30010
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:17 [resultsettable:610] - 
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                     |alt_ko |sort_order |
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:17 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:17 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:17 [selectVariantIngredients:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:17 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30010

[INFO ] 25-10-04 16:25:17 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                |smartlabel_url                                                                                                           |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100149-0002-en-US-1670951315103/index.html#nutrition |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:17 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:17 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:17 [selectVariantSourcing:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:17 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30010
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:17 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:17 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:17 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:17 [selectVariantCerts:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:17 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30010
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:17 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:17 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:17 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:17 [selectRecommendations:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:17 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30010
ORDER BY r.slot

[INFO ] 25-10-04 16:25:17 [resultsettable:610] - 
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|
|id    |slug                          |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                    |sortorder |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream       |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg       |5         |
|30011 |peanut-butter-cup-ice-cream   |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30012 |pistachio-pistachio-ice-cream |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:17 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:17 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:17 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-04 16:25:17 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:17 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:25:17 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:17 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:17 [findNextVariant:135] - ==> Parameters: 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long)
[INFO ] 25-10-04 16:25:17 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30010))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30010)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:17 [resultsettable:610] - 
|------|--------------------------------|-----|
|id    |slug                            |slug |
|------|--------------------------------|-----|
|30009 |mint-chocolate-cookie-ice-cream |pint |
|------|--------------------------------|-----|

[DEBUG] 25-10-04 16:25:17 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:17 [MyInterceptor:122] - running time: 71(ms)
[INFO ] 25-10-04 16:25:21 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:21 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:21 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[INFO ] 25-10-04 16:25:21 [MyInterceptor:101] - - REFERER : time=3809, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[DEBUG] 25-10-04 16:25:21 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:21 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-04 16:25:21 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-04 16:25:21 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                          |id    |slug                                 |name_ko     |description_ko                              |is_new |flavour_type_id |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----------|------------------------|--------|
|30039 |오늘부턴 나도 뉴요커! 고소한 아몬드, 호두와 풍부한 초콜릿의 맛이 당신에게 잊을 수 없는 순간을 선물합니다. 뉴욕의 풍부하고 깊은 맛을 사랑하는 사람과 함께 즐겨보세요! |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |1               |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----------|------------------------|--------|

[DEBUG] 25-10-04 16:25:21 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:21 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:21 [selectVariantMedia:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 16:25:21 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30039
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:21 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                       |alt_ko            |sort_order |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png    |뉴욕 수퍼 퍼지 청크 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-04 16:25:21 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:21 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:21 [selectVariantGallery:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 16:25:21 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30039
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:21 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                       |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:21 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:21 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:21 [selectVariantIngredients:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 16:25:21 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30039

[INFO ] 25-10-04 16:25:21 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                |smartlabel_url |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |null           |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 16:25:21 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:21 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:21 [selectVariantSourcing:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 16:25:21 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30039
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:21 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:21 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:21 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:21 [selectVariantCerts:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 16:25:21 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30039
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:21 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:21 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:21 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:21 [selectRecommendations:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-04 16:25:21 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30039
ORDER BY r.slot

[INFO ] 25-10-04 16:25:21 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |flavour_type_id |code               |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|
|30035 |chunky-monkey-ice-cream               |청키 몽키®      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |0         |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |0         |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:21 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:21 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:21 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-04 16:25:21 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:21 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:25:21 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:21 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:21 [findNextVariant:135] - ==> Parameters: 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long)
[INFO ] 25-10-04 16:25:21 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30039))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30039)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:21 [resultsettable:610] - 
|------|-------------------------------|-----------|
|id    |slug                           |slug       |
|------|-------------------------------|-----------|
|30038 |mint-chocolate-chunk-ice-cream |scoop-shop |
|------|-------------------------------|-----------|

[DEBUG] 25-10-04 16:25:21 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:21 [MyInterceptor:122] - running time: 93(ms)
[INFO ] 25-10-04 16:25:23 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:23 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:23 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[INFO ] 25-10-04 16:25:23 [MyInterceptor:101] - - REFERER : time=1530, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[DEBUG] 25-10-04 16:25:23 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:23 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:23 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:23 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                 |id    |slug                                 |name_ko     |description_ko                              |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|
|30010 |1985년에 벤앤제리스는 뉴욕만의 새로운 플레이버로 다양한 종류의 청크들을 넣은 뉴욕 수퍼 퍼지 청크를 탄생시켰습니다. 뉴욕에서도 인기있는 플레이버라면 어디서든 맛 볼 수 있을거라 생각했어요. 실제로도 그렇고요. |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:23 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:23 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:23 [selectVariantMedia:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:23 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30010
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:23 [resultsettable:610] - 
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                     |alt_ko             |sort_order |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |뉴욕 수퍼 퍼지 청크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:25:23 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:23 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:23 [selectVariantGallery:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:23 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30010
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:23 [resultsettable:610] - 
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                     |alt_ko |sort_order |
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:23 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:23 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:23 [selectVariantIngredients:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:23 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30010

[INFO ] 25-10-04 16:25:23 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                |smartlabel_url                                                                                                           |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100149-0002-en-US-1670951315103/index.html#nutrition |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:23 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:23 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:23 [selectVariantSourcing:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:23 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30010
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:23 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:23 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:23 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:23 [selectVariantCerts:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:23 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30010
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:23 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:23 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:23 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:23 [selectRecommendations:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-04 16:25:23 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30010
ORDER BY r.slot

[INFO ] 25-10-04 16:25:23 [resultsettable:610] - 
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|
|id    |slug                          |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                    |sortorder |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream       |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg       |5         |
|30011 |peanut-butter-cup-ice-cream   |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30012 |pistachio-pistachio-ice-cream |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|----------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:23 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:23 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:23 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-04 16:25:23 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:23 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:25:23 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:23 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:23 [findNextVariant:135] - ==> Parameters: 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long)
[INFO ] 25-10-04 16:25:23 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30010))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30010)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:23 [resultsettable:610] - 
|------|--------------------------------|-----|
|id    |slug                            |slug |
|------|--------------------------------|-----|
|30009 |mint-chocolate-cookie-ice-cream |pint |
|------|--------------------------------|-----|

[DEBUG] 25-10-04 16:25:23 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:23 [MyInterceptor:122] - running time: 71(ms)
[INFO ] 25-10-04 16:25:52 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:52 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:52 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/mint-chocolate-cookie-ice-cream/pint
[INFO ] 25-10-04 16:25:52 [MyInterceptor:101] - - REFERER : time=28871, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[DEBUG] 25-10-04 16:25:52 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:52 [selectVariantDetail:135] - ==> Parameters: mint-chocolate-cookie-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:52 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'mint-chocolate-cookie-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:52 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------------------------|------|--------------------------------|------------|-------------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                           |id    |slug                            |name_ko     |description_ko                             |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------------------------|------|--------------------------------|------------|-------------------------------------------|-------|----------------|-----|----------------|--------|
|30009 |신선한 민트 아이스크림 베이스에 초콜릿 쿠키가 덩어리 채 들어있는 아이스크림.인공색소가 들어가지 않은 하얀색 민트 아이스크림과 초콜릿이 선사하는 색다른 달콤함을 즐겨보세요! |20009 |mint-chocolate-cookie-ice-cream |민트 초콜릿 칩 쿠키 |신선한 민트 아이스크림 베이스에 초콜릿 쿠키가 덩어리 채 들어있는 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------------------------|------|--------------------------------|------------|-------------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:52 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:52 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:52 [selectVariantMedia:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-04 16:25:52 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30009
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:52 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |민트 초콜릿 칩 쿠키 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:25:52 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:52 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:52 [selectVariantGallery:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-04 16:25:52 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30009
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:52 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|-----------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:52 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:52 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:52 [selectVariantIngredients:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-04 16:25:52 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30009

[INFO ] 25-10-04 16:25:52 [resultsettable:610] - 
|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                      |smartlabel_url                                                                                                           |
|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽 (설탕, 정제수), 정제수, 가당난황, 구아검, 초콜릿샌드위치쿠키,설탕, 밀가루, 코코넛유, 코코아분말, 해바라기유, 소금, 탄산수소나트륨, 천연향료, 대두레시틴, 페퍼민트추출물. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100040-0002-en-US-1672414892314/index.html#nutrition |
|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:52 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:52 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:52 [selectVariantSourcing:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-04 16:25:52 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30009
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:52 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:52 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:52 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:52 [selectVariantCerts:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-04 16:25:52 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30009
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:52 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:52 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:52 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:52 [selectRecommendations:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-04 16:25:52 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30009
ORDER BY r.slot

[INFO ] 25-10-04 16:25:52 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|30004 |strawberry-cheesecake-ice-cream   |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png   |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|30013 |vanilla-ice-cream                 |바닐라         |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:52 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:52 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:52 [selectAvailableCategories:135] - ==> Parameters: 20009(Long)
[INFO ] 25-10-04 16:25:52 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20009
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:52 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30009 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 16:25:52 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:52 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:52 [findNextVariant:135] - ==> Parameters: 30009(Long), 30009(Long), 30009(Long), 30009(Long), 30009(Long), 30009(Long)
[INFO ] 25-10-04 16:25:52 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30009))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30009)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30009)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30009)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30009)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30009)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:52 [resultsettable:610] - 
|------|------------------|-----|
|id    |slug              |slug |
|------|------------------|-----|
|30013 |vanilla-ice-cream |pint |
|------|------------------|-----|

[DEBUG] 25-10-04 16:25:52 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:52 [MyInterceptor:122] - running time: 80(ms)
[INFO ] 25-10-04 16:25:53 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:53 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:53 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/vanilla-ice-cream/pint
[INFO ] 25-10-04 16:25:53 [MyInterceptor:101] - - REFERER : time=1101, url=http://localhost:8080/flavours/mint-chocolate-cookie-ice-cream/pint
[DEBUG] 25-10-04 16:25:53 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:53 [selectVariantDetail:135] - ==> Parameters: vanilla-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:53 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'vanilla-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:53 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------|------|------------------|--------|---------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                         |id    |slug              |name_ko |description_ko |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------|------|------------------|--------|---------------|-------|----------------|-----|----------------|--------|
|30013 |이 파인트를 더 먹어보면 풍부한 맛의 크림같은 바닐라를 느낄 수 있습니다. 지금까지 맛본 어떤 바닐라보다 더 맛있는 바닐라 맛을 즐겨보세요. |20013 |vanilla-ice-cream |바닐라     |바닐라 아이스크림      |false  |1               |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------|------|------------------|--------|---------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:53 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:53 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:53 [selectVariantMedia:135] - ==> Parameters: 30013(Long)
[INFO ] 25-10-04 16:25:53 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30013
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:53 [resultsettable:610] - 
|----------|---------------------------------------------------------------------|------------|-----------|
|role      |url                                                                  |alt_ko      |sort_order |
|----------|---------------------------------------------------------------------|------------|-----------|
|PACKSHOT  |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png        |바닐라 파인트 팩샷  |0          |
|GALLERY   |/assets/img/flavours/vanilla-ice-cream/pint/gallery/01-tower.png     |null        |1          |
|GALLERY   |/assets/img/flavours/vanilla-ice-cream/pint/gallery/02-envirolid.jpg |null        |2          |
|GALLERY   |/assets/img/flavours/vanilla-ice-cream/pint/gallery/03-scooped.jpg   |null        |3          |
|GALLERY   |/assets/img/flavours/vanilla-ice-cream/pint/gallery/04-enviro.jpg    |null        |4          |
|GALLERY   |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg      |null        |5          |
|NUTRITION |/assets/img/flavours/vanilla-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml |0          |
|----------|---------------------------------------------------------------------|------------|-----------|

[DEBUG] 25-10-04 16:25:53 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:53 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:53 [selectVariantGallery:135] - ==> Parameters: 30013(Long)
[INFO ] 25-10-04 16:25:53 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30013
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:53 [resultsettable:610] - 
|--------|---------------------------------------------------------------------|-------|-----------|
|role    |url                                                                  |alt_ko |sort_order |
|--------|---------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/vanilla-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/vanilla-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/vanilla-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/vanilla-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:53 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:53 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:53 [selectVariantIngredients:135] - ==> Parameters: 30013(Long)
[INFO ] 25-10-04 16:25:53 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30013

[INFO ] 25-10-04 16:25:53 [resultsettable:610] - 
|---------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                 |smartlabel_url                                                                                                           |
|---------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 계란 노른자, 설탕, 구아검, 바닐라 추출물, 바닐라 빈, 카라기난. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840400058-0002-en-US-1671461174511/index.html#nutrition |
|---------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:53 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:53 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:53 [selectVariantSourcing:135] - ==> Parameters: 30013(Long)
[INFO ] 25-10-04 16:25:53 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30013
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:53 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:53 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:53 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:53 [selectVariantCerts:135] - ==> Parameters: 30013(Long)
[INFO ] 25-10-04 16:25:53 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30013
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:53 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:53 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:53 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:53 [selectRecommendations:135] - ==> Parameters: 30013(Long)
[INFO ] 25-10-04 16:25:53 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30013
ORDER BY r.slot

[INFO ] 25-10-04 16:25:53 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|-----|----------------|--------|----------------|-------------------|-------------------------------------------------------------------------------------|----------|
|id    |slug                                   |name_ko      |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                             |sortorder |
|------|---------------------------------------|-------------|-------|-----|----------------|--------|----------------|-------------------|-------------------------------------------------------------------------------------|----------|
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png  |5         |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg        |5         |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|---------------------------------------|-------------|-------|-----|----------------|--------|----------------|-------------------|-------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:53 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:53 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:53 [selectAvailableCategories:135] - ==> Parameters: 20013(Long)
[INFO ] 25-10-04 16:25:53 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20013
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:53 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30013 |
|SCOOP |scoop-shop |스쿱 샵    |30041 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:25:53 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:53 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:53 [findNextVariant:135] - ==> Parameters: 30013(Long), 30013(Long), 30013(Long), 30013(Long), 30013(Long), 30013(Long)
[INFO ] 25-10-04 16:25:53 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30013))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30013)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30013)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30013)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30013)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30013)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:53 [resultsettable:610] - 
|------|--------------------------------|-----|
|id    |slug                            |slug |
|------|--------------------------------|-----|
|30004 |strawberry-cheesecake-ice-cream |pint |
|------|--------------------------------|-----|

[DEBUG] 25-10-04 16:25:53 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:53 [MyInterceptor:122] - running time: 77(ms)
[INFO ] 25-10-04 16:25:54 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:54 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:54 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[INFO ] 25-10-04 16:25:54 [MyInterceptor:101] - - REFERER : time=1122, url=http://localhost:8080/flavours/vanilla-ice-cream/pint
[DEBUG] 25-10-04 16:25:54 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:54 [selectVariantDetail:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:54 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-cheesecake-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:54 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                   |id    |slug                            |name_ko     |description_ko                    |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|
|30004 |항상 치즈케이크를 먹고 싶어하는 애호가들을 위해 딸기 과육이 가득하고, 부드러운 치즈케이크의 풍미와 환상적인 그라함 크래커 스월이 가득 찬 아이스크림 입니다. |20004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림 |true   |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:54 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:54 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:54 [selectVariantMedia:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:25:54 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30004
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:54 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                            |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png    |스트로베리 치즈케이크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null               |1          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null               |5          |
|NUTRITION |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/nutrition/473ml.png  |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:25:54 [selectVariantMedia:135] - <==      Total: 4
[DEBUG] 25-10-04 16:25:54 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:54 [selectVariantGallery:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:25:54 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30004
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:54 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null   |1          |
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:54 [selectVariantGallery:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:54 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:54 [selectVariantIngredients:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:25:54 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30004

[INFO ] 25-10-04 16:25:54 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                    |smartlabel_url |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|아이스크림믹스[유크림, 탈지우유, 정제수, 설탕시럽 (설탕, 정제수), 가당난황, 구아검, 카라기난], 그라함크래커[기타설탕, 옥수수전분, 카놀라유, 대두유, 밀가루], 딸기다이스 [딸기, 설탕, 구아검, 레몬농축과즙], 치즈케이크베이스[설탕, 정제수, 크림치즈, 향료, 젖산], 딸기퓌레 |null           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 16:25:54 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:54 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:54 [selectVariantSourcing:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:25:54 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30004
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:54 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Open Chain Sourcing           |/assets/img/misc/90008_Cocoa_Sourcing_VLS_Simpler_Icons.avif                |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:54 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-04 16:25:54 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:54 [selectVariantCerts:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:25:54 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30004
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:54 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:25:54 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:25:54 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:54 [selectRecommendations:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-04 16:25:54 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30004
ORDER BY r.slot

[INFO ] 25-10-04 16:25:54 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream   |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30006 |cherry-garcia-ice-cream           |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg           |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:54 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:54 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:54 [selectAvailableCategories:135] - ==> Parameters: 20004(Long)
[INFO ] 25-10-04 16:25:54 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20004
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:54 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30004 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 16:25:54 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:54 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:54 [findNextVariant:135] - ==> Parameters: 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long)
[INFO ] 25-10-04 16:25:54 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30004))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30004)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:54 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30001 |chunky-monkey-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-04 16:25:54 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:54 [MyInterceptor:122] - running time: 62(ms)
[INFO ] 25-10-04 16:25:55 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:55 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:55 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chunky-monkey-ice-cream/pint
[INFO ] 25-10-04 16:25:55 [MyInterceptor:101] - - REFERER : time=577, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[DEBUG] 25-10-04 16:25:55 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:55 [selectVariantDetail:135] - ==> Parameters: chunky-monkey-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chunky-monkey-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                 |id    |slug                    |name_ko |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----|----------------|--------|
|30001 |이름만큼 재미있는 맛을 내기 위해 최종적으로 맛을 결정할 때까지 여러 개의 테스트 배치를 가지고 놀았습니다. 원숭이가 먹을 바나나는 없지만 견과류와 초콜릿 덩어리가 가득 들어있습니다. |20001 |chunky-monkey-ice-cream |청키 몽키®  |호두 퍼지 덩어리가 들어간 바나나 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:55 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:55 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:55 [selectVariantMedia:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30001
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|-------------|-----------|
|role      |url                                                                        |alt_ko       |sort_order |
|----------|---------------------------------------------------------------------------|-------------|-----------|
|PACKSHOT  |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png        |청키 몽키 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/01-tower.avif    |null         |1          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/02-envirolid.jpg |null         |2          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/03-scooped.jpg   |null         |3          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/04-enviro.jpg    |null         |4          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg      |null         |5          |
|NUTRITION |/assets/img/flavours/chunky-monkey-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml  |0          |
|----------|---------------------------------------------------------------------------|-------------|-----------|

[DEBUG] 25-10-04 16:25:55 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:55 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:55 [selectVariantGallery:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30001
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/01-tower.avif    |null   |1          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:55 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:55 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:55 [selectVariantIngredients:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30001

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                             |smartlabel_url                                                                                                 |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽(설탕, 정제수), 정제수, 설탕, 코코아, 코코아분말, 대두유, 난황, 수수설탕, 전란, 전란액, 소금, 구아검, 카라기난, 바닐라추출물, 맥아분말, 탄산수소나트륨 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100354-0003-en-US-1665758042857/index.html |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:55 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:55 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:55 [selectVariantSourcing:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30001
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:55 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:55 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:55 [selectVariantCerts:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30001
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:55 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:55 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:55 [selectRecommendations:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30001
ORDER BY r.slot

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30006 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30011 |peanut-butter-cup-ice-cream          |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg          |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:55 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:55 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:55 [selectAvailableCategories:135] - ==> Parameters: 20001(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20001
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30001 |
|SCOOP |scoop-shop |스쿱 샵    |30035 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:25:55 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:55 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:55 [findNextVariant:135] - ==> Parameters: 30001(Long), 30001(Long), 30001(Long), 30001(Long), 30001(Long), 30001(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30001))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30001)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30001)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30001)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30001)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30001)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30006 |cherry-garcia-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-04 16:25:55 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:55 [MyInterceptor:122] - running time: 72(ms)
[INFO ] 25-10-04 16:25:55 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:55 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:55 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[INFO ] 25-10-04 16:25:55 [MyInterceptor:101] - - REFERER : time=459, url=http://localhost:8080/flavours/chunky-monkey-ice-cream/pint
[DEBUG] 25-10-04 16:25:55 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:55 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:55 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:55 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:55 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 16:25:55 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:55 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:55 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:55 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:55 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:55 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:55 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:55 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:55 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:55 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:55 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:55 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:55 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:55 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:55 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:55 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:55 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:55 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 16:25:55 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:55 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:55 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-04 16:25:55 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:55 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-04 16:25:55 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:55 [MyInterceptor:122] - running time: 50(ms)
[INFO ] 25-10-04 16:25:56 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:56 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:56 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/pint
[INFO ] 25-10-04 16:25:56 [MyInterceptor:101] - - REFERER : time=466, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-04 16:25:56 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:56 [selectVariantDetail:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:56 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:56 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|----------------|-----|----------------|--------|
|30005 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:56 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:56 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:56 [selectVariantMedia:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:25:56 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30005
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:56 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                      |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png        |초콜릿 칩 쿠키 도우 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null               |5          |
|NUTRITION |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:25:56 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:56 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:56 [selectVariantGallery:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:25:56 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30005
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:56 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                      |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null   |5          |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:56 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:56 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:56 [selectVariantIngredients:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:25:56 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30005

[INFO ] 25-10-04 16:25:56 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100583-0002-en-US-1669211882662/index.html |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:56 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:56 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:56 [selectVariantSourcing:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:25:56 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30005
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:56 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:56 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:56 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:56 [selectVariantCerts:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:25:56 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30005
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:56 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:25:56 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:25:56 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:56 [selectRecommendations:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-04 16:25:56 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30005
ORDER BY r.slot

[INFO ] 25-10-04 16:25:56 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30013 |vanilla-ice-cream                    |바닐라         |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                    |5         |
|30002 |half-baked-ice-cream                 |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:56 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:56 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:56 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-04 16:25:56 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:56 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 16:25:56 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:56 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:56 [findNextVariant:135] - ==> Parameters: 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long)
[INFO ] 25-10-04 16:25:56 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30005))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30005)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:56 [resultsettable:610] - 
|------|----------------------------------|-----|
|id    |slug                              |slug |
|------|----------------------------------|-----|
|30003 |chocolate-fudge-brownie-ice-cream |pint |
|------|----------------------------------|-----|

[DEBUG] 25-10-04 16:25:56 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:56 [MyInterceptor:122] - running time: 89(ms)
[INFO ] 25-10-04 16:25:58 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:58 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:58 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/pint
[INFO ] 25-10-04 16:25:58 [MyInterceptor:101] - - REFERER : time=1645, url=http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/pint
[DEBUG] 25-10-04 16:25:58 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:58 [selectVariantDetail:135] - ==> Parameters: chocolate-fudge-brownie-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-fudge-brownie-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                      |id    |slug                              |name_ko     |description_ko         |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|----------------|-----|----------------|--------|
|30003 |풍부한 맛을 지닌 다크 초콜릿에 브라우니 퍼지 덩어리를 절묘하게 배합한 아이스크림입니다. 꿈꿔왔던 그 맛. |20003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |퍼지 브라우니가 들어간 초콜릿 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:58 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:58 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:58 [selectVariantMedia:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30003
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                  |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png        |초콜릿 퍼지 브라우니 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:25:58 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:58 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:58 [selectVariantGallery:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30003
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                  |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|-------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:58 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:58 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:58 [selectVariantIngredients:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30003

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                               |smartlabel_url                                                                                                           |
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 액상당, 농축 탈지유, 물, 코코아, 설탕, 밀가루, 대두유, 계란 노른자, 전화당, 계란, 계란 흰자, 농후제(구아검, 카라기난), 설탕, 바닐라 추출물, 팽창제(중탄산나트륨), 맥아분 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100477-0002-en-US-1668535427889/index.html#nutrition |
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:58 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:58 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:58 [selectVariantSourcing:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30003
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Greyston Brownies             |/assets/img/misc/90007_Greyston_Brownies_VLS_Simpler_Icons.png              |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:58 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-04 16:25:58 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:58 [selectVariantCerts:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30003
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Halal        |/assets/img/misc/91001_Halal_Dietary_Icon.avif       |
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:58 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:58 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:58 [selectRecommendations:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30003
ORDER BY r.slot

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------|----------|
|id    |slug                            |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                      |sortorder |
|------|--------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg |5         |
|30002 |half-baked-ice-cream            |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg            |5         |
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |5         |
|------|--------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:58 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:58 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:58 [selectAvailableCategories:135] - ==> Parameters: 20003(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20003
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30003 |
|MINI_CUP |mini-cup   |미니컵     |30021 |
|SCOOP    |scoop-shop |스쿱 샵    |30034 |
|---------|-----------|--------|------|

[DEBUG] 25-10-04 16:25:58 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:58 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:58 [findNextVariant:135] - ==> Parameters: 30003(Long), 30003(Long), 30003(Long), 30003(Long), 30003(Long), 30003(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30003))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30003)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30003)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30003)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30003)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30003)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|------|---------------------------------------|-----|
|id    |slug                                   |slug |
|------|---------------------------------------|-----|
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |pint |
|------|---------------------------------------|-----|

[DEBUG] 25-10-04 16:25:58 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:58 [MyInterceptor:122] - running time: 75(ms)
[INFO ] 25-10-04 16:25:58 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:58 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:58 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint
[INFO ] 25-10-04 16:25:58 [MyInterceptor:101] - - REFERER : time=555, url=http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/pint
[DEBUG] 25-10-04 16:25:58 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:58 [selectVariantDetail:135] - ==> Parameters: coffee-coffee-buzz-buzz-buzz-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'coffee-coffee-buzz-buzz-buzz-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|------|------------------------------------------------------------------------------|------|---------------------------------------|-------------|-------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                        |id    |slug                                   |name_ko      |description_ko                       |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|------------------------------------------------------------------------------|------|---------------------------------------|-------------|-------------------------------------|-------|----------------|-----|----------------|--------|
|30007 |당신의 정신을 번쩍 들게 할, 그리고 곧 사랑을 빠져 노래를 흥얼거리게 만드는 맛! 크리미한 커피 맛 아이스크림에 에스프레소 퍼지가 가득! |20007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |커피 아이스크림 베이스에 에스프레소 빈 퍼지가 들어있는 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|------------------------------------------------------------------------------|------|---------------------------------------|-------------|-------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:58 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:58 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:58 [selectVariantMedia:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30007
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|----------|------------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                       |alt_ko             |sort_order |
|----------|------------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png        |커피커피 버즈버즈버즈 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|------------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-04 16:25:58 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:58 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:58 [selectVariantGallery:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30007
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                       |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:58 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:58 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:58 [selectVariantIngredients:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30007

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                           |smartlabel_url                                                                                                           |
|-----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽(설탕, 정제수), 정제수, 설탕, 코코넛유, 커피추출물, 코코아, 커피, 코코아분말, 대두레시틴, 구아검, 바닐라추출물, 카라기난. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840298617-0002-en-US-1677511188913/index.html#nutrition |
|-----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:58 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:58 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:58 [selectVariantSourcing:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30007
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:58 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:58 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:58 [selectVariantCerts:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30007
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:58 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:58 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:58 [selectRecommendations:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30007
ORDER BY r.slot

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------|----------|
|id    |slug                            |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                      |sortorder |
|------|--------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg |5         |
|30013 |vanilla-ice-cream               |바닐라         |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg               |5         |
|30011 |peanut-butter-cup-ice-cream     |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg     |5         |
|------|--------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:58 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:58 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:58 [selectAvailableCategories:135] - ==> Parameters: 20007(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20007
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30007 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 16:25:58 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:58 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:58 [findNextVariant:135] - ==> Parameters: 30007(Long), 30007(Long), 30007(Long), 30007(Long), 30007(Long), 30007(Long)
[INFO ] 25-10-04 16:25:58 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30007))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30007)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30007)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30007)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30007)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30007)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:58 [resultsettable:610] - 
|------|----------------------------|-----|
|id    |slug                        |slug |
|------|----------------------------|-----|
|30011 |peanut-butter-cup-ice-cream |pint |
|------|----------------------------|-----|

[DEBUG] 25-10-04 16:25:58 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:58 [MyInterceptor:122] - running time: 72(ms)
[INFO ] 25-10-04 16:25:59 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:59 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:59 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/peanut-butter-cup-ice-cream/pint
[INFO ] 25-10-04 16:25:59 [MyInterceptor:101] - - REFERER : time=516, url=http://localhost:8080/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint
[DEBUG] 25-10-04 16:25:59 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:59 [selectVariantDetail:135] - ==> Parameters: peanut-butter-cup-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'peanut-butter-cup-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|------|-------------------------------------------------------------|------|----------------------------|--------|----------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                       |id    |slug                        |name_ko |description_ko                          |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------|------|----------------------------|--------|----------------------------------------|-------|----------------|-----|----------------|--------|
|30011 |고소한 피넛(땅콩) 버터 아이스크림에 달콤하고 짭조름한 피넛(땅콩) 버터 초콜릿이 콕콕 박혀있는 아이스크림. |20011 |peanut-butter-cup-ice-cream |피넛 버터 컵 |고소한 피넛버터 아이스크림에 피넛버터 초콜릿이 콕콕 박혀있는 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------|------|----------------------------|--------|----------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:59 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:59 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:59 [selectVariantMedia:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30011
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                            |alt_ko         |sort_order |
|----------|-------------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png        |피넛 버터 컵 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|-------------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-04 16:25:59 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:59 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:59 [selectVariantGallery:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30011
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:59 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:59 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:59 [selectVariantIngredients:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30011

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                |smartlabel_url                                                                                                 |
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|유크림, 탈지농축우유, 설탕 시럽 (설탕, 정제수), 정제수, 땅콩, 설탕, 코코넛유, 계란 노른자, 부분 지방질 땅콩 가루, 땅콩기름, 우유, 코코아 (알칼리 처리), 소금, 구아검, 대두 레시틴, 바닐라 추출물, 카라기난 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100811-0002-en-US-1675809822278/index.html |
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:59 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:59 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:59 [selectVariantSourcing:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30011
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:59 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-04 16:25:59 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:59 [selectVariantCerts:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30011
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:59 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:59 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:59 [selectRecommendations:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30011
ORDER BY r.slot

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30012 |pistachio-pistachio-ice-cream        |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg        |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30009 |mint-chocolate-cookie-ice-cream      |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:59 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:59 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:59 [selectAvailableCategories:135] - ==> Parameters: 20011(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20011
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30011 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 16:25:59 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:59 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:59 [findNextVariant:135] - ==> Parameters: 30011(Long), 30011(Long), 30011(Long), 30011(Long), 30011(Long), 30011(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30011))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30011)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30011)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30011)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30011)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30011)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|------|------------------------------|-----|
|id    |slug                          |slug |
|------|------------------------------|-----|
|30012 |pistachio-pistachio-ice-cream |pint |
|------|------------------------------|-----|

[DEBUG] 25-10-04 16:25:59 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:59 [MyInterceptor:122] - running time: 76(ms)
[INFO ] 25-10-04 16:25:59 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:25:59 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:25:59 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/pistachio-pistachio-ice-cream/pint
[INFO ] 25-10-04 16:25:59 [MyInterceptor:101] - - REFERER : time=503, url=http://localhost:8080/flavours/peanut-butter-cup-ice-cream/pint
[DEBUG] 25-10-04 16:25:59 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:25:59 [selectVariantDetail:135] - ==> Parameters: pistachio-pistachio-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'pistachio-pistachio-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------|------|------------------------------|------------|---------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                         |id    |slug                          |name_ko     |description_ko                   |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------|------|------------------------------|------------|---------------------------------|-------|----------------|-----|----------------|--------|
|30012 |이름만으로도 우리가 피스타치오를 얼마나 사랑하는지 알 수 있습니다. 하지만 우리의 말을 그대로 받아들이지 말고, 맛 자체를 말하도록 하세요! |20012 |pistachio-pistachio-ice-cream |피스타치오 피스타치오 |가볍게 로스팅한 피스타치오가 들어있는 피스타치오 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------|------|------------------------------|------------|---------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:25:59 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:59 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:25:59 [selectVariantMedia:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30012
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------------|-------------|-----------|
|role      |url                                                                              |alt_ko       |sort_order |
|----------|---------------------------------------------------------------------------------|-------------|-----------|
|PACKSHOT  |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png        |피스타치오 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/01-tower.avif    |null         |1          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/02-envirolid.jpg |null         |2          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/03-scooped.jpg   |null         |3          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/04-enviro.jpg    |null         |4          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg      |null         |5          |
|NUTRITION |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml  |0          |
|----------|---------------------------------------------------------------------------------|-------------|-----------|

[DEBUG] 25-10-04 16:25:59 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:25:59 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:25:59 [selectVariantGallery:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30012
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                              |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/01-tower.avif    |null   |1          |
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:25:59 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:25:59 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:25:59 [selectVariantIngredients:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30012

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|ingredients_ko                                                                                   |smartlabel_url                                                        |
|-------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|아이스크림믹스 [유크림, 탈지우유, 설탕시럽 (설탕, 정제수), 정제수, 가당난황, 구아검, 카라기난], 로스티드피스 타치오 [피스타치오, 코코넛유, 소금], 피스타치오향료 |https://smartlabel.unileverusa.com/076840101184-0002-en-US/index.html |
|-------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:59 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:59 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:25:59 [selectVariantSourcing:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30012
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-04 16:25:59 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-04 16:25:59 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:25:59 [selectVariantCerts:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30012
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:25:59 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 16:25:59 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:25:59 [selectRecommendations:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30012
ORDER BY r.slot

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30011 |peanut-butter-cup-ice-cream          |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg          |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30009 |mint-chocolate-cookie-ice-cream      |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:25:59 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:25:59 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:25:59 [selectAvailableCategories:135] - ==> Parameters: 20012(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20012
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30012 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 16:25:59 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 16:25:59 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:25:59 [findNextVariant:135] - ==> Parameters: 30012(Long), 30012(Long), 30012(Long), 30012(Long), 30012(Long), 30012(Long)
[INFO ] 25-10-04 16:25:59 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30012))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30012)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30012)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30012)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30012)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30012)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:25:59 [resultsettable:610] - 
|------|---------------------|-----|
|id    |slug                 |slug |
|------|---------------------|-----|
|30002 |half-baked-ice-cream |pint |
|------|---------------------|-----|

[DEBUG] 25-10-04 16:25:59 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:25:59 [MyInterceptor:122] - running time: 89(ms)
[INFO ] 25-10-04 16:26:00 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:26:00 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:26:00 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/half-baked-ice-cream/pint
[INFO ] 25-10-04 16:26:00 [MyInterceptor:101] - - REFERER : time=514, url=http://localhost:8080/flavours/pistachio-pistachio-ice-cream/pint
[DEBUG] 25-10-04 16:26:00 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:26:00 [selectVariantDetail:135] - ==> Parameters: half-baked-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:26:00 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'half-baked-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:26:00 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                                                                                                                                                                                         |id    |slug                 |name_ko |description_ko                                   |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|----------------|-----|----------------|--------|
|30002 |우리는 스쿱샵에 들릴 때 마다 우리의 친구들이 가장 맛있을 법한 새롭고 쿨한 콤보를 만들기 위해 다양한 맛의 조합을 시도하는 것을 알게 되었습니다. 그때 우리는 이것이 정말 엄청난 아이디어라고 생각 했어요. 그래서 우리는 여러분이 사랑하는 벤앤제리스의 맛과 절묘하게 어우러진 새로운 맛을 찾기 위해 여러분이 새롭게 조합한 맛을 함께 섞어 보았습니다. 여러분은 우리가 엉뚱하다고 말할지도 모르겠지만, 우리는 말할 수 있어요. 이건 하프 베이크드 라고 해! Enjoy! 벤앤제리스를 사랑하는 모든 이들에게 감사해요. |20002 |half-baked-ice-cream |하프베이크드® |초코칩 쿠키도우와 퍼지 브라우니의 청크가 절묘하게 어우러진 초콜릿 & 바닐라 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:26:00 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:26:00 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:26:00 [selectVariantMedia:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:26:00 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30002
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:26:00 [resultsettable:610] - 
|----------|------------------------------------------------------------------------|--------------|-----------|
|role      |url                                                                     |alt_ko        |sort_order |
|----------|------------------------------------------------------------------------|--------------|-----------|
|PACKSHOT  |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png        |하프베이크드 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/01-tower.png     |null          |1          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/02-envirolid.jpg |null          |2          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/03-scooped.jpg   |null          |3          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/04-enviro.jpg    |null          |4          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg      |null          |5          |
|NUTRITION |/assets/img/flavours/half-baked-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml   |0          |
|----------|------------------------------------------------------------------------|--------------|-----------|

[DEBUG] 25-10-04 16:26:00 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:26:00 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:26:00 [selectVariantGallery:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:26:00 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30002
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:26:00 [resultsettable:610] - 
|--------|------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                     |alt_ko |sort_order |
|--------|------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:26:00 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:26:00 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:26:00 [selectVariantIngredients:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:26:00 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30002

[INFO ] 25-10-04 16:26:00 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                     |smartlabel_url                                                                                                           |
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽, 탈지농축우유, 정제수, 설탕, 밀가루, 코코아분말, 갈색 설탕, 가당난황, 대두유, 버터, 계란, 전화당, 초콜릿 리커, 바닐라 추출물, 소금, 계란 흰자, 구아검, 카라기난, 당밀, 코코아버터, 천연향료, 맥아분말 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840101320-0002-en-US-1669212157071/index.html#nutrition |
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:26:00 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:26:00 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:26:00 [selectVariantSourcing:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:26:00 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30002
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:26:00 [resultsettable:610] - 
|----------------|--------------------------------------------------------------|
|name_ko         |icon_url                                                      |
|----------------|--------------------------------------------------------------|
|Non-GMO         |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif         |
|Fairtrade       |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif       |
|Free Range Eggs |/assets/img/misc/90003_Free-range_Eggs_VLS_Simpler_Icons.webp |
|----------------|--------------------------------------------------------------|

[DEBUG] 25-10-04 16:26:00 [selectVariantSourcing:135] - <==      Total: 3
[DEBUG] 25-10-04 16:26:00 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:26:00 [selectVariantCerts:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:26:00 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30002
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:26:00 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-04 16:26:00 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-04 16:26:00 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:26:00 [selectRecommendations:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-04 16:26:00 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30002
ORDER BY r.slot

[INFO ] 25-10-04 16:26:00 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                            |sortorder |
|------|--------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------------|----------|
|30005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png |5         |
|30003 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg     |5         |
|30009 |mint-chocolate-cookie-ice-cream       |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg       |5         |
|------|--------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:26:00 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:26:00 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:26:00 [selectAvailableCategories:135] - ==> Parameters: 20002(Long)
[INFO ] 25-10-04 16:26:00 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20002
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:26:00 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30002 |
|SCOOP |scoop-shop |스쿱 샵    |30036 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:26:00 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:26:00 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:26:00 [findNextVariant:135] - ==> Parameters: 30002(Long), 30002(Long), 30002(Long), 30002(Long), 30002(Long), 30002(Long)
[INFO ] 25-10-04 16:26:00 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30002))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30002)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30002)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30002)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30002)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30002)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:26:00 [resultsettable:610] - 
|------|-------------------|-----|
|id    |slug               |slug |
|------|-------------------|-----|
|30008 |karamel-sutra-core |pint |
|------|-------------------|-----|

[DEBUG] 25-10-04 16:26:00 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:26:00 [MyInterceptor:122] - running time: 57(ms)
[INFO ] 25-10-04 16:26:00 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:26:01 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:26:01 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/karamel-sutra-core/pint
[INFO ] 25-10-04 16:26:01 [MyInterceptor:101] - - REFERER : time=491, url=http://localhost:8080/flavours/half-baked-ice-cream/pint
[DEBUG] 25-10-04 16:26:01 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:26:01 [selectVariantDetail:135] - ==> Parameters: karamel-sutra-core(String), pint(String)
[INFO ] 25-10-04 16:26:01 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'karamel-sutra-core'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:26:01 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------|--------|-------------------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                 |id    |slug               |name_ko |description_ko                       |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------|--------|-------------------------------------|-------|----------------|-----|----------------|--------|
|30008 |벤앤제리스 Core를 통해 최고의 아이스크림을 경험해보세요. 원초적인 충동이 카라멜 수트라의 중심에 있는 부드러운 카라멜로 이끌든 퍼지 칩으로 이끌든, 당신은 카라멜 수트라 맛에 빠져들거에요. 글루텐 프리 제품. |20008 |karamel-sutra-core |카라멜 수트라 |퍼지 칩과 부드러운 카라멜이 들어있는 초콜릿 & 카라멜 아이스크림 |false  |2               |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------|--------|-------------------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:26:01 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:26:01 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:26:01 [selectVariantMedia:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-04 16:26:01 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30008
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:26:01 [resultsettable:610] - 
|----------|----------------------------------------------------------------------|------------------|-----------|
|role      |url                                                                   |alt_ko            |sort_order |
|----------|----------------------------------------------------------------------|------------------|-----------|
|PACKSHOT  |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png        |카라멜 수트라 코어 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/01-tower.png     |null              |1          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/02-envirolid.jpg |null              |2          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/03-scooped.jpg   |null              |3          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/04-enviro.jpg    |null              |4          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/05-hero.jpg      |null              |5          |
|NUTRITION |/assets/img/flavours/karamel-sutra-core/pint/nutrition/473ml.png      |영양성분표 473ml       |0          |
|----------|----------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-04 16:26:01 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:26:01 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:26:01 [selectVariantGallery:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-04 16:26:01 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30008
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:26:01 [resultsettable:610] - 
|--------|----------------------------------------------------------------------|-------|-----------|
|role    |url                                                                   |alt_ko |sort_order |
|--------|----------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/05-hero.jpg      |null   |5          |
|--------|----------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:26:01 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:26:01 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:26:01 [selectVariantIngredients:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-04 16:26:01 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30008

[INFO ] 25-10-04 16:26:01 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                     |smartlabel_url                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽 (설탕, 정제수), 정제수, 설탕, 우유, 옥수수 시럽, 코코아, 달걀 노른자, 코코넛유, 버터 (크림, 소금), 코코아분말, 유지방, 펙틴, 구아검, 베이킹 소다, 락타아제, 대두 레시틴, 바닐라 추출물, 소금, 카라기난, 천연향료. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840101542-0002-en-US-1675805403456/index.html#nutrition |
|---------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:26:01 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:26:01 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:26:01 [selectVariantSourcing:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-04 16:26:01 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30008
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:26:01 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:26:01 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:26:01 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:26:01 [selectVariantCerts:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-04 16:26:01 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30008
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:26:01 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:26:01 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-04 16:26:01 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:26:01 [selectRecommendations:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-04 16:26:01 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30008
ORDER BY r.slot

[INFO ] 25-10-04 16:26:01 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30009 |mint-chocolate-cookie-ice-cream      |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:26:01 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:26:01 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:26:01 [selectAvailableCategories:135] - ==> Parameters: 20008(Long)
[INFO ] 25-10-04 16:26:01 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20008
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:26:01 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30008 |
|-----|-----|--------|------|

[DEBUG] 25-10-04 16:26:01 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-04 16:26:01 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:26:01 [findNextVariant:135] - ==> Parameters: 30008(Long), 30008(Long), 30008(Long), 30008(Long), 30008(Long), 30008(Long)
[INFO ] 25-10-04 16:26:01 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30008))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30008)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30008)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30008)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30008)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30008)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:26:01 [resultsettable:610] - 
|------|------------------------|---------|
|id    |slug                    |slug     |
|------|------------------------|---------|
|30023 |cherry-garcia-ice-cream |mini-cup |
|------|------------------------|---------|

[DEBUG] 25-10-04 16:26:01 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:26:01 [MyInterceptor:122] - running time: 69(ms)
[INFO ] 25-10-04 16:26:02 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:26:02 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:26:02 [MyInterceptor:85] - [GET] http://localhost:8080/flavours
[INFO ] 25-10-04 16:26:02 [MyInterceptor:101] - - REFERER : time=1930, url=http://localhost:8080/flavours/karamel-sutra-core/pint
[DEBUG] 25-10-04 16:26:02 [selectAllFlavours:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:26:02 [selectAllFlavours:135] - ==> Parameters: 
[INFO ] 25-10-04 16:26:02 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_sort_rank ASC, f.name_ko ASC

[INFO ] 25-10-04 16:26:02 [resultsettable:610] - 
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                   |name_ko         |is_new |list_slug               |name_ko |url                                                                                     |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크     |true   |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png             |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png             |
|30013 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-pints         |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                           |
|30001 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                     |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-pints         |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                     |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png       |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png           |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈!    |false  |ice-cream-pints         |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png      |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png                 |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오     |false  |ice-cream-pints         |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png               |
|30002 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                        |
|30008 |karamel-sutra-core                     |카라멜 수트라         |false  |ice-cream-pints         |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                          |
|30023 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png                 |
|30022 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png   |
|30021 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-cups          |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png       |
|30032 |chocolate-ice-cream                    |초콜릿             |true   |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream         |민트 초콜릿 청크       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                      |바닐라             |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream      |스위트 크림&쿠키       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                   |스트로베리           |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream                |청키 몽키®          |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream                |체리 가르시아®        |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니     |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                   |하프베이크드®         |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                        |레모네이드 소르베       |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet       |베리베리 엑스트라 오디너리® |false  |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|---------------------------------------|----------------|-------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:26:02 [selectAllFlavours:135] - <==      Total: 29
[INFO ] 25-10-04 16:26:03 [MyInterceptor:122] - running time: 34(ms)
[INFO ] 25-10-04 16:29:32 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:29:32 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:29:32 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chunky-monkey-ice-cream/pint
[INFO ] 25-10-04 16:29:32 [MyInterceptor:101] - - REFERER : time=209138, url=http://localhost:8080/flavours
[DEBUG] 25-10-04 16:29:32 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:29:32 [selectVariantDetail:135] - ==> Parameters: chunky-monkey-ice-cream(String), pint(String)
[INFO ] 25-10-04 16:29:32 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chunky-monkey-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-04 16:29:32 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----|----------------|--------|
|id    |variant_description_ko                                                                                 |id    |slug                    |name_ko |description_ko           |is_new |flavour_type_id |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----|----------------|--------|
|30001 |이름만큼 재미있는 맛을 내기 위해 최종적으로 맛을 결정할 때까지 여러 개의 테스트 배치를 가지고 놀았습니다. 원숭이가 먹을 바나나는 없지만 견과류와 초콜릿 덩어리가 가득 들어있습니다. |20001 |chunky-monkey-ice-cream |청키 몽키®  |호두 퍼지 덩어리가 들어간 바나나 아이스크림 |false  |1               |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----|----------------|--------|

[DEBUG] 25-10-04 16:29:32 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:29:32 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:29:32 [selectVariantMedia:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:29:32 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30001
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:29:32 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|-------------|-----------|
|role      |url                                                                        |alt_ko       |sort_order |
|----------|---------------------------------------------------------------------------|-------------|-----------|
|PACKSHOT  |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png        |청키 몽키 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/01-tower.avif    |null         |1          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/02-envirolid.jpg |null         |2          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/03-scooped.jpg   |null         |3          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/04-enviro.jpg    |null         |4          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg      |null         |5          |
|NUTRITION |/assets/img/flavours/chunky-monkey-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml  |0          |
|----------|---------------------------------------------------------------------------|-------------|-----------|

[DEBUG] 25-10-04 16:29:32 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-04 16:29:32 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:29:32 [selectVariantGallery:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:29:32 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30001
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:29:32 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/01-tower.avif    |null   |1          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:29:32 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-04 16:29:32 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:29:32 [selectVariantIngredients:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:29:32 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30001

[INFO ] 25-10-04 16:29:32 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                             |smartlabel_url                                                                                                 |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽(설탕, 정제수), 정제수, 설탕, 코코아, 코코아분말, 대두유, 난황, 수수설탕, 전란, 전란액, 소금, 구아검, 카라기난, 바닐라추출물, 맥아분말, 탄산수소나트륨 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100354-0003-en-US-1665758042857/index.html |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:29:32 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:29:32 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:29:32 [selectVariantSourcing:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:29:32 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30001
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:29:32 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:29:32 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:29:32 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:29:32 [selectVariantCerts:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:29:32 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30001
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:29:32 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:29:32 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:29:32 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:29:32 [selectRecommendations:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-04 16:29:32 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30001
ORDER BY r.slot

[INFO ] 25-10-04 16:29:32 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |flavour_type_id |code               |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30006 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30011 |peanut-butter-cup-ice-cream          |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |1               |ORIGINAL ICE CREAM |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg          |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|----------------|-------------------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:29:32 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:29:32 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:29:32 [selectAvailableCategories:135] - ==> Parameters: 20001(Long)
[INFO ] 25-10-04 16:29:32 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20001
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:29:32 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30001 |
|SCOOP |scoop-shop |스쿱 샵    |30035 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:29:32 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:29:32 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:29:32 [findNextVariant:135] - ==> Parameters: 30001(Long), 30001(Long), 30001(Long), 30001(Long), 30001(Long), 30001(Long)
[INFO ] 25-10-04 16:29:32 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30001))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30001)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30001)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30001)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30001)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30001)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:29:32 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30006 |cherry-garcia-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-04 16:29:32 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:29:32 [MyInterceptor:122] - running time: 85(ms)
[INFO ] 25-10-04 16:29:35 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:29:35 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:29:35 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chunky-monkey-ice-cream/scoop-shop
[INFO ] 25-10-04 16:29:35 [MyInterceptor:101] - - REFERER : time=2902, url=http://localhost:8080/flavours/chunky-monkey-ice-cream/pint
[DEBUG] 25-10-04 16:29:35 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:29:35 [selectVariantDetail:135] - ==> Parameters: chunky-monkey-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-04 16:29:35 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chunky-monkey-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-04 16:29:35 [resultsettable:610] - 
|------|--------------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                        |id    |slug                    |name_ko |description_ko           |is_new |flavour_type_id |slug       |list_slug               |name_ko |
|------|--------------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----------|------------------------|--------|
|30035 |원숭이만 바나나에 반하나? 벤앤제리스도 바나나에 반했다! 고소한 넛츠와 달콤한 초콜릿, 그리고 바나나 아이스크림이 이루는 환상적인 조화! 벤앤제리스에서만 느낄 수 있는 특별한 맛을 지금 맛보세요! |20001 |chunky-monkey-ice-cream |청키 몽키®  |호두 퍼지 덩어리가 들어간 바나나 아이스크림 |false  |1               |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|--------------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----------|------------------------|--------|

[DEBUG] 25-10-04 16:29:35 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:29:35 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:29:35 [selectVariantMedia:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:29:35 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30035
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:29:35 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------|------------|-----------|
|role     |url                                                                           |alt_ko      |sort_order |
|---------|------------------------------------------------------------------------------|------------|-----------|
|PACKSHOT |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png     |청키 몽키 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/gallery/01-tower.avif |null        |1          |
|---------|------------------------------------------------------------------------------|------------|-----------|

[DEBUG] 25-10-04 16:29:35 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-04 16:29:35 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:29:35 [selectVariantGallery:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:29:35 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30035
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:29:35 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                           |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/gallery/01-tower.avif |null   |1          |
|--------|------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:29:35 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-04 16:29:35 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:29:35 [selectVariantIngredients:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:29:35 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30035

[INFO ] 25-10-04 16:29:35 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                             |smartlabel_url |
|-----------------------------------------------------------------------------------------------------------|---------------|
|크림, 탈지우유, 설탕시럽(설탕, 정제수), 정제수, 설탕, 코코아, 코코아분말, 대두유, 난황, 수수설탕, 전란, 전란액, 소금, 구아검, 카라기난, 바닐라추출물, 맥아분말, 탄산수소나트륨 |null           |
|-----------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 16:29:35 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:29:35 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:29:35 [selectVariantSourcing:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:29:35 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30035
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:29:35 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:29:35 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:29:35 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:29:35 [selectVariantCerts:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:29:35 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30035
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:29:35 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:29:35 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:29:35 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:29:35 [selectRecommendations:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:29:35 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30035
ORDER BY r.slot

[INFO ] 25-10-04 16:29:35 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |flavour_type_id |code               |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|
|30039 |new-york-super-fudge-chunk-ice-cream  |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |0         |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |0         |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:29:35 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:29:35 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:29:35 [selectAvailableCategories:135] - ==> Parameters: 20001(Long)
[INFO ] 25-10-04 16:29:35 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20001
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:29:35 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30001 |
|SCOOP |scoop-shop |스쿱 샵    |30035 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:29:35 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:29:35 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:29:35 [findNextVariant:135] - ==> Parameters: 30035(Long), 30035(Long), 30035(Long), 30035(Long), 30035(Long), 30035(Long)
[INFO ] 25-10-04 16:29:35 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30035))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30035)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30035)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30035)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30035)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30035)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:29:35 [resultsettable:610] - 
|------|------------------------|-----------|
|id    |slug                    |slug       |
|------|------------------------|-----------|
|30031 |cherry-garcia-ice-cream |scoop-shop |
|------|------------------------|-----------|

[DEBUG] 25-10-04 16:29:35 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:29:35 [MyInterceptor:122] - running time: 71(ms)
[INFO ] 25-10-04 16:37:27 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 31806 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 16:37:27 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 16:37:27 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 16:37:28 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.467 seconds (process running for 1642.146)
[INFO ] 25-10-04 16:37:33 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:37:33 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:37:33 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chunky-monkey-ice-cream/scoop-shop
[DEBUG] 25-10-04 16:37:33 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, f.flavour_type_id as flavourTypeId, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-04 16:37:33 [selectVariantDetail:135] - ==> Parameters: chunky-monkey-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-04 16:37:33 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       f.flavour_type_id as flavourTypeId,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chunky-monkey-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-04 16:37:33 [resultsettable:610] - 
|------|--------------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                        |id    |slug                    |name_ko |description_ko           |is_new |flavour_type_id |slug       |list_slug               |name_ko |
|------|--------------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----------|------------------------|--------|
|30035 |원숭이만 바나나에 반하나? 벤앤제리스도 바나나에 반했다! 고소한 넛츠와 달콤한 초콜릿, 그리고 바나나 아이스크림이 이루는 환상적인 조화! 벤앤제리스에서만 느낄 수 있는 특별한 맛을 지금 맛보세요! |20001 |chunky-monkey-ice-cream |청키 몽키®  |호두 퍼지 덩어리가 들어간 바나나 아이스크림 |false  |1               |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|--------------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|----------------|-----------|------------------------|--------|

[DEBUG] 25-10-04 16:37:33 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-04 16:37:33 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-04 16:37:33 [selectVariantMedia:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:37:33 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30035
  ORDER BY role, sort_order

[INFO ] 25-10-04 16:37:33 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------|------------|-----------|
|role     |url                                                                           |alt_ko      |sort_order |
|---------|------------------------------------------------------------------------------|------------|-----------|
|PACKSHOT |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png     |청키 몽키 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/gallery/01-tower.avif |null        |1          |
|---------|------------------------------------------------------------------------------|------------|-----------|

[DEBUG] 25-10-04 16:37:33 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-04 16:37:33 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-04 16:37:33 [selectVariantGallery:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:37:33 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30035
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-04 16:37:33 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                           |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/gallery/01-tower.avif |null   |1          |
|--------|------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-04 16:37:33 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-04 16:37:33 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-04 16:37:33 [selectVariantIngredients:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:37:33 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30035

[INFO ] 25-10-04 16:37:34 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                             |smartlabel_url |
|-----------------------------------------------------------------------------------------------------------|---------------|
|크림, 탈지우유, 설탕시럽(설탕, 정제수), 정제수, 설탕, 코코아, 코코아분말, 대두유, 난황, 수수설탕, 전란, 전란액, 소금, 구아검, 카라기난, 바닐라추출물, 맥아분말, 탄산수소나트륨 |null           |
|-----------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-04 16:37:34 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-04 16:37:34 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-04 16:37:34 [selectVariantSourcing:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:37:34 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30035
ORDER BY vs.sort_order

[INFO ] 25-10-04 16:37:34 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-04 16:37:34 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-04 16:37:34 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-04 16:37:34 [selectVariantCerts:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:37:34 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30035
ORDER BY vc.sort_order

[INFO ] 25-10-04 16:37:34 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-04 16:37:34 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-04 16:37:34 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, f.flavour_type_id as flavourTypeId, ft.code AS flavourTypeCode, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-04 16:37:34 [selectRecommendations:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-04 16:37:34 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,
    f.flavour_type_id as flavourTypeId,
    ft.code AS flavourTypeCode,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
JOIN flavour_type ft ON ft.id = f.flavour_type_id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30035
ORDER BY r.slot

[INFO ] 25-10-04 16:37:34 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |flavour_type_id |code               |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|
|30039 |new-york-super-fudge-chunk-ice-cream  |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |0         |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |0         |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |1               |ORIGINAL ICE CREAM |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------|-------------------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-04 16:37:34 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-04 16:37:34 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-04 16:37:34 [selectAvailableCategories:135] - ==> Parameters: 20001(Long)
[INFO ] 25-10-04 16:37:34 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20001
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-04 16:37:34 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30001 |
|SCOOP |scoop-shop |스쿱 샵    |30035 |
|------|-----------|--------|------|

[DEBUG] 25-10-04 16:37:34 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-04 16:37:34 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-04 16:37:34 [findNextVariant:135] - ==> Parameters: 30035(Long), 30035(Long), 30035(Long), 30035(Long), 30035(Long), 30035(Long)
[INFO ] 25-10-04 16:37:34 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30035))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30035)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30035)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30035)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30035)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30035)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-04 16:37:34 [resultsettable:610] - 
|------|------------------------|-----------|
|id    |slug                    |slug       |
|------|------------------------|-----------|
|30031 |cherry-garcia-ice-cream |scoop-shop |
|------|------------------------|-----------|

[DEBUG] 25-10-04 16:37:34 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-04 16:37:34 [MyInterceptor:122] - running time: 187(ms)
[INFO ] 25-10-04 16:37:38 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:37:38 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:37:38 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 16:37:38 [MyInterceptor:92] - (param) <-- q = 딸기
[INFO ] 25-10-04 16:37:38 [MyInterceptor:101] - - REFERER : time=4928, url=http://localhost:8080/flavours/chunky-monkey-ice-cream/scoop-shop
[DEBUG] 25-10-04 16:37:39 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:37:39 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 16:37:39 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[ERROR] 25-10-04 16:37:39 [sqlonly:144] - 19. PreparedStatement.execute() WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
COALESCE(vm_g5.url, vm_p.url) AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

java.sql.SQLSyntaxErrorException: Unknown column 'vm_g5.url' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:383)
	at net.sf.log4jdbc.sql.jdbcapi.PreparedStatementSpy.execute(PreparedStatementSpy.java:443)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor30.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:58)
	at jdk.proxy4/jdk.proxy4.$Proxy101.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:65)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:80)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:65)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:336)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:158)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:110)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:90)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:154)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:147)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:142)
	at jdk.internal.reflect.GeneratedMethodAccessor43.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:333)
	at jdk.proxy2/jdk.proxy2.$Proxy86.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:194)
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:147)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:80)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:141)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy5/jdk.proxy5.$Proxy104.searchFlavoursAll(Unknown Source)
	at kr.bhodu.benjerrysclone.services.impl.FlavourServiceImpl.searchFlavours(FlavourServiceImpl.java:128)
	at kr.bhodu.benjerrysclone.controllers.FlavourController.search(FlavourController.java:99)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[ERROR] 25-10-04 16:37:39 [[dispatcherServlet]:170] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'vm_g5.url' in 'field list'
### The error may exist in kr/bhodu/benjerrysclone/mappers/FlavourMapper.java (best guess)
### The error may involve kr.bhodu.benjerrysclone.mappers.FlavourMapper.searchFlavoursAll-Inline
### The error occurred while setting parameters
### SQL: WITH kw AS ( SELECT TRIM(?)                               AS q, REPLACE(TRIM(?), '®', '')             AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-'))     AS q_slug, CONCAT(TRIM(?), '%')                  AS q_prefix, CONCAT('%', TRIM(?), '%')             AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%')       AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%')  AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%')     AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id            JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id            JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id                AS variantId, f.slug              AS flavourSlug, f.name_ko           AS flavourNameKo, f.is_new            AS isNew, c.slug              AS categorySlug, c.list_slug         AS categoryListSlug, c.name_ko           AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, f.flavour_type_id   AS flavourTypeId, ft.code             AS flavourTypeCode FROM ranked r JOIN flavour f         ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1                 AND v.flavour_id = f.id                 AND v.id = (                   SELECT pv.id                   FROM product_variant pv                   JOIN category c2 ON c2.id = pv.category_id                   WHERE pv.is_active = 1                     AND pv.flavour_id = f.id                   ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id                   LIMIT 1                 ) JOIN category c        ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'vm_g5.url' in 'field list'
; bad SQL grammar []] with root cause
java.sql.SQLSyntaxErrorException: Unknown column 'vm_g5.url' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:383)
	at net.sf.log4jdbc.sql.jdbcapi.PreparedStatementSpy.execute(PreparedStatementSpy.java:443)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor30.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:58)
	at jdk.proxy4/jdk.proxy4.$Proxy101.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:65)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:80)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:65)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:336)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:158)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:110)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:90)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:154)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:147)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:142)
	at jdk.internal.reflect.GeneratedMethodAccessor43.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:333)
	at jdk.proxy2/jdk.proxy2.$Proxy86.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:194)
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:147)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:80)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:141)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy5/jdk.proxy5.$Proxy104.searchFlavoursAll(Unknown Source)
	at kr.bhodu.benjerrysclone.services.impl.FlavourServiceImpl.searchFlavours(FlavourServiceImpl.java:128)
	at kr.bhodu.benjerrysclone.controllers.FlavourController.search(FlavourController.java:99)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
[INFO ] 25-10-04 16:39:35 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 34018 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 16:39:35 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 16:39:35 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 16:39:40 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.428 seconds (process running for 6.224)
[INFO ] 25-10-04 16:39:50 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:39:50 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:39:50 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 16:39:50 [MyInterceptor:92] - (param) <-- q = 딸기
[DEBUG] 25-10-04 16:39:51 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, vm_p.url AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:39:51 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 16:39:51 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
vm_p.url AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 16:39:51 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |is_new |slug       |list_slug               |name_ko |url                                                                         |flavour_type_id |code               |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png      |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 16:39:51 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 16:39:51 [MyInterceptor:122] - running time: 1145(ms)
[INFO ] 25-10-04 16:46:00 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 34018 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 16:46:00 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 16:46:00 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 16:46:02 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.453 seconds (process running for 388.104)
[INFO ] 25-10-04 16:46:58 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 34599 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 16:46:58 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 16:46:58 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 16:47:03 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.527 seconds (process running for 6.324)
[INFO ] 25-10-04 16:47:32 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 34672 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-04 16:47:32 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-04 16:47:32 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-04 16:47:36 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.328 seconds (process running for 6.112)
[INFO ] 25-10-04 16:47:44 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-04 16:47:44 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-04 16:47:44 [MyInterceptor:85] - [GET] http://localhost:8080/search?q=%EB%94%B8%EA%B8%B0
[INFO ] 25-10-04 16:47:44 [MyInterceptor:92] - (param) <-- q = 딸기
[DEBUG] 25-10-04 16:47:45 [searchFlavoursAll:135] - ==>  Preparing: WITH kw AS ( SELECT TRIM(?) AS q, REPLACE(TRIM(?), '®', '') AS q_clean, LOWER(REPLACE(TRIM(?), ' ', '-')) AS q_slug, CONCAT(TRIM(?), '%') AS q_prefix, CONCAT('%', TRIM(?), '%') AS q_like, CONCAT(REPLACE(TRIM(?), '®', ''), '%') AS q_clean_prefix, CONCAT('%', REPLACE(TRIM(?), '®', ''), '%') AS q_clean_like, CONCAT(LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_prefix, CONCAT('%', LOWER(REPLACE(TRIM(?), ' ', '-')), '%') AS q_slug_like ), base AS ( /* 이름/별칭/슬러그 매칭 + 가중치 */ SELECT f.id AS flavour_id, 100 AS score FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko = kw.q UNION ALL SELECT f.id, 98 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean UNION ALL SELECT f.id, 97 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug = kw.q_slug UNION ALL SELECT f.id, 95 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias = kw.q UNION ALL SELECT f.id, 90 FROM flavour f, kw WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix UNION ALL SELECT f.id, 88 FROM flavour f, kw WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix UNION ALL SELECT f.id, 87 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix UNION ALL SELECT f.id, 82 FROM flavour f, kw WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like UNION ALL SELECT f.id, 80 FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id JOIN tag_alias ta ON ta.tag_id=ft.tag_id, kw WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like ), ranked AS ( SELECT flavour_id, MAX(score) AS score FROM base GROUP BY flavour_id ) SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, vm_p.url AS imageUrl, f.flavour_type_id AS flavourTypeId, ft.code AS flavourTypeCode FROM ranked r JOIN flavour f ON f.id = r.flavour_id JOIN product_variant v ON v.is_active = 1 AND v.flavour_id = f.id AND v.id = ( SELECT pv.id FROM product_variant pv JOIN category c2 ON c2.id = pv.category_id WHERE pv.is_active = 1 AND pv.flavour_id = f.id ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id LIMIT 1 ) JOIN category c ON c.id = v.category_id LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' ORDER BY r.score DESC, CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END, f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-04 16:47:45 [searchFlavoursAll:135] - ==> Parameters: 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String), 딸기(String)
[INFO ] 25-10-04 16:47:45 [sqlonly:228] - WITH
kw AS (
SELECT
TRIM('딸기')                               AS q,
REPLACE(TRIM('딸기'), '®', '')             AS q_clean,
LOWER(REPLACE(TRIM('딸기'), ' ', '-'))     AS q_slug,
CONCAT(TRIM('딸기'), '%')                  AS q_prefix,
CONCAT('%', TRIM('딸기'), '%')             AS q_like,
CONCAT(REPLACE(TRIM('딸기'), '®', ''), '%')       AS q_clean_prefix,
CONCAT('%', REPLACE(TRIM('딸기'), '®', ''), '%')  AS q_clean_like,
CONCAT(LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%')     AS q_slug_prefix,
CONCAT('%', LOWER(REPLACE(TRIM('딸기'), ' ', '-')), '%') AS q_slug_like
),
base AS (
/* 이름/별칭/슬러그 매칭 + 가중치 */
SELECT f.id AS flavour_id, 100 AS score
FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko = kw.q
UNION ALL
SELECT f.id, 98 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') = kw.q_clean
UNION ALL
SELECT f.id, 97 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug = kw.q_slug
UNION ALL
SELECT f.id, 95
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias = kw.q
UNION ALL
SELECT f.id, 90 FROM flavour f, kw
WHERE f.is_active = 1 AND f.name_ko LIKE kw.q_prefix
UNION ALL
SELECT f.id, 88 FROM flavour f, kw
WHERE f.is_active = 1 AND REPLACE(f.name_ko,'®','') LIKE kw.q_clean_prefix
UNION ALL
SELECT f.id, 87 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_prefix
UNION ALL
SELECT f.id, 82 FROM flavour f, kw
WHERE f.is_active = 1 AND f.slug LIKE kw.q_slug_like
UNION ALL
SELECT f.id, 80
FROM flavour f JOIN flavour_tag ft ON ft.flavour_id=f.id
           JOIN tag_alias ta   ON ta.tag_id=ft.tag_id, kw
WHERE f.is_active = 1 AND ta.alias LIKE kw.q_like
),
ranked AS (
SELECT flavour_id, MAX(score) AS score
FROM base
GROUP BY flavour_id
)
SELECT
v.id                AS variantId,
f.slug              AS flavourSlug,
f.name_ko           AS flavourNameKo,
f.description_ko        AS flavourDescriptionKo,
f.is_new            AS isNew,
c.slug              AS categorySlug,
c.list_slug         AS categoryListSlug,
c.name_ko           AS categoryNameKo,
vm_p.url AS imageUrl,
f.flavour_type_id   AS flavourTypeId,
ft.code             AS flavourTypeCode
FROM ranked r
JOIN flavour f         ON f.id = r.flavour_id
JOIN product_variant v ON v.is_active = 1
                AND v.flavour_id = f.id
                AND v.id = (
                  SELECT pv.id
                  FROM product_variant pv
                  JOIN category c2 ON c2.id = pv.category_id
                  WHERE pv.is_active = 1
                    AND pv.flavour_id = f.id
                  ORDER BY c2.priority ASC, COALESCE(pv.sort_order, 999), pv.id
                  LIMIT 1
                )
JOIN category c        ON c.id = v.category_id
LEFT JOIN flavour_type ft ON ft.id = f.flavour_type_id
LEFT JOIN variant_media vm_p
ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT'
ORDER BY
r.score DESC,
CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END,
f.flavour_type_id ASC,
f.name_ko ASC

[INFO ] 25-10-04 16:47:45 [resultsettable:610] - 
|------|--------------------------------|------------|-----------------------------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------|----------------|-------------------|
|id    |slug                            |name_ko     |description_ko                     |is_new |slug       |list_slug               |name_ko |url                                                                         |flavour_type_id |code               |
|------|--------------------------------|------------|-----------------------------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------|----------------|-------------------|
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림  |true   |pint       |ice-cream-pints         |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png |1               |ORIGINAL ICE CREAM |
|30040 |strawberry-ice-cream            |스트로베리       |딸기 아이스크림 베이스에 딸기 과육이 듬뿍 들어있는 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png      |1               |ORIGINAL ICE CREAM |
|------|--------------------------------|------------|-----------------------------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------|----------------|-------------------|

[DEBUG] 25-10-04 16:47:45 [searchFlavoursAll:135] - <==      Total: 2
[INFO ] 25-10-04 16:47:45 [MyInterceptor:122] - running time: 1149(ms)
