[WARN ] 25-10-01 00:00:34 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=2m48s674ms).
[WARN ] 25-10-01 00:17:08 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m33s200ms).
[WARN ] 25-10-01 00:25:39 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=3m1s611ms).
[WARN ] 25-10-01 00:31:28 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=1m48s426ms).
[WARN ] 25-10-01 00:37:19 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=5m20s884ms).
[WARN ] 25-10-01 00:41:34 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=3m44s739ms).
[WARN ] 25-10-01 00:46:40 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=4m36s799ms).
[WARN ] 25-10-01 01:43:44 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m2s193ms).
[WARN ] 25-10-01 02:01:00 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m15s478ms).
[WARN ] 25-10-01 02:18:38 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=17m8s43ms).
[WARN ] 25-10-01 02:34:37 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=15m29s75ms).
[WARN ] 25-10-01 02:51:44 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=17m7s12ms).
[WARN ] 25-10-01 03:08:18 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m4s19ms).
[WARN ] 25-10-01 03:26:27 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=18m8s983ms).
[WARN ] 25-10-01 03:28:27 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=1m30s102ms).
[WARN ] 25-10-01 03:43:59 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=15m31s718ms).
[WARN ] 25-10-01 04:01:11 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m12s463ms).
[WARN ] 25-10-01 04:17:25 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m14s26ms).
[WARN ] 25-10-01 05:33:29 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m2s693ms).
[WARN ] 25-10-01 05:50:20 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m20s617ms).
[WARN ] 25-10-01 06:09:50 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m30s269ms).
[WARN ] 25-10-01 06:26:01 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m10s992ms).
[WARN ] 25-10-01 06:45:17 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m45s676ms).
[WARN ] 25-10-01 07:00:29 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=14m42s456ms).
[WARN ] 25-10-01 07:17:40 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=16m41s209ms).
[WARN ] 25-10-01 07:34:57 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=17m17s49ms).
[WARN ] 25-10-01 08:27:07 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=5m8s975ms).
[WARN ] 25-10-01 08:28:06 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=58s967ms).
[WARN ] 25-10-01 08:55:50 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=26m12s212ms).
[WARN ] 25-10-01 09:03:19 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=7m28s458ms).
[WARN ] 25-10-01 10:04:21 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=1h32s153ms).
[WARN ] 25-10-01 10:19:53 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=15m31s731ms).
[WARN ] 25-10-01 10:50:55 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=30m32s278ms).
[WARN ] 25-10-01 11:06:26 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=15m30s858ms).
[WARN ] 25-10-01 11:10:46 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=3m50s351ms).
[WARN ] 25-10-01 11:44:51 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=33m34s429ms).
[WARN ] 25-10-01 11:48:38 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=3m47s405ms).
[WARN ] 25-10-01 11:56:43 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=7m35s538ms).
[WARN ] 25-10-01 11:58:38 [HikariPool:825] - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=1m54s313ms).
[INFO ] 25-10-01 12:15:34 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 34771 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-01 12:15:34 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-01 12:15:34 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[WARN ] 25-10-01 12:15:35 [AnnotationConfigServletWebServerApplicationContext:635] - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'flavourController' defined in file [/Users/sieun/ben-jerrys-clone/build/classes/java/main/kr/bhodu/benjerrysclone/controllers/FlavourController.class]: Unsatisfied dependency expressed through constructor parameter 0: No qualifying bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
[ERROR] 25-10-01 12:15:35 [LoggingFailureAnalysisReporter:40] - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in kr.bhodu.benjerrysclone.controllers.FlavourController required a bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' that could not be found.


Action:

Consider defining a bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' in your configuration.

[INFO ] 25-10-01 12:15:37 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 34771 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-01 12:15:37 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-01 12:15:37 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-01 12:15:38 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 0.965 seconds (process running for 14778.586)
[INFO ] 25-10-01 12:16:24 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 34771 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-01 12:16:24 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-01 12:16:24 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[WARN ] 25-10-01 12:16:25 [AnnotationConfigServletWebServerApplicationContext:635] - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'flavourController' defined in file [/Users/sieun/ben-jerrys-clone/build/classes/java/main/kr/bhodu/benjerrysclone/controllers/FlavourController.class]: Unsatisfied dependency expressed through constructor parameter 0: No qualifying bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
[ERROR] 25-10-01 12:16:25 [LoggingFailureAnalysisReporter:40] - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in kr.bhodu.benjerrysclone.controllers.FlavourController required a bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' that could not be found.


Action:

Consider defining a bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' in your configuration.

[INFO ] 25-10-01 12:17:03 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 53724 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-01 12:17:03 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-01 12:17:03 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-01 12:17:07 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.422 seconds (process running for 6.227)
[INFO ] 25-10-01 12:17:14 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:17:14 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:17:14 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/
[DEBUG] 25-10-01 12:17:15 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:17:15 [existsCategorySlug:135] - ==> Parameters: chocolate-fudge-brownie-ice-cream(String)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'chocolate-fudge-brownie-ice-cream'

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-01 12:17:15 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:15 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-01 12:17:15 [selectVariantDetailDefault:135] - ==> Parameters: chocolate-fudge-brownie-ice-cream(String)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-fudge-brownie-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                      |id    |slug                              |name_ko     |description_ko         |is_new |slug |list_slug       |name_ko |
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----|----------------|--------|
|30003 |풍부한 맛을 지닌 다크 초콜릿에 브라우니 퍼지 덩어리를 절묘하게 배합한 아이스크림입니다. 꿈꿔왔던 그 맛. |20003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |퍼지 브라우니가 들어간 초콜릿 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 12:17:15 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:15 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:17:15 [selectVariantMedia:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30003
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                  |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png        |초콜릿 퍼지 브라우니 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 12:17:15 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 12:17:15 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:17:15 [selectVariantGallery:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30003
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                  |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|-------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 12:17:15 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 12:17:15 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:17:15 [selectVariantIngredients:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30003

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                               |smartlabel_url                                                                                                           |
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 액상당, 농축 탈지유, 물, 코코아, 설탕, 밀가루, 대두유, 계란 노른자, 전화당, 계란, 계란 흰자, 농후제(구아검, 카라기난), 설탕, 바닐라 추출물, 팽창제(중탄산나트륨), 맥아분 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100477-0002-en-US-1668535427889/index.html#nutrition |
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:17:15 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:15 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:17:15 [selectVariantSourcing:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30003
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Greyston Brownies             |/assets/img/misc/90007_Greyston_Brownies_VLS_Simpler_Icons.png              |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:17:15 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-01 12:17:15 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:17:15 [selectVariantCerts:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30003
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Halal        |/assets/img/misc/91001_Halal_Dietary_Icon.avif       |
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 12:17:15 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 12:17:15 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.sort_order = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:17:15 [selectRecommendations:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.sort_order = 5

WHERE r.source_variant_id = 30003
ORDER BY r.slot

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|
|id    |slug                            |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                      |sortorder |
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg |5         |
|30002 |half-baked-ice-cream            |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg            |5         |
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png   |0         |
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 12:17:15 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 12:17:15 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:17:15 [selectAvailableCategories:135] - ==> Parameters: 20003(Long)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20003
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30003 |
|MINI_CUP |mini-cup   |미니컵     |30021 |
|SCOOP    |scoop-shop |스쿱 샵    |30034 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 12:17:15 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 12:17:15 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:17:15 [findNextVariant:135] - ==> Parameters: 30003(Long), 30003(Long), 30003(Long), 30003(Long), 30003(Long), 30003(Long)
[INFO ] 25-10-01 12:17:15 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30003))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30003)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30003)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30003)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30003)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30003)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:17:15 [resultsettable:610] - 
|------|---------------------------------------|-----|
|id    |slug                                   |slug |
|------|---------------------------------------|-----|
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |pint |
|------|---------------------------------------|-----|

[DEBUG] 25-10-01 12:17:15 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:17:15 [MyInterceptor:122] - running time: 1176(ms)
[INFO ] 25-10-01 12:17:40 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:17:40 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:17:40 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-shop-flavours
[INFO ] 25-10-01 12:17:40 [MyInterceptor:101] - - REFERER : time=24968, url=http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/
[DEBUG] 25-10-01 12:17:40 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:17:40 [existsCategorySlug:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-01 12:17:40 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-shop-flavours'

[INFO ] 25-10-01 12:17:40 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-01 12:17:40 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:40 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-01 12:17:40 [selectByCategory:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-01 12:17:40 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-shop-flavours'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-01 12:17:40 [resultsettable:610] - 
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                  |name_ko         |is_new |flavour_type_id |list_slug               |name_ko |url                                                                                     |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|30032 |chocolate-ice-cream                   |초콜릿             |true   |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream  |뉴욕 수퍼 퍼지 청크     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream        |민트 초콜릿 청크       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                     |바닐라             |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream     |스위트 크림&쿠키       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                  |스트로베리           |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream               |청키 몽키®          |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®        |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                  |하프베이크드®         |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                       |레모네이드 소르베       |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet      |베리베리 엑스트라 오디너리® |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:17:40 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-01 12:17:40 [MyInterceptor:122] - running time: 204(ms)
[INFO ] 25-10-01 12:17:42 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:17:42 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:17:42 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-ice-cream/
[INFO ] 25-10-01 12:17:42 [MyInterceptor:101] - - REFERER : time=1738, url=http://localhost:8080/flavours/ice-cream-shop-flavours
[DEBUG] 25-10-01 12:17:42 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:17:42 [existsCategorySlug:135] - ==> Parameters: chocolate-ice-cream(String)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'chocolate-ice-cream'

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-01 12:17:42 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:42 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-01 12:17:42 [selectVariantDetailDefault:135] - ==> Parameters: chocolate-ice-cream(String)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                                |id    |slug                |name_ko |description_ko |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|30032 |저희 초콜릿 아이스크림은 공정무역 인증® 코코아에서 초콜릿 맛을 얻습니다. 공정무역은 코코아 재배자들이 그들의 수확에 대한 공정한 가격을 보장하고, 그들이 그들의 땅과 생계를 보호하고, 그들의 가족을 위해 제공하고, 그들의 미래에 투자할 수 있도록 합니다. 즐기세요! |20014 |chocolate-ice-cream |초콜릿     |초콜릿 아이스크림      |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 12:17:42 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:42 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:17:42 [selectVariantMedia:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30032
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|---------|----------------------------------------------------------------------|----------|-----------|
|role     |url                                                                   |alt_ko    |sort_order |
|---------|----------------------------------------------------------------------|----------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png |초콜릿 스쿱 팩샷 |0          |
|---------|----------------------------------------------------------------------|----------|-----------|

[DEBUG] 25-10-01 12:17:42 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:42 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:17:42 [selectVariantGallery:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30032
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 12:17:42 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 12:17:42 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:17:42 [selectVariantIngredients:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30032

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|--------------------------------------------------------|---------------|
|ingredients_ko                                          |smartlabel_url |
|--------------------------------------------------------|---------------|
|유크림, 설탕시럽(설탕, 정제수), 탈지농축우유, 정제수, 코코아분말, 가당난황, 구아검, 카라기난 |null           |
|--------------------------------------------------------|---------------|

[DEBUG] 25-10-01 12:17:42 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:42 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:17:42 [selectVariantSourcing:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30032
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-01 12:17:42 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-01 12:17:42 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:17:42 [selectVariantCerts:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30032
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 12:17:42 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 12:17:42 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.sort_order = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:17:42 [selectRecommendations:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.sort_order = 5

WHERE r.source_variant_id = 30032
ORDER BY r.slot

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30038 |mint-chocolate-chunk-ice-cream       |민트 초콜릿 청크   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png       |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30031 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png              |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 12:17:42 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 12:17:42 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:17:42 [selectAvailableCategories:135] - ==> Parameters: 20014(Long)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20014
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30032 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 12:17:42 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:42 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:17:42 [findNextVariant:135] - ==> Parameters: 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long)
[INFO ] 25-10-01 12:17:42 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30032))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30032)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:17:42 [resultsettable:610] - 
|------|--------------------------------------|-----------|
|id    |slug                                  |slug       |
|------|--------------------------------------|-----------|
|30033 |chocolate-chip-cookie-dough-ice-cream |scoop-shop |
|------|--------------------------------------|-----------|

[DEBUG] 25-10-01 12:17:42 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:17:42 [MyInterceptor:122] - running time: 161(ms)
[INFO ] 25-10-01 12:17:54 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:17:54 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:17:54 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-pints
[INFO ] 25-10-01 12:17:54 [MyInterceptor:101] - - REFERER : time=11957, url=http://localhost:8080/flavours/chocolate-ice-cream/
[DEBUG] 25-10-01 12:17:54 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:17:54 [existsCategorySlug:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-01 12:17:54 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-pints'

[INFO ] 25-10-01 12:17:54 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-01 12:17:54 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:17:54 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-01 12:17:54 [selectByCategory:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-01 12:17:54 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-pints'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-01 12:17:54 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|id    |slug                                   |name_ko      |is_new |flavour_type_id |list_slug       |name_ko |url                                                                                |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크  |true   |1               |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png   |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |
|30013 |vanilla-ice-cream                      |바닐라          |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                      |
|30001 |chunky-monkey-ice-cream                |청키 몽키®       |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®     |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png  |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png      |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png            |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png          |
|30002 |half-baked-ice-cream                   |하프베이크드®      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                   |
|30008 |karamel-sutra-core                     |카라멜 수트라      |false  |2               |ice-cream-pints |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                     |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:17:54 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-01 12:17:54 [MyInterceptor:122] - running time: 81(ms)
[INFO ] 25-10-01 12:18:02 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:18:03 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:18:03 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/
[INFO ] 25-10-01 12:18:03 [MyInterceptor:101] - - REFERER : time=8488, url=http://localhost:8080/flavours/ice-cream-pints
[DEBUG] 25-10-01 12:18:03 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:18:03 [existsCategorySlug:135] - ==> Parameters: cherry-garcia-ice-cream(String)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'cherry-garcia-ice-cream'

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-01 12:18:03 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:18:03 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-01 12:18:03 [selectVariantDetailDefault:135] - ==> Parameters: cherry-garcia-ice-cream(String)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 12:18:03 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-01 12:18:03 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:18:03 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-01 12:18:03 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 12:18:03 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:18:03 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 12:18:03 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 12:18:03 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:18:03 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:18:03 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:18:03 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:18:03 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:18:03 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 12:18:03 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:18:03 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 12:18:03 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 12:18:03 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.sort_order = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:18:03 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.sort_order = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |0         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 12:18:03 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 12:18:03 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:18:03 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 12:18:03 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 12:18:03 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:18:03 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-01 12:18:03 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:18:03 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-01 12:18:03 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:18:03 [MyInterceptor:122] - running time: 130(ms)
[INFO ] 25-10-01 12:36:26 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 53724 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-01 12:36:26 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-01 12:36:26 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[WARN ] 25-10-01 12:36:27 [AnnotationConfigServletWebServerApplicationContext:635] - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'flavourController' defined in file [/Users/sieun/ben-jerrys-clone/build/classes/java/main/kr/bhodu/benjerrysclone/controllers/FlavourController.class]: Unsatisfied dependency expressed through constructor parameter 0: No qualifying bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
[ERROR] 25-10-01 12:36:27 [LoggingFailureAnalysisReporter:40] - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in kr.bhodu.benjerrysclone.controllers.FlavourController required a bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' that could not be found.


Action:

Consider defining a bean of type 'kr.bhodu.benjerrysclone.services.FlavourService' in your configuration.

[INFO ] 25-10-01 12:36:29 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 53724 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-01 12:36:29 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-01 12:36:29 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-01 12:36:30 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 1.086 seconds (process running for 1168.972)
[INFO ] 25-10-01 12:36:49 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 55108 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-01 12:36:49 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-01 12:36:49 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-01 12:36:54 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.979 seconds (process running for 6.803)
[INFO ] 25-10-01 12:37:07 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:37:07 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:37:07 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/
[DEBUG] 25-10-01 12:37:07 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:37:08 [existsCategorySlug:135] - ==> Parameters: cherry-garcia-ice-cream(String)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'cherry-garcia-ice-cream'

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-01 12:37:08 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:08 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-01 12:37:08 [selectVariantDetailDefault:135] - ==> Parameters: cherry-garcia-ice-cream(String)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 12:37:08 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:08 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:37:08 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-01 12:37:08 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 12:37:08 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:37:08 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 12:37:08 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 12:37:08 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:37:08 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:37:08 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:08 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:37:08 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:37:08 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 12:37:08 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:37:08 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 12:37:08 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:08 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:37:08 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |0         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 12:37:08 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 12:37:08 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:37:08 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 12:37:08 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 12:37:08 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:37:08 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-01 12:37:08 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:37:08 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-01 12:37:08 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:37:08 [MyInterceptor:122] - running time: 1154(ms)
[INFO ] 25-10-01 12:37:18 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:37:19 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:37:19 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-shop-flavours
[INFO ] 25-10-01 12:37:19 [MyInterceptor:101] - - REFERER : time=10687, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/
[DEBUG] 25-10-01 12:37:19 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:37:19 [existsCategorySlug:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-01 12:37:19 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-shop-flavours'

[INFO ] 25-10-01 12:37:19 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-01 12:37:19 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:19 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-01 12:37:19 [selectByCategory:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-01 12:37:19 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-shop-flavours'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-01 12:37:19 [resultsettable:610] - 
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                  |name_ko         |is_new |flavour_type_id |list_slug               |name_ko |url                                                                                     |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|30032 |chocolate-ice-cream                   |초콜릿             |true   |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream  |뉴욕 수퍼 퍼지 청크     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream        |민트 초콜릿 청크       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                     |바닐라             |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream     |스위트 크림&쿠키       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                  |스트로베리           |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream               |청키 몽키®          |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®        |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                  |하프베이크드®         |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                       |레모네이드 소르베       |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet      |베리베리 엑스트라 오디너리® |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:37:19 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-01 12:37:19 [MyInterceptor:122] - running time: 176(ms)
[INFO ] 25-10-01 12:37:21 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:37:22 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:37:22 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/sweet-cream-and-cookies-ice-cream/
[INFO ] 25-10-01 12:37:22 [MyInterceptor:101] - - REFERER : time=2833, url=http://localhost:8080/flavours/ice-cream-shop-flavours
[DEBUG] 25-10-01 12:37:22 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:37:22 [existsCategorySlug:135] - ==> Parameters: sweet-cream-and-cookies-ice-cream(String)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'sweet-cream-and-cookies-ice-cream'

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-01 12:37:22 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:22 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-01 12:37:22 [selectVariantDetailDefault:135] - ==> Parameters: sweet-cream-and-cookies-ice-cream(String)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'sweet-cream-and-cookies-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|------|---------------------------------------------------------------------|------|----------------------------------|----------|--------------------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                               |id    |slug                              |name_ko   |description_ko                              |is_new |slug       |list_slug               |name_ko |
|------|---------------------------------------------------------------------|------|----------------------------------|----------|--------------------------------------------|-------|-----------|------------------------|--------|
|30043 |농장에서 신선한 우유와 크림, 그리고 벤앤제리스가 선택한 스페셜한 청크를 함께 맛보세요! 당신의 하루가 달콤하게 변할거예요 |20019 |sweet-cream-and-cookies-ice-cream |스위트 크림&쿠키 |바닐라 아이스크림 베이스에 초코 쿠키와 스위트 크림이 듬뿍 들어있는 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|---------------------------------------------------------------------|------|----------------------------------|----------|--------------------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 12:37:22 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:22 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:37:22 [selectVariantMedia:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30043
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------------|----------------|-----------|
|role     |url                                                                                 |alt_ko          |sort_order |
|---------|------------------------------------------------------------------------------------|----------------|-----------|
|PACKSHOT |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png |스위트 크림&쿠키 스쿱 팩샷 |0          |
|---------|------------------------------------------------------------------------------------|----------------|-----------|

[DEBUG] 25-10-01 12:37:22 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:22 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:37:22 [selectVariantGallery:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30043
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 12:37:22 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 12:37:22 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:37:22 [selectVariantIngredients:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30043

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                               |smartlabel_url |
|-------------------------------------------------------------------------------------------------------------|---------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 설탕, 밀가루, 계란 노른자, 코코넛 오일, (알칼리로 처리한)코코아, 해바라기유, 소금, 베이킹 소다, 천연착향료, 구아검, 대두 레시틴, 카라기난. |null           |
|-------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 12:37:22 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:22 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:37:22 [selectVariantSourcing:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30043
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:37:22 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 12:37:22 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:37:22 [selectVariantCerts:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30043
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 12:37:22 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 12:37:22 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:37:22 [selectRecommendations:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30043
ORDER BY r.slot

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                            |sortorder |
|------|----------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------------|----------|
|30034 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png |0         |
|30032 |chocolate-ice-cream               |초콜릿         |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png               |0         |
|30038 |mint-chocolate-chunk-ice-cream    |민트 초콜릿 청크   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png    |0         |
|------|----------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 12:37:22 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 12:37:22 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:37:22 [selectAvailableCategories:135] - ==> Parameters: 20019(Long)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20019
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30043 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 12:37:22 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:22 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:37:22 [findNextVariant:135] - ==> Parameters: 30043(Long), 30043(Long), 30043(Long), 30043(Long), 30043(Long), 30043(Long)
[INFO ] 25-10-01 12:37:22 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30043))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30043)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30043)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30043)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30043)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30043)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:37:22 [resultsettable:610] - 
|------|---------------------|-----------|
|id    |slug                 |slug       |
|------|---------------------|-----------|
|30040 |strawberry-ice-cream |scoop-shop |
|------|---------------------|-----------|

[DEBUG] 25-10-01 12:37:22 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:37:22 [MyInterceptor:122] - running time: 248(ms)
[INFO ] 25-10-01 12:37:24 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:37:24 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:37:24 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop
[INFO ] 25-10-01 12:37:24 [MyInterceptor:101] - - REFERER : time=2523, url=http://localhost:8080/flavours/sweet-cream-and-cookies-ice-cream/
[DEBUG] 25-10-01 12:37:24 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 12:37:24 [selectVariantDetail:135] - ==> Parameters: chocolate-fudge-brownie-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 12:37:24 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-fudge-brownie-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 12:37:24 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                                                                  |id    |slug                              |name_ko     |description_ko         |is_new |slug       |list_slug               |name_ko |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----------|------------------------|--------|
|30034 |초콜릿 퍼지 브라우니 퍼지 브라우니가 들어간 초콜릿 아이스크림 초콜릿 아이스크림에 쫀득한 브라우니가 가득! 사회적 약자들에게 직업교육과 일자리 창출에 힘쓰고 있는 뉴욕의 Greyston Bakery 에서 구워진 벤앤제리스 브라우니가 가득 들어있습니다. 당신의 선택이 그들에게 따뜻한 도움의 손길이 될 수 있다는 걸 잊지 마세요! |20003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |퍼지 브라우니가 들어간 초콜릿 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 12:37:24 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:24 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:37:24 [selectVariantMedia:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:24 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30034
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:37:24 [resultsettable:610] - 
|---------|---------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                    |alt_ko            |sort_order |
|---------|---------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png    |초콜릿 퍼지 브라우니 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|---------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-01 12:37:24 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 12:37:24 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:37:24 [selectVariantGallery:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:24 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30034
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:37:24 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                    |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|---------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 12:37:24 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:24 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:37:24 [selectVariantIngredients:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:24 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30034

[INFO ] 25-10-01 12:37:24 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                               |smartlabel_url |
|-------------------------------------------------------------------------------------------------------------|---------------|
|크림, 액상당, 농축 탈지유, 물, 코코아, 설탕, 밀가루, 대두유, 계란 노른자, 전화당, 계란, 계란 흰자, 농후제(구아검, 카라기난), 설탕, 바닐라 추출물, 팽창제(중탄산나트륨), 맥아분 |null           |
|-------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 12:37:24 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:24 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:37:24 [selectVariantSourcing:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:24 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30034
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:37:24 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Greyston Brownies             |/assets/img/misc/90007_Greyston_Brownies_VLS_Simpler_Icons.png              |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:37:24 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-01 12:37:24 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:37:24 [selectVariantCerts:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:24 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30034
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:37:24 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Halal        |/assets/img/misc/91001_Halal_Dietary_Icon.avif       |
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 12:37:24 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 12:37:24 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:37:24 [selectRecommendations:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:24 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30034
ORDER BY r.slot

[INFO ] 25-10-01 12:37:24 [resultsettable:610] - 
|---|-----|--------|-------|-----|----------|--------|---------|----------|
|id |slug |name_ko |is_new |slug |list_slug |name_ko |imageurl |sortorder |
|---|-----|--------|-------|-----|----------|--------|---------|----------|
|---|-----|--------|-------|-----|----------|--------|---------|----------|

[DEBUG] 25-10-01 12:37:24 [selectRecommendations:135] - <==      Total: 0
[DEBUG] 25-10-01 12:37:24 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:37:24 [selectAvailableCategories:135] - ==> Parameters: 20003(Long)
[INFO ] 25-10-01 12:37:24 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20003
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:37:24 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30003 |
|MINI_CUP |mini-cup   |미니컵     |30021 |
|SCOOP    |scoop-shop |스쿱 샵    |30034 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 12:37:24 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 12:37:24 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:37:24 [findNextVariant:135] - ==> Parameters: 30034(Long), 30034(Long), 30034(Long), 30034(Long), 30034(Long), 30034(Long)
[INFO ] 25-10-01 12:37:24 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30034))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30034)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30034)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30034)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30034)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30034)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:37:24 [resultsettable:610] - 
|------|---------------------|-----------|
|id    |slug                 |slug       |
|------|---------------------|-----------|
|30036 |half-baked-ice-cream |scoop-shop |
|------|---------------------|-----------|

[DEBUG] 25-10-01 12:37:24 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:37:24 [MyInterceptor:122] - running time: 126(ms)
[INFO ] 25-10-01 12:37:31 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:37:31 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:37:31 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop
[INFO ] 25-10-01 12:37:31 [MyInterceptor:101] - - REFERER : time=6705, url=http://localhost:8080/flavours/sweet-cream-and-cookies-ice-cream/
[DEBUG] 25-10-01 12:37:31 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 12:37:31 [selectVariantDetail:135] - ==> Parameters: chocolate-fudge-brownie-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 12:37:31 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-fudge-brownie-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 12:37:31 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                                                                  |id    |slug                              |name_ko     |description_ko         |is_new |slug       |list_slug               |name_ko |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----------|------------------------|--------|
|30034 |초콜릿 퍼지 브라우니 퍼지 브라우니가 들어간 초콜릿 아이스크림 초콜릿 아이스크림에 쫀득한 브라우니가 가득! 사회적 약자들에게 직업교육과 일자리 창출에 힘쓰고 있는 뉴욕의 Greyston Bakery 에서 구워진 벤앤제리스 브라우니가 가득 들어있습니다. 당신의 선택이 그들에게 따뜻한 도움의 손길이 될 수 있다는 걸 잊지 마세요! |20003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |퍼지 브라우니가 들어간 초콜릿 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 12:37:31 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:31 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:37:31 [selectVariantMedia:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:31 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30034
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:37:31 [resultsettable:610] - 
|---------|---------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                    |alt_ko            |sort_order |
|---------|---------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png    |초콜릿 퍼지 브라우니 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|---------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-01 12:37:31 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 12:37:31 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:37:31 [selectVariantGallery:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:31 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30034
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:37:31 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                    |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|---------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 12:37:31 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:31 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:37:31 [selectVariantIngredients:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:31 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30034

[INFO ] 25-10-01 12:37:31 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                               |smartlabel_url |
|-------------------------------------------------------------------------------------------------------------|---------------|
|크림, 액상당, 농축 탈지유, 물, 코코아, 설탕, 밀가루, 대두유, 계란 노른자, 전화당, 계란, 계란 흰자, 농후제(구아검, 카라기난), 설탕, 바닐라 추출물, 팽창제(중탄산나트륨), 맥아분 |null           |
|-------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 12:37:31 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:31 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:37:31 [selectVariantSourcing:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:31 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30034
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:37:31 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Greyston Brownies             |/assets/img/misc/90007_Greyston_Brownies_VLS_Simpler_Icons.png              |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:37:31 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-01 12:37:31 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:37:31 [selectVariantCerts:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:31 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30034
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:37:31 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Halal        |/assets/img/misc/91001_Halal_Dietary_Icon.avif       |
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 12:37:31 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 12:37:31 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:37:31 [selectRecommendations:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:31 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30034
ORDER BY r.slot

[INFO ] 25-10-01 12:37:31 [resultsettable:610] - 
|---|-----|--------|-------|-----|----------|--------|---------|----------|
|id |slug |name_ko |is_new |slug |list_slug |name_ko |imageurl |sortorder |
|---|-----|--------|-------|-----|----------|--------|---------|----------|
|---|-----|--------|-------|-----|----------|--------|---------|----------|

[DEBUG] 25-10-01 12:37:31 [selectRecommendations:135] - <==      Total: 0
[DEBUG] 25-10-01 12:37:31 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:37:31 [selectAvailableCategories:135] - ==> Parameters: 20003(Long)
[INFO ] 25-10-01 12:37:31 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20003
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:37:31 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30003 |
|MINI_CUP |mini-cup   |미니컵     |30021 |
|SCOOP    |scoop-shop |스쿱 샵    |30034 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 12:37:31 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 12:37:31 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:37:31 [findNextVariant:135] - ==> Parameters: 30034(Long), 30034(Long), 30034(Long), 30034(Long), 30034(Long), 30034(Long)
[INFO ] 25-10-01 12:37:31 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30034))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30034)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30034)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30034)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30034)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30034)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:37:31 [resultsettable:610] - 
|------|---------------------|-----------|
|id    |slug                 |slug       |
|------|---------------------|-----------|
|30036 |half-baked-ice-cream |scoop-shop |
|------|---------------------|-----------|

[DEBUG] 25-10-01 12:37:31 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:37:31 [MyInterceptor:122] - running time: 124(ms)
[INFO ] 25-10-01 12:37:35 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:37:35 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:37:35 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-ice-cream/scoop-shop
[INFO ] 25-10-01 12:37:35 [MyInterceptor:101] - - REFERER : time=4082, url=http://localhost:8080/flavours/sweet-cream-and-cookies-ice-cream/
[DEBUG] 25-10-01 12:37:35 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 12:37:35 [selectVariantDetail:135] - ==> Parameters: chocolate-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 12:37:35 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 12:37:35 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                                |id    |slug                |name_ko |description_ko |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|30032 |저희 초콜릿 아이스크림은 공정무역 인증® 코코아에서 초콜릿 맛을 얻습니다. 공정무역은 코코아 재배자들이 그들의 수확에 대한 공정한 가격을 보장하고, 그들이 그들의 땅과 생계를 보호하고, 그들의 가족을 위해 제공하고, 그들의 미래에 투자할 수 있도록 합니다. 즐기세요! |20014 |chocolate-ice-cream |초콜릿     |초콜릿 아이스크림      |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 12:37:35 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:35 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:37:35 [selectVariantMedia:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:37:35 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30032
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:37:35 [resultsettable:610] - 
|---------|----------------------------------------------------------------------|----------|-----------|
|role     |url                                                                   |alt_ko    |sort_order |
|---------|----------------------------------------------------------------------|----------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png |초콜릿 스쿱 팩샷 |0          |
|---------|----------------------------------------------------------------------|----------|-----------|

[DEBUG] 25-10-01 12:37:35 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:35 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:37:35 [selectVariantGallery:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:37:35 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30032
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:37:35 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 12:37:35 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 12:37:35 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:37:35 [selectVariantIngredients:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:37:35 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30032

[INFO ] 25-10-01 12:37:35 [resultsettable:610] - 
|--------------------------------------------------------|---------------|
|ingredients_ko                                          |smartlabel_url |
|--------------------------------------------------------|---------------|
|유크림, 설탕시럽(설탕, 정제수), 탈지농축우유, 정제수, 코코아분말, 가당난황, 구아검, 카라기난 |null           |
|--------------------------------------------------------|---------------|

[DEBUG] 25-10-01 12:37:35 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:35 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:37:35 [selectVariantSourcing:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:37:35 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30032
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:37:35 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-01 12:37:35 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-01 12:37:35 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:37:35 [selectVariantCerts:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:37:35 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30032
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:37:35 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 12:37:35 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 12:37:35 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:37:35 [selectRecommendations:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 12:37:35 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30032
ORDER BY r.slot

[INFO ] 25-10-01 12:37:35 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30038 |mint-chocolate-chunk-ice-cream       |민트 초콜릿 청크   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png       |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30031 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png              |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 12:37:35 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 12:37:35 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:37:35 [selectAvailableCategories:135] - ==> Parameters: 20014(Long)
[INFO ] 25-10-01 12:37:35 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20014
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:37:35 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30032 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 12:37:35 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:35 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:37:35 [findNextVariant:135] - ==> Parameters: 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long)
[INFO ] 25-10-01 12:37:35 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30032))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30032)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:37:35 [resultsettable:610] - 
|------|--------------------------------------|-----------|
|id    |slug                                  |slug       |
|------|--------------------------------------|-----------|
|30033 |chocolate-chip-cookie-dough-ice-cream |scoop-shop |
|------|--------------------------------------|-----------|

[DEBUG] 25-10-01 12:37:35 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:37:35 [MyInterceptor:122] - running time: 199(ms)
[INFO ] 25-10-01 12:37:40 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:37:40 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:37:40 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop
[INFO ] 25-10-01 12:37:40 [MyInterceptor:101] - - REFERER : time=4094, url=http://localhost:8080/flavours/sweet-cream-and-cookies-ice-cream/
[DEBUG] 25-10-01 12:37:40 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 12:37:40 [selectVariantDetail:135] - ==> Parameters: chocolate-fudge-brownie-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 12:37:40 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-fudge-brownie-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 12:37:40 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                                                                  |id    |slug                              |name_ko     |description_ko         |is_new |slug       |list_slug               |name_ko |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----------|------------------------|--------|
|30034 |초콜릿 퍼지 브라우니 퍼지 브라우니가 들어간 초콜릿 아이스크림 초콜릿 아이스크림에 쫀득한 브라우니가 가득! 사회적 약자들에게 직업교육과 일자리 창출에 힘쓰고 있는 뉴욕의 Greyston Bakery 에서 구워진 벤앤제리스 브라우니가 가득 들어있습니다. 당신의 선택이 그들에게 따뜻한 도움의 손길이 될 수 있다는 걸 잊지 마세요! |20003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |퍼지 브라우니가 들어간 초콜릿 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 12:37:40 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:40 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:37:40 [selectVariantMedia:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:40 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30034
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:37:40 [resultsettable:610] - 
|---------|---------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                    |alt_ko            |sort_order |
|---------|---------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png    |초콜릿 퍼지 브라우니 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|---------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-01 12:37:40 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 12:37:40 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:37:40 [selectVariantGallery:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:40 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30034
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:37:40 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                    |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|---------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 12:37:40 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:40 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:37:40 [selectVariantIngredients:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:40 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30034

[INFO ] 25-10-01 12:37:40 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                               |smartlabel_url |
|-------------------------------------------------------------------------------------------------------------|---------------|
|크림, 액상당, 농축 탈지유, 물, 코코아, 설탕, 밀가루, 대두유, 계란 노른자, 전화당, 계란, 계란 흰자, 농후제(구아검, 카라기난), 설탕, 바닐라 추출물, 팽창제(중탄산나트륨), 맥아분 |null           |
|-------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 12:37:40 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:37:40 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:37:40 [selectVariantSourcing:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:40 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30034
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:37:40 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Greyston Brownies             |/assets/img/misc/90007_Greyston_Brownies_VLS_Simpler_Icons.png              |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:37:40 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-01 12:37:40 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:37:40 [selectVariantCerts:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:40 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30034
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:37:40 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Halal        |/assets/img/misc/91001_Halal_Dietary_Icon.avif       |
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 12:37:40 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 12:37:40 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:37:40 [selectRecommendations:135] - ==> Parameters: 30034(Long)
[INFO ] 25-10-01 12:37:40 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30034
ORDER BY r.slot

[INFO ] 25-10-01 12:37:40 [resultsettable:610] - 
|---|-----|--------|-------|-----|----------|--------|---------|----------|
|id |slug |name_ko |is_new |slug |list_slug |name_ko |imageurl |sortorder |
|---|-----|--------|-------|-----|----------|--------|---------|----------|
|---|-----|--------|-------|-----|----------|--------|---------|----------|

[DEBUG] 25-10-01 12:37:40 [selectRecommendations:135] - <==      Total: 0
[DEBUG] 25-10-01 12:37:40 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:37:40 [selectAvailableCategories:135] - ==> Parameters: 20003(Long)
[INFO ] 25-10-01 12:37:40 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20003
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:37:40 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30003 |
|MINI_CUP |mini-cup   |미니컵     |30021 |
|SCOOP    |scoop-shop |스쿱 샵    |30034 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 12:37:40 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 12:37:40 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:37:40 [findNextVariant:135] - ==> Parameters: 30034(Long), 30034(Long), 30034(Long), 30034(Long), 30034(Long), 30034(Long)
[INFO ] 25-10-01 12:37:40 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30034))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30034)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30034)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30034)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30034)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30034)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:37:40 [resultsettable:610] - 
|------|---------------------|-----------|
|id    |slug                 |slug       |
|------|---------------------|-----------|
|30036 |half-baked-ice-cream |scoop-shop |
|------|---------------------|-----------|

[DEBUG] 25-10-01 12:37:40 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:37:40 [MyInterceptor:122] - running time: 108(ms)
[INFO ] 25-10-01 12:38:21 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:38:21 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:38:21 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-cups
[INFO ] 25-10-01 12:38:21 [MyInterceptor:101] - - REFERER : time=41590, url=http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop
[DEBUG] 25-10-01 12:38:21 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:38:21 [existsCategorySlug:135] - ==> Parameters: ice-cream-cups(String)
[INFO ] 25-10-01 12:38:21 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-cups'

[INFO ] 25-10-01 12:38:21 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-01 12:38:21 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:38:21 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-01 12:38:21 [selectByCategory:135] - ==> Parameters: ice-cream-cups(String)
[INFO ] 25-10-01 12:38:21 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-cups'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-01 12:38:21 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|----------------|---------------|--------|--------------------------------------------------------------------------------------|
|id    |slug                                  |name_ko     |is_new |flavour_type_id |list_slug      |name_ko |url                                                                                   |
|------|--------------------------------------|------------|-------|----------------|---------------|--------|--------------------------------------------------------------------------------------|
|30023 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |1               |ice-cream-cups |미니컵     |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png               |
|30022 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |1               |ice-cream-cups |미니컵     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png |
|30021 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니 |false  |1               |ice-cream-cups |미니컵     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png     |
|------|--------------------------------------|------------|-------|----------------|---------------|--------|--------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:38:21 [selectByCategory:135] - <==      Total: 3
[INFO ] 25-10-01 12:38:21 [MyInterceptor:122] - running time: 73(ms)
[INFO ] 25-10-01 12:38:25 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:38:26 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:38:26 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-shop-flavours
[INFO ] 25-10-01 12:38:26 [MyInterceptor:101] - - REFERER : time=4178, url=http://localhost:8080/flavours/ice-cream-cups
[DEBUG] 25-10-01 12:38:26 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:38:26 [existsCategorySlug:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-01 12:38:26 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-shop-flavours'

[INFO ] 25-10-01 12:38:26 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-01 12:38:26 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:38:26 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-01 12:38:26 [selectByCategory:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-01 12:38:26 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-shop-flavours'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-01 12:38:26 [resultsettable:610] - 
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                  |name_ko         |is_new |flavour_type_id |list_slug               |name_ko |url                                                                                     |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|30032 |chocolate-ice-cream                   |초콜릿             |true   |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream  |뉴욕 수퍼 퍼지 청크     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream        |민트 초콜릿 청크       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                     |바닐라             |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream     |스위트 크림&쿠키       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                  |스트로베리           |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream               |청키 몽키®          |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®        |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                  |하프베이크드®         |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                       |레모네이드 소르베       |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet      |베리베리 엑스트라 오디너리® |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:38:26 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-01 12:38:26 [MyInterceptor:122] - running time: 80(ms)
[INFO ] 25-10-01 12:38:31 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 12:38:31 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 12:38:31 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/
[INFO ] 25-10-01 12:38:31 [MyInterceptor:101] - - REFERER : time=4997, url=http://localhost:8080/flavours/ice-cream-shop-flavours
[DEBUG] 25-10-01 12:38:31 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 12:38:31 [existsCategorySlug:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'chocolate-chip-cookie-dough-ice-cream'

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-01 12:38:31 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 12:38:31 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-01 12:38:31 [selectVariantDetailDefault:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|30005 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 12:38:31 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-01 12:38:31 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 12:38:31 [selectVariantMedia:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30005
  ORDER BY role, sort_order

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                      |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png        |초콜릿 칩 쿠키 도우 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|NUTRITION |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 12:38:31 [selectVariantMedia:135] - <==      Total: 6
[DEBUG] 25-10-01 12:38:31 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 12:38:31 [selectVariantGallery:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30005
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                      |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 12:38:31 [selectVariantGallery:135] - <==      Total: 4
[DEBUG] 25-10-01 12:38:31 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 12:38:31 [selectVariantIngredients:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30005

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100583-0002-en-US-1669211882662/index.html |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:38:31 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 12:38:31 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 12:38:31 [selectVariantSourcing:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30005
ORDER BY vs.sort_order

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 12:38:31 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 12:38:31 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 12:38:31 [selectVariantCerts:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30005
ORDER BY vc.sort_order

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 12:38:31 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 12:38:31 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 12:38:31 [selectRecommendations:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30005
ORDER BY r.slot

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30013 |vanilla-ice-cream                    |바닐라         |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                    |5         |
|30002 |half-baked-ice-cream                 |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 12:38:31 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 12:38:31 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 12:38:31 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 12:38:31 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 12:38:31 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 12:38:31 [findNextVariant:135] - ==> Parameters: 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long)
[INFO ] 25-10-01 12:38:31 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30005))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30005)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 12:38:31 [resultsettable:610] - 
|------|----------------------------------|-----|
|id    |slug                              |slug |
|------|----------------------------------|-----|
|30003 |chocolate-fudge-brownie-ice-cream |pint |
|------|----------------------------------|-----|

[DEBUG] 25-10-01 12:38:31 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 12:38:31 [MyInterceptor:122] - running time: 141(ms)
[WARN ] 25-10-01 13:04:17 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=4m8s876ms).
[WARN ] 25-10-01 13:10:27 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=5m40s759ms).
[WARN ] 25-10-01 13:14:32 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=4m4s828ms).
[WARN ] 25-10-01 13:30:33 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=15m30s991ms).
[WARN ] 25-10-01 13:46:05 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=15m31s625ms).
[WARN ] 25-10-01 13:49:49 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=3m14s59ms).
[WARN ] 25-10-01 14:54:06 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h4m17s346ms).
[WARN ] 25-10-01 15:01:22 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=6m45s996ms).
[WARN ] 25-10-01 15:24:02 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=22m9s747ms).
[WARN ] 25-10-01 16:02:19 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=38m16s382ms).
[WARN ] 25-10-01 16:09:08 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=6m19s832ms).
[WARN ] 25-10-01 17:03:15 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=54m6s334ms).
[WARN ] 25-10-01 17:03:43 [HikariPool:817] - HikariPool-1 - Retrograde clock change detected (housekeeper delta=27s945ms), soft-evicting connections from pool.
[WARN ] 25-10-01 18:02:35 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=58m52s466ms).
[WARN ] 25-10-01 18:04:12 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m36s803ms).
[WARN ] 25-10-01 18:17:09 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=12m27s152ms).
[WARN ] 25-10-01 18:26:35 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=8m56s275ms).
[WARN ] 25-10-01 18:50:42 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=24m6s365ms).
[WARN ] 25-10-01 19:05:35 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=14m23s554ms).
[WARN ] 25-10-01 20:06:19 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h43s863ms).
[WARN ] 25-10-01 21:07:33 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h43s983ms).
[WARN ] 25-10-01 21:27:27 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=19m54s16ms).
[WARN ] 25-10-01 21:36:08 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=8m8s366ms).
[WARN ] 25-10-01 22:08:12 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=32m4s800ms).
[WARN ] 25-10-01 22:59:19 [HikariPool:825] - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=50m36s688ms).
[INFO ] 25-10-01 23:48:41 [BenjerryscloneApplication:53] - Starting BenjerryscloneApplication using Java 17.0.14 with PID 61986 (/Users/sieun/ben-jerrys-clone/build/classes/java/main started by sieun in /Users/sieun/ben-jerrys-clone)
[DEBUG] 25-10-01 23:48:41 [BenjerryscloneApplication:54] - Running with Spring Boot v3.5.5, Spring v6.2.10
[INFO ] 25-10-01 23:48:41 [BenjerryscloneApplication:652] - No active profile set, falling back to 1 default profile: "dev"
[INFO ] 25-10-01 23:48:45 [BenjerryscloneApplication:59] - Started BenjerryscloneApplication in 5.45 seconds (process running for 6.369)
[INFO ] 25-10-01 23:49:56 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:49:57 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:49:57 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/
[DEBUG] 25-10-01 23:49:57 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 23:49:57 [existsCategorySlug:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String)
[INFO ] 25-10-01 23:49:57 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'chocolate-chip-cookie-dough-ice-cream'

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-01 23:49:58 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 23:49:58 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-01 23:49:58 [selectVariantDetailDefault:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String)
[INFO ] 25-10-01 23:49:58 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|30005 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:49:58 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-01 23:49:58 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:49:58 [selectVariantMedia:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:49:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30005
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                      |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png        |초콜릿 칩 쿠키 도우 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null               |5          |
|NUTRITION |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:49:58 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:49:58 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:49:58 [selectVariantGallery:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:49:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30005
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                      |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null   |5          |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:49:58 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:49:58 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:49:58 [selectVariantIngredients:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:49:58 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30005

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100583-0002-en-US-1669211882662/index.html |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:49:58 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:49:58 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:49:58 [selectVariantSourcing:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:49:58 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30005
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:49:58 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:49:58 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:49:58 [selectVariantCerts:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:49:58 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30005
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:49:58 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:49:58 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:49:58 [selectRecommendations:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:49:58 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30005
ORDER BY r.slot

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30013 |vanilla-ice-cream                    |바닐라         |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                    |5         |
|30002 |half-baked-ice-cream                 |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:49:58 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:49:58 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:49:58 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-01 23:49:58 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:49:58 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:49:58 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:49:58 [findNextVariant:135] - ==> Parameters: 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long)
[INFO ] 25-10-01 23:49:58 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30005))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30005)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:49:58 [resultsettable:610] - 
|------|----------------------------------|-----|
|id    |slug                              |slug |
|------|----------------------------------|-----|
|30003 |chocolate-fudge-brownie-ice-cream |pint |
|------|----------------------------------|-----|

[DEBUG] 25-10-01 23:49:58 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:49:58 [MyInterceptor:122] - running time: 1384(ms)
[INFO ] 25-10-01 23:50:03 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:03 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:03 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-pints
[INFO ] 25-10-01 23:50:03 [MyInterceptor:101] - - REFERER : time=4994, url=http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/
[DEBUG] 25-10-01 23:50:03 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 23:50:03 [existsCategorySlug:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-01 23:50:03 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-pints'

[INFO ] 25-10-01 23:50:03 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-01 23:50:03 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:03 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-01 23:50:03 [selectByCategory:135] - ==> Parameters: ice-cream-pints(String)
[INFO ] 25-10-01 23:50:03 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-pints'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-01 23:50:03 [resultsettable:610] - 
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|id    |slug                                   |name_ko      |is_new |flavour_type_id |list_slug       |name_ko |url                                                                                |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|
|30004 |strawberry-cheesecake-ice-cream        |스트로베리 치즈케이크  |true   |1               |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png        |
|30010 |new-york-super-fudge-chunk-ice-cream   |뉴욕 수퍼 퍼지 청크  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png   |
|30009 |mint-chocolate-cookie-ice-cream        |민트 초콜릿 칩 쿠키  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |
|30013 |vanilla-ice-cream                      |바닐라          |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/packshot/main.png                      |
|30001 |chunky-monkey-ice-cream                |청키 몽키®       |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png                |
|30006 |cherry-garcia-ice-cream                |체리 가르시아®     |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png                |
|30005 |chocolate-chip-cookie-dough-ice-cream  |초콜릿 칩 쿠키 도우  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png  |
|30003 |chocolate-fudge-brownie-ice-cream      |초콜릿 퍼지 브라우니  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png      |
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png |
|30011 |peanut-butter-cup-ice-cream            |피넛 버터 컵      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png            |
|30012 |pistachio-pistachio-ice-cream          |피스타치오 피스타치오  |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png          |
|30002 |half-baked-ice-cream                   |하프베이크드®      |false  |1               |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png                   |
|30008 |karamel-sutra-core                     |카라멜 수트라      |false  |2               |ice-cream-pints |파인트     |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png                     |
|------|---------------------------------------|-------------|-------|----------------|----------------|--------|-----------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:03 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-01 23:50:03 [MyInterceptor:122] - running time: 174(ms)
[INFO ] 25-10-01 23:50:06 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:06 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:06 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/
[INFO ] 25-10-01 23:50:06 [MyInterceptor:101] - - REFERER : time=2904, url=http://localhost:8080/flavours/ice-cream-pints
[DEBUG] 25-10-01 23:50:06 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 23:50:06 [existsCategorySlug:135] - ==> Parameters: cherry-garcia-ice-cream(String)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'cherry-garcia-ice-cream'

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-01 23:50:06 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:06 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-01 23:50:06 [selectVariantDetailDefault:135] - ==> Parameters: cherry-garcia-ice-cream(String)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:06 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:06 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:06 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-01 23:50:06 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:06 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:06 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:06 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:06 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:06 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:06 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:06 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:06 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:06 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:06 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:06 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:06 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:06 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:06 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:06 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:06 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:06 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:06 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:06 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:06 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-01 23:50:06 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:06 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-01 23:50:06 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:06 [MyInterceptor:122] - running time: 247(ms)
[INFO ] 25-10-01 23:50:11 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:11 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:11 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[INFO ] 25-10-01 23:50:11 [MyInterceptor:101] - - REFERER : time=4672, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/
[DEBUG] 25-10-01 23:50:11 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:11 [selectVariantDetail:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:11 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-cheesecake-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:11 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                   |id    |slug                            |name_ko     |description_ko                    |is_new |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|
|30004 |항상 치즈케이크를 먹고 싶어하는 애호가들을 위해 딸기 과육이 가득하고, 부드러운 치즈케이크의 풍미와 환상적인 그라함 크래커 스월이 가득 찬 아이스크림 입니다. |20004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림 |true   |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:11 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:11 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:11 [selectVariantMedia:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:11 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30004
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:11 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                            |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png    |스트로베리 치즈케이크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null               |1          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null               |5          |
|NUTRITION |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/nutrition/473ml.png  |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:11 [selectVariantMedia:135] - <==      Total: 4
[DEBUG] 25-10-01 23:50:11 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:11 [selectVariantGallery:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:11 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30004
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:11 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null   |1          |
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:11 [selectVariantGallery:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:11 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:11 [selectVariantIngredients:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:11 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30004

[INFO ] 25-10-01 23:50:11 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                    |smartlabel_url |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|아이스크림믹스[유크림, 탈지우유, 정제수, 설탕시럽 (설탕, 정제수), 가당난황, 구아검, 카라기난], 그라함크래커[기타설탕, 옥수수전분, 카놀라유, 대두유, 밀가루], 딸기다이스 [딸기, 설탕, 구아검, 레몬농축과즙], 치즈케이크베이스[설탕, 정제수, 크림치즈, 향료, 젖산], 딸기퓌레 |null           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:50:11 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:11 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:11 [selectVariantSourcing:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:11 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30004
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:11 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Open Chain Sourcing           |/assets/img/misc/90008_Cocoa_Sourcing_VLS_Simpler_Icons.avif                |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:11 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-01 23:50:11 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:11 [selectVariantCerts:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:11 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30004
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:11 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:50:11 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:11 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:11 [selectRecommendations:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:11 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30004
ORDER BY r.slot

[INFO ] 25-10-01 23:50:11 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream   |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30006 |cherry-garcia-ice-cream           |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg           |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:11 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:11 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:11 [selectAvailableCategories:135] - ==> Parameters: 20004(Long)
[INFO ] 25-10-01 23:50:11 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20004
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:11 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30004 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:11 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:11 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:11 [findNextVariant:135] - ==> Parameters: 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long)
[INFO ] 25-10-01 23:50:11 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30004))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30004)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:11 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30001 |chunky-monkey-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-01 23:50:11 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:11 [MyInterceptor:122] - running time: 140(ms)
[INFO ] 25-10-01 23:50:14 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:14 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:14 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[INFO ] 25-10-01 23:50:14 [MyInterceptor:101] - - REFERER : time=2898, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[DEBUG] 25-10-01 23:50:14 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:14 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:14 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:14 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:14 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:14 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:14 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:14 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:14 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-01 23:50:14 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:14 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:14 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:14 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:14 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:14 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:14 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:14 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:14 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-01 23:50:14 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:14 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:14 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:14 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:14 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:14 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:14 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:14 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:14 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:14 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:14 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:14 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:14 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:14 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:14 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-01 23:50:14 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:14 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:14 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:14 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-01 23:50:14 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:14 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:14 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:14 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:14 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-01 23:50:14 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:14 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-01 23:50:14 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:14 [MyInterceptor:122] - running time: 242(ms)
[INFO ] 25-10-01 23:50:17 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:17 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:17 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chunky-monkey-ice-cream/pint
[INFO ] 25-10-01 23:50:17 [MyInterceptor:101] - - REFERER : time=2895, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-01 23:50:17 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:17 [selectVariantDetail:135] - ==> Parameters: chunky-monkey-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:17 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chunky-monkey-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:17 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                 |id    |slug                    |name_ko |description_ko           |is_new |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|-----|----------------|--------|
|30001 |이름만큼 재미있는 맛을 내기 위해 최종적으로 맛을 결정할 때까지 여러 개의 테스트 배치를 가지고 놀았습니다. 원숭이가 먹을 바나나는 없지만 견과류와 초콜릿 덩어리가 가득 들어있습니다. |20001 |chunky-monkey-ice-cream |청키 몽키®  |호두 퍼지 덩어리가 들어간 바나나 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:17 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:17 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:17 [selectVariantMedia:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:17 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30001
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:17 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|-------------|-----------|
|role      |url                                                                        |alt_ko       |sort_order |
|----------|---------------------------------------------------------------------------|-------------|-----------|
|PACKSHOT  |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png        |청키 몽키 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/01-tower.avif    |null         |1          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/02-envirolid.jpg |null         |2          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/03-scooped.jpg   |null         |3          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/04-enviro.jpg    |null         |4          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg      |null         |5          |
|NUTRITION |/assets/img/flavours/chunky-monkey-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml  |0          |
|----------|---------------------------------------------------------------------------|-------------|-----------|

[DEBUG] 25-10-01 23:50:17 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:17 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:17 [selectVariantGallery:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:17 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30001
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:17 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/01-tower.avif    |null   |1          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:17 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:17 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:17 [selectVariantIngredients:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:17 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30001

[INFO ] 25-10-01 23:50:17 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                             |smartlabel_url                                                                                                 |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽(설탕, 정제수), 정제수, 설탕, 코코아, 코코아분말, 대두유, 난황, 수수설탕, 전란, 전란액, 소금, 구아검, 카라기난, 바닐라추출물, 맥아분말, 탄산수소나트륨 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100354-0003-en-US-1665758042857/index.html |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:17 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:17 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:17 [selectVariantSourcing:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:17 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30001
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:17 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:17 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:17 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:17 [selectVariantCerts:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:17 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30001
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:17 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:17 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:17 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:17 [selectRecommendations:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:17 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30001
ORDER BY r.slot

[INFO ] 25-10-01 23:50:17 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30006 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30011 |peanut-butter-cup-ice-cream          |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg          |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:17 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:17 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:17 [selectAvailableCategories:135] - ==> Parameters: 20001(Long)
[INFO ] 25-10-01 23:50:17 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20001
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:17 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30001 |
|SCOOP |scoop-shop |스쿱 샵    |30035 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:17 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:17 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:17 [findNextVariant:135] - ==> Parameters: 30001(Long), 30001(Long), 30001(Long), 30001(Long), 30001(Long), 30001(Long)
[INFO ] 25-10-01 23:50:17 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30001))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30001)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30001)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30001)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30001)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30001)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:17 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30006 |cherry-garcia-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-01 23:50:17 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:17 [MyInterceptor:122] - running time: 132(ms)
[INFO ] 25-10-01 23:50:25 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:25 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:25 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[INFO ] 25-10-01 23:50:25 [MyInterceptor:101] - - REFERER : time=7666, url=http://localhost:8080/flavours/chunky-monkey-ice-cream/pint
[DEBUG] 25-10-01 23:50:25 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:25 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:25 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:25 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                 |id    |slug                                 |name_ko     |description_ko                              |is_new |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----|----------------|--------|
|30010 |1985년에 벤앤제리스는 뉴욕만의 새로운 플레이버로 다양한 종류의 청크들을 넣은 뉴욕 수퍼 퍼지 청크를 탄생시켰습니다. 뉴욕에서도 인기있는 플레이버라면 어디서든 맛 볼 수 있을거라 생각했어요. 실제로도 그렇고요. |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:25 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:25 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:25 [selectVariantMedia:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-01 23:50:25 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30010
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:25 [resultsettable:610] - 
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                     |alt_ko             |sort_order |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/packshot/main.png        |뉴욕 수퍼 퍼지 청크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:25 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:25 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:25 [selectVariantGallery:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-01 23:50:25 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30010
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:25 [resultsettable:610] - 
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                     |alt_ko |sort_order |
|--------|----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:25 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:25 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:25 [selectVariantIngredients:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-01 23:50:25 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30010

[INFO ] 25-10-01 23:50:25 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                |smartlabel_url                                                                                                           |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100149-0002-en-US-1670951315103/index.html#nutrition |
|----------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:25 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:25 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:25 [selectVariantSourcing:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-01 23:50:25 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30010
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:25 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:25 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:25 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:25 [selectVariantCerts:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-01 23:50:25 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30010
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:25 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:25 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:25 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:25 [selectRecommendations:135] - ==> Parameters: 30010(Long)
[INFO ] 25-10-01 23:50:25 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30010
ORDER BY r.slot

[INFO ] 25-10-01 23:50:25 [resultsettable:610] - 
|------|------------------------------|------------|-------|-----|----------------|--------|----------------------------------------------------------------------------|----------|
|id    |slug                          |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                    |sortorder |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream       |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg       |5         |
|30011 |peanut-butter-cup-ice-cream   |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30012 |pistachio-pistachio-ice-cream |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|------------------------------|------------|-------|-----|----------------|--------|----------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:25 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:25 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:25 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-01 23:50:25 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:25 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:25 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:25 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:25 [findNextVariant:135] - ==> Parameters: 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long), 30010(Long)
[INFO ] 25-10-01 23:50:25 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30010))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30010)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30010)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30010)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:25 [resultsettable:610] - 
|------|--------------------------------|-----|
|id    |slug                            |slug |
|------|--------------------------------|-----|
|30009 |mint-chocolate-cookie-ice-cream |pint |
|------|--------------------------------|-----|

[DEBUG] 25-10-01 23:50:25 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:25 [MyInterceptor:122] - running time: 111(ms)
[INFO ] 25-10-01 23:50:28 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:28 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:28 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/peanut-butter-cup-ice-cream/pint
[INFO ] 25-10-01 23:50:28 [MyInterceptor:101] - - REFERER : time=3467, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/pint
[DEBUG] 25-10-01 23:50:28 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:28 [selectVariantDetail:135] - ==> Parameters: peanut-butter-cup-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:28 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'peanut-butter-cup-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:28 [resultsettable:610] - 
|------|-------------------------------------------------------------|------|----------------------------|--------|----------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                       |id    |slug                        |name_ko |description_ko                          |is_new |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------|------|----------------------------|--------|----------------------------------------|-------|-----|----------------|--------|
|30011 |고소한 피넛(땅콩) 버터 아이스크림에 달콤하고 짭조름한 피넛(땅콩) 버터 초콜릿이 콕콕 박혀있는 아이스크림. |20011 |peanut-butter-cup-ice-cream |피넛 버터 컵 |고소한 피넛버터 아이스크림에 피넛버터 초콜릿이 콕콕 박혀있는 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------|------|----------------------------|--------|----------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:28 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:28 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:28 [selectVariantMedia:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:28 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30011
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:28 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                            |alt_ko         |sort_order |
|----------|-------------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png        |피넛 버터 컵 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|-------------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-01 23:50:28 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:28 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:28 [selectVariantGallery:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:28 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30011
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:28 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:28 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:28 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:28 [selectVariantIngredients:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:28 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30011

[INFO ] 25-10-01 23:50:28 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                |smartlabel_url                                                                                                 |
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|유크림, 탈지농축우유, 설탕 시럽 (설탕, 정제수), 정제수, 땅콩, 설탕, 코코넛유, 계란 노른자, 부분 지방질 땅콩 가루, 땅콩기름, 우유, 코코아 (알칼리 처리), 소금, 구아검, 대두 레시틴, 바닐라 추출물, 카라기난 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100811-0002-en-US-1675809822278/index.html |
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:28 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:28 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:28 [selectVariantSourcing:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:28 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30011
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:28 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:28 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-01 23:50:28 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:28 [selectVariantCerts:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:28 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30011
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:28 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:28 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:28 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:28 [selectRecommendations:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:28 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30011
ORDER BY r.slot

[INFO ] 25-10-01 23:50:28 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30012 |pistachio-pistachio-ice-cream        |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg        |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30009 |mint-chocolate-cookie-ice-cream      |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:28 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:28 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:28 [selectAvailableCategories:135] - ==> Parameters: 20011(Long)
[INFO ] 25-10-01 23:50:28 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20011
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:28 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30011 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:28 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:28 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:28 [findNextVariant:135] - ==> Parameters: 30011(Long), 30011(Long), 30011(Long), 30011(Long), 30011(Long), 30011(Long)
[INFO ] 25-10-01 23:50:28 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30011))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30011)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30011)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30011)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30011)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30011)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:28 [resultsettable:610] - 
|------|------------------------------|-----|
|id    |slug                          |slug |
|------|------------------------------|-----|
|30012 |pistachio-pistachio-ice-cream |pint |
|------|------------------------------|-----|

[DEBUG] 25-10-01 23:50:28 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:28 [MyInterceptor:122] - running time: 127(ms)
[INFO ] 25-10-01 23:50:31 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:31 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:31 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/mint-chocolate-cookie-ice-cream/pint
[INFO ] 25-10-01 23:50:31 [MyInterceptor:101] - - REFERER : time=2956, url=http://localhost:8080/flavours/peanut-butter-cup-ice-cream/pint
[DEBUG] 25-10-01 23:50:31 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:31 [selectVariantDetail:135] - ==> Parameters: mint-chocolate-cookie-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:31 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'mint-chocolate-cookie-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:31 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------------------------|------|--------------------------------|------------|-------------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                           |id    |slug                            |name_ko     |description_ko                             |is_new |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------------------------|------|--------------------------------|------------|-------------------------------------------|-------|-----|----------------|--------|
|30009 |신선한 민트 아이스크림 베이스에 초콜릿 쿠키가 덩어리 채 들어있는 아이스크림.인공색소가 들어가지 않은 하얀색 민트 아이스크림과 초콜릿이 선사하는 색다른 달콤함을 즐겨보세요! |20009 |mint-chocolate-cookie-ice-cream |민트 초콜릿 칩 쿠키 |신선한 민트 아이스크림 베이스에 초콜릿 쿠키가 덩어리 채 들어있는 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------------------------|------|--------------------------------|------------|-------------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:31 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:31 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:31 [selectVariantMedia:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:31 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30009
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:31 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |민트 초콜릿 칩 쿠키 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:31 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:31 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:31 [selectVariantGallery:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:31 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30009
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:31 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|-----------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:31 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:31 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:31 [selectVariantIngredients:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:31 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30009

[INFO ] 25-10-01 23:50:31 [resultsettable:610] - 
|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                      |smartlabel_url                                                                                                           |
|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽 (설탕, 정제수), 정제수, 가당난황, 구아검, 초콜릿샌드위치쿠키,설탕, 밀가루, 코코넛유, 코코아분말, 해바라기유, 소금, 탄산수소나트륨, 천연향료, 대두레시틴, 페퍼민트추출물. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100040-0002-en-US-1672414892314/index.html#nutrition |
|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:31 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:31 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:31 [selectVariantSourcing:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:31 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30009
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:31 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:31 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:31 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:31 [selectVariantCerts:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:31 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30009
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:31 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:31 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:31 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:31 [selectRecommendations:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:31 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30009
ORDER BY r.slot

[INFO ] 25-10-01 23:50:31 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|30004 |strawberry-cheesecake-ice-cream   |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png   |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|30013 |vanilla-ice-cream                 |바닐라         |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:31 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:31 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:31 [selectAvailableCategories:135] - ==> Parameters: 20009(Long)
[INFO ] 25-10-01 23:50:31 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20009
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:31 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30009 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:31 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:31 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:31 [findNextVariant:135] - ==> Parameters: 30009(Long), 30009(Long), 30009(Long), 30009(Long), 30009(Long), 30009(Long)
[INFO ] 25-10-01 23:50:31 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30009))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30009)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30009)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30009)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30009)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30009)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:31 [resultsettable:610] - 
|------|------------------|-----|
|id    |slug              |slug |
|------|------------------|-----|
|30013 |vanilla-ice-cream |pint |
|------|------------------|-----|

[DEBUG] 25-10-01 23:50:31 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:31 [MyInterceptor:122] - running time: 116(ms)
[INFO ] 25-10-01 23:50:35 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:35 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:35 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[INFO ] 25-10-01 23:50:35 [MyInterceptor:101] - - REFERER : time=3169, url=http://localhost:8080/flavours/mint-chocolate-cookie-ice-cream/pint
[DEBUG] 25-10-01 23:50:35 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:35 [selectVariantDetail:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:35 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-cheesecake-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:35 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                   |id    |slug                            |name_ko     |description_ko                    |is_new |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|
|30004 |항상 치즈케이크를 먹고 싶어하는 애호가들을 위해 딸기 과육이 가득하고, 부드러운 치즈케이크의 풍미와 환상적인 그라함 크래커 스월이 가득 찬 아이스크림 입니다. |20004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림 |true   |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:35 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:35 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:35 [selectVariantMedia:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:35 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30004
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:35 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                            |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png    |스트로베리 치즈케이크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null               |1          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null               |5          |
|NUTRITION |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/nutrition/473ml.png  |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:35 [selectVariantMedia:135] - <==      Total: 4
[DEBUG] 25-10-01 23:50:35 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:35 [selectVariantGallery:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:35 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30004
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:35 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null   |1          |
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:35 [selectVariantGallery:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:35 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:35 [selectVariantIngredients:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:35 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30004

[INFO ] 25-10-01 23:50:35 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                    |smartlabel_url |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|아이스크림믹스[유크림, 탈지우유, 정제수, 설탕시럽 (설탕, 정제수), 가당난황, 구아검, 카라기난], 그라함크래커[기타설탕, 옥수수전분, 카놀라유, 대두유, 밀가루], 딸기다이스 [딸기, 설탕, 구아검, 레몬농축과즙], 치즈케이크베이스[설탕, 정제수, 크림치즈, 향료, 젖산], 딸기퓌레 |null           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:50:35 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:35 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:35 [selectVariantSourcing:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:35 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30004
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:35 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Open Chain Sourcing           |/assets/img/misc/90008_Cocoa_Sourcing_VLS_Simpler_Icons.avif                |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:35 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-01 23:50:35 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:35 [selectVariantCerts:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:35 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30004
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:35 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:50:35 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:35 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:35 [selectRecommendations:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:35 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30004
ORDER BY r.slot

[INFO ] 25-10-01 23:50:35 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream   |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30006 |cherry-garcia-ice-cream           |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg           |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:35 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:35 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:35 [selectAvailableCategories:135] - ==> Parameters: 20004(Long)
[INFO ] 25-10-01 23:50:35 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20004
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:35 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30004 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:35 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:35 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:35 [findNextVariant:135] - ==> Parameters: 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long)
[INFO ] 25-10-01 23:50:35 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30004))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30004)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:35 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30001 |chunky-monkey-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-01 23:50:35 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:35 [MyInterceptor:122] - running time: 183(ms)
[INFO ] 25-10-01 23:50:38 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:38 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:38 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/mint-chocolate-cookie-ice-cream/pint
[INFO ] 25-10-01 23:50:38 [MyInterceptor:101] - - REFERER : time=2900, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[DEBUG] 25-10-01 23:50:38 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:38 [selectVariantDetail:135] - ==> Parameters: mint-chocolate-cookie-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:38 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'mint-chocolate-cookie-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:38 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------------------------|------|--------------------------------|------------|-------------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                           |id    |slug                            |name_ko     |description_ko                             |is_new |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------------------------|------|--------------------------------|------------|-------------------------------------------|-------|-----|----------------|--------|
|30009 |신선한 민트 아이스크림 베이스에 초콜릿 쿠키가 덩어리 채 들어있는 아이스크림.인공색소가 들어가지 않은 하얀색 민트 아이스크림과 초콜릿이 선사하는 색다른 달콤함을 즐겨보세요! |20009 |mint-chocolate-cookie-ice-cream |민트 초콜릿 칩 쿠키 |신선한 민트 아이스크림 베이스에 초콜릿 쿠키가 덩어리 채 들어있는 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------------------------|------|--------------------------------|------------|-------------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:38 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:38 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:38 [selectVariantMedia:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:38 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30009
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:38 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/packshot/main.png        |민트 초콜릿 칩 쿠키 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:38 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:38 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:38 [selectVariantGallery:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:38 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30009
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:38 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|-----------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:38 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:38 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:38 [selectVariantIngredients:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:38 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30009

[INFO ] 25-10-01 23:50:38 [resultsettable:610] - 
|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                      |smartlabel_url                                                                                                           |
|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽 (설탕, 정제수), 정제수, 가당난황, 구아검, 초콜릿샌드위치쿠키,설탕, 밀가루, 코코넛유, 코코아분말, 해바라기유, 소금, 탄산수소나트륨, 천연향료, 대두레시틴, 페퍼민트추출물. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100040-0002-en-US-1672414892314/index.html#nutrition |
|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:38 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:38 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:38 [selectVariantSourcing:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:38 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30009
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:38 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:38 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:38 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:38 [selectVariantCerts:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:38 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30009
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:38 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:38 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:38 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:38 [selectRecommendations:135] - ==> Parameters: 30009(Long)
[INFO ] 25-10-01 23:50:38 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30009
ORDER BY r.slot

[INFO ] 25-10-01 23:50:38 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|30004 |strawberry-cheesecake-ice-cream   |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png   |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|30013 |vanilla-ice-cream                 |바닐라         |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:38 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:38 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:38 [selectAvailableCategories:135] - ==> Parameters: 20009(Long)
[INFO ] 25-10-01 23:50:38 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20009
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:38 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30009 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:38 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:38 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:38 [findNextVariant:135] - ==> Parameters: 30009(Long), 30009(Long), 30009(Long), 30009(Long), 30009(Long), 30009(Long)
[INFO ] 25-10-01 23:50:38 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30009))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30009)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30009)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30009)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30009)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30009)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:38 [resultsettable:610] - 
|------|------------------|-----|
|id    |slug              |slug |
|------|------------------|-----|
|30013 |vanilla-ice-cream |pint |
|------|------------------|-----|

[DEBUG] 25-10-01 23:50:38 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:38 [MyInterceptor:122] - running time: 125(ms)
[INFO ] 25-10-01 23:50:40 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:40 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:40 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[INFO ] 25-10-01 23:50:40 [MyInterceptor:101] - - REFERER : time=2624, url=http://localhost:8080/flavours/mint-chocolate-cookie-ice-cream/pint
[DEBUG] 25-10-01 23:50:41 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:41 [selectVariantDetail:135] - ==> Parameters: strawberry-cheesecake-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:41 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-cheesecake-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:41 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                   |id    |slug                            |name_ko     |description_ko                    |is_new |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|
|30004 |항상 치즈케이크를 먹고 싶어하는 애호가들을 위해 딸기 과육이 가득하고, 부드러운 치즈케이크의 풍미와 환상적인 그라함 크래커 스월이 가득 찬 아이스크림 입니다. |20004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |그라함 크래커 스월이 가득한 스트로베리 치즈케이크 아이스크림 |true   |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------|------|--------------------------------|------------|----------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:41 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:41 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:41 [selectVariantMedia:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:41 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30004
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:41 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                            |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/packshot/main.png    |스트로베리 치즈케이크 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null               |1          |
|GALLERY   |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null               |5          |
|NUTRITION |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/nutrition/473ml.png  |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:41 [selectVariantMedia:135] - <==      Total: 4
[DEBUG] 25-10-01 23:50:41 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:41 [selectVariantGallery:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:41 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30004
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:41 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/01-tower.png |null   |1          |
|GALLERY |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png  |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:41 [selectVariantGallery:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:41 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:41 [selectVariantIngredients:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:41 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30004

[INFO ] 25-10-01 23:50:41 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                    |smartlabel_url |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|아이스크림믹스[유크림, 탈지우유, 정제수, 설탕시럽 (설탕, 정제수), 가당난황, 구아검, 카라기난], 그라함크래커[기타설탕, 옥수수전분, 카놀라유, 대두유, 밀가루], 딸기다이스 [딸기, 설탕, 구아검, 레몬농축과즙], 치즈케이크베이스[설탕, 정제수, 크림치즈, 향료, 젖산], 딸기퓌레 |null           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:50:41 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:41 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:41 [selectVariantSourcing:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:41 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30004
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:41 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Open Chain Sourcing           |/assets/img/misc/90008_Cocoa_Sourcing_VLS_Simpler_Icons.avif                |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:41 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-01 23:50:41 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:41 [selectVariantCerts:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:41 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30004
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:41 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:50:41 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:41 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:41 [selectRecommendations:135] - ==> Parameters: 30004(Long)
[INFO ] 25-10-01 23:50:41 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30004
ORDER BY r.slot

[INFO ] 25-10-01 23:50:41 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                        |sortorder |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream   |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg   |5         |
|30006 |cherry-garcia-ice-cream           |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg           |5         |
|30003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|----------------------------------|------------|-------|-----|----------------|--------|--------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:41 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:41 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:41 [selectAvailableCategories:135] - ==> Parameters: 20004(Long)
[INFO ] 25-10-01 23:50:41 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20004
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:41 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30004 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:41 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:41 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:41 [findNextVariant:135] - ==> Parameters: 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long), 30004(Long)
[INFO ] 25-10-01 23:50:41 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30004))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30004)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30004)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30004)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:41 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30001 |chunky-monkey-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-01 23:50:41 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:41 [MyInterceptor:122] - running time: 86(ms)
[INFO ] 25-10-01 23:50:48 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:48 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:48 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chunky-monkey-ice-cream/pint
[INFO ] 25-10-01 23:50:48 [MyInterceptor:101] - - REFERER : time=7765, url=http://localhost:8080/flavours/strawberry-cheesecake-ice-cream/pint
[DEBUG] 25-10-01 23:50:48 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:48 [selectVariantDetail:135] - ==> Parameters: chunky-monkey-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:48 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chunky-monkey-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:48 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                 |id    |slug                    |name_ko |description_ko           |is_new |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|-----|----------------|--------|
|30001 |이름만큼 재미있는 맛을 내기 위해 최종적으로 맛을 결정할 때까지 여러 개의 테스트 배치를 가지고 놀았습니다. 원숭이가 먹을 바나나는 없지만 견과류와 초콜릿 덩어리가 가득 들어있습니다. |20001 |chunky-monkey-ice-cream |청키 몽키®  |호두 퍼지 덩어리가 들어간 바나나 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:48 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:48 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:48 [selectVariantMedia:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:48 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30001
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:48 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|-------------|-----------|
|role      |url                                                                        |alt_ko       |sort_order |
|----------|---------------------------------------------------------------------------|-------------|-----------|
|PACKSHOT  |/assets/img/flavours/chunky-monkey-ice-cream/pint/packshot/main.png        |청키 몽키 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/01-tower.avif    |null         |1          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/02-envirolid.jpg |null         |2          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/03-scooped.jpg   |null         |3          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/04-enviro.jpg    |null         |4          |
|GALLERY   |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg      |null         |5          |
|NUTRITION |/assets/img/flavours/chunky-monkey-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml  |0          |
|----------|---------------------------------------------------------------------------|-------------|-----------|

[DEBUG] 25-10-01 23:50:48 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:48 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:48 [selectVariantGallery:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:48 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30001
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:48 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/01-tower.avif    |null   |1          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:48 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:48 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:48 [selectVariantIngredients:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:48 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30001

[INFO ] 25-10-01 23:50:48 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                             |smartlabel_url                                                                                                 |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽(설탕, 정제수), 정제수, 설탕, 코코아, 코코아분말, 대두유, 난황, 수수설탕, 전란, 전란액, 소금, 구아검, 카라기난, 바닐라추출물, 맥아분말, 탄산수소나트륨 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100354-0003-en-US-1665758042857/index.html |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:48 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:48 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:48 [selectVariantSourcing:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:48 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30001
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:48 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:48 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:48 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:48 [selectVariantCerts:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:48 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30001
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:48 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:48 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:48 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:48 [selectRecommendations:135] - ==> Parameters: 30001(Long)
[INFO ] 25-10-01 23:50:48 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30001
ORDER BY r.slot

[INFO ] 25-10-01 23:50:48 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30006 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30011 |peanut-butter-cup-ice-cream          |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg          |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:48 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:48 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:48 [selectAvailableCategories:135] - ==> Parameters: 20001(Long)
[INFO ] 25-10-01 23:50:48 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20001
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:48 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30001 |
|SCOOP |scoop-shop |스쿱 샵    |30035 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:48 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:48 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:48 [findNextVariant:135] - ==> Parameters: 30001(Long), 30001(Long), 30001(Long), 30001(Long), 30001(Long), 30001(Long)
[INFO ] 25-10-01 23:50:48 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30001))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30001)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30001)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30001)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30001)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30001)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:48 [resultsettable:610] - 
|------|------------------------|-----|
|id    |slug                    |slug |
|------|------------------------|-----|
|30006 |cherry-garcia-ice-cream |pint |
|------|------------------------|-----|

[DEBUG] 25-10-01 23:50:48 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:48 [MyInterceptor:122] - running time: 84(ms)
[INFO ] 25-10-01 23:50:49 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:49 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:49 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[INFO ] 25-10-01 23:50:49 [MyInterceptor:101] - - REFERER : time=615, url=http://localhost:8080/flavours/chunky-monkey-ice-cream/pint
[DEBUG] 25-10-01 23:50:49 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:49 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:49 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:49 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                          |id    |slug                    |name_ko  |description_ko           |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|
|30006 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사를 보내며, 팬들이 제안한 맛으로 가장 유명한 전설적인 락 밴드의 이름을 따서 만든 최초의 아이스크림입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:49 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:49 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:49 [selectVariantMedia:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:49 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30006
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:49 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/pint/packshot/main.png        |체리 가르시아 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-01 23:50:49 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:49 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:49 [selectVariantGallery:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:49 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30006
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:49 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:49 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:49 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:49 [selectVariantIngredients:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:49 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30006

[INFO ] 25-10-01 23:50:49 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                 |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100156-0002-en-US-1665758051552/index.html |
|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:49 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:49 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:49 [selectVariantSourcing:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:49 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30006
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:49 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:49 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:49 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:49 [selectVariantCerts:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:49 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30006
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:49 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:49 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:49 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:49 [selectRecommendations:135] - ==> Parameters: 30006(Long)
[INFO ] 25-10-01 23:50:49 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30006
ORDER BY r.slot

[INFO ] 25-10-01 23:50:49 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:49 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:49 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:49 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-01 23:50:49 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:49 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:49 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:49 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:49 [findNextVariant:135] - ==> Parameters: 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long), 30006(Long)
[INFO ] 25-10-01 23:50:49 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30006))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30006)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30006)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30006)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:49 [resultsettable:610] - 
|------|--------------------------------------|-----|
|id    |slug                                  |slug |
|------|--------------------------------------|-----|
|30005 |chocolate-chip-cookie-dough-ice-cream |pint |
|------|--------------------------------------|-----|

[DEBUG] 25-10-01 23:50:49 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:49 [MyInterceptor:122] - running time: 85(ms)
[INFO ] 25-10-01 23:50:50 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:50 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:50 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/pint
[INFO ] 25-10-01 23:50:50 [MyInterceptor:101] - - REFERER : time=749, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/pint
[DEBUG] 25-10-01 23:50:50 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:50 [selectVariantDetail:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:50 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:50 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|30005 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:50 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:50 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:50 [selectVariantMedia:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:50:50 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30005
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:50 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                      |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png        |초콜릿 칩 쿠키 도우 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null               |5          |
|NUTRITION |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:50 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:50 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:50 [selectVariantGallery:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:50:50 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30005
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:50 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                      |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null   |5          |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:50 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:50 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:50 [selectVariantIngredients:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:50:50 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30005

[INFO ] 25-10-01 23:50:50 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100583-0002-en-US-1669211882662/index.html |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:50 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:50 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:50 [selectVariantSourcing:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:50:50 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30005
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:50 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:50 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:50 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:50 [selectVariantCerts:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:50:50 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30005
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:50 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:50:50 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:50 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:50 [selectRecommendations:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:50:50 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30005
ORDER BY r.slot

[INFO ] 25-10-01 23:50:50 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30013 |vanilla-ice-cream                    |바닐라         |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                    |5         |
|30002 |half-baked-ice-cream                 |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:50 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:50 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:50 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-01 23:50:50 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:50 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:50 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:50 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:50 [findNextVariant:135] - ==> Parameters: 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long)
[INFO ] 25-10-01 23:50:50 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30005))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30005)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:50 [resultsettable:610] - 
|------|----------------------------------|-----|
|id    |slug                              |slug |
|------|----------------------------------|-----|
|30003 |chocolate-fudge-brownie-ice-cream |pint |
|------|----------------------------------|-----|

[DEBUG] 25-10-01 23:50:50 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:50 [MyInterceptor:122] - running time: 111(ms)
[INFO ] 25-10-01 23:50:51 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:51 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:51 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/pint
[INFO ] 25-10-01 23:50:51 [MyInterceptor:101] - - REFERER : time=574, url=http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/pint
[DEBUG] 25-10-01 23:50:51 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:51 [selectVariantDetail:135] - ==> Parameters: chocolate-fudge-brownie-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-fudge-brownie-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                      |id    |slug                              |name_ko     |description_ko         |is_new |slug |list_slug       |name_ko |
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----|----------------|--------|
|30003 |풍부한 맛을 지닌 다크 초콜릿에 브라우니 퍼지 덩어리를 절묘하게 배합한 아이스크림입니다. 꿈꿔왔던 그 맛. |20003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |퍼지 브라우니가 들어간 초콜릿 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:51 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:51 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:51 [selectVariantMedia:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30003
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                  |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/packshot/main.png        |초콜릿 퍼지 브라우니 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:51 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:51 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:51 [selectVariantGallery:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30003
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                  |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|-------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:51 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:51 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:51 [selectVariantIngredients:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30003

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                               |smartlabel_url                                                                                                           |
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 액상당, 농축 탈지유, 물, 코코아, 설탕, 밀가루, 대두유, 계란 노른자, 전화당, 계란, 계란 흰자, 농후제(구아검, 카라기난), 설탕, 바닐라 추출물, 팽창제(중탄산나트륨), 맥아분 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100477-0002-en-US-1668535427889/index.html#nutrition |
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:51 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:51 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:51 [selectVariantSourcing:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30003
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Greyston Brownies             |/assets/img/misc/90007_Greyston_Brownies_VLS_Simpler_Icons.png              |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:51 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-01 23:50:51 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:51 [selectVariantCerts:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30003
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Halal        |/assets/img/misc/91001_Halal_Dietary_Icon.avif       |
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:51 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:51 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:51 [selectRecommendations:135] - ==> Parameters: 30003(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30003
ORDER BY r.slot

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|
|id    |slug                            |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                      |sortorder |
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg |5         |
|30002 |half-baked-ice-cream            |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg            |5         |
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |5         |
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:51 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:51 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:51 [selectAvailableCategories:135] - ==> Parameters: 20003(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20003
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30003 |
|MINI_CUP |mini-cup   |미니컵     |30021 |
|SCOOP    |scoop-shop |스쿱 샵    |30034 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:51 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:51 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:51 [findNextVariant:135] - ==> Parameters: 30003(Long), 30003(Long), 30003(Long), 30003(Long), 30003(Long), 30003(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30003))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30003)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30003)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30003)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30003)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30003)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|------|---------------------------------------|-----|
|id    |slug                                   |slug |
|------|---------------------------------------|-----|
|30007 |coffee-coffee-buzz-buzz-buzz-ice-cream |pint |
|------|---------------------------------------|-----|

[DEBUG] 25-10-01 23:50:51 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:51 [MyInterceptor:122] - running time: 90(ms)
[INFO ] 25-10-01 23:50:51 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:51 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:51 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint
[INFO ] 25-10-01 23:50:51 [MyInterceptor:101] - - REFERER : time=575, url=http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/pint
[DEBUG] 25-10-01 23:50:51 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:51 [selectVariantDetail:135] - ==> Parameters: coffee-coffee-buzz-buzz-buzz-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'coffee-coffee-buzz-buzz-buzz-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|------|------------------------------------------------------------------------------|------|---------------------------------------|-------------|-------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                        |id    |slug                                   |name_ko      |description_ko                       |is_new |slug |list_slug       |name_ko |
|------|------------------------------------------------------------------------------|------|---------------------------------------|-------------|-------------------------------------|-------|-----|----------------|--------|
|30007 |당신의 정신을 번쩍 들게 할, 그리고 곧 사랑을 빠져 노래를 흥얼거리게 만드는 맛! 크리미한 커피 맛 아이스크림에 에스프레소 퍼지가 가득! |20007 |coffee-coffee-buzz-buzz-buzz-ice-cream |커피커피 버즈버즈버즈! |커피 아이스크림 베이스에 에스프레소 빈 퍼지가 들어있는 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|------------------------------------------------------------------------------|------|---------------------------------------|-------------|-------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:51 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:51 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:51 [selectVariantMedia:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30007
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|----------|------------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                       |alt_ko             |sort_order |
|----------|------------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/packshot/main.png        |커피커피 버즈버즈버즈 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/05-hero.jpg      |null               |5          |
|NUTRITION |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|------------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:51 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:51 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:51 [selectVariantGallery:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30007
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                       |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:51 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:51 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:51 [selectVariantIngredients:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30007

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                           |smartlabel_url                                                                                                           |
|-----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽(설탕, 정제수), 정제수, 설탕, 코코넛유, 커피추출물, 코코아, 커피, 코코아분말, 대두레시틴, 구아검, 바닐라추출물, 카라기난. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840298617-0002-en-US-1677511188913/index.html#nutrition |
|-----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:51 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:51 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:51 [selectVariantSourcing:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30007
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:51 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:51 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:51 [selectVariantCerts:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30007
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:51 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:51 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:51 [selectRecommendations:135] - ==> Parameters: 30007(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30007
ORDER BY r.slot

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|
|id    |slug                            |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                      |sortorder |
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg |5         |
|30013 |vanilla-ice-cream               |바닐라         |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg               |5         |
|30011 |peanut-butter-cup-ice-cream     |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg     |5         |
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:51 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:51 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:51 [selectAvailableCategories:135] - ==> Parameters: 20007(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20007
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30007 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:51 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:51 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:51 [findNextVariant:135] - ==> Parameters: 30007(Long), 30007(Long), 30007(Long), 30007(Long), 30007(Long), 30007(Long)
[INFO ] 25-10-01 23:50:51 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30007))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30007)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30007)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30007)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30007)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30007)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:51 [resultsettable:610] - 
|------|----------------------------|-----|
|id    |slug                        |slug |
|------|----------------------------|-----|
|30011 |peanut-butter-cup-ice-cream |pint |
|------|----------------------------|-----|

[DEBUG] 25-10-01 23:50:51 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:51 [MyInterceptor:122] - running time: 76(ms)
[INFO ] 25-10-01 23:50:52 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:52 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:52 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/peanut-butter-cup-ice-cream/pint
[INFO ] 25-10-01 23:50:52 [MyInterceptor:101] - - REFERER : time=547, url=http://localhost:8080/flavours/coffee-coffee-buzz-buzz-buzz-ice-cream/pint
[DEBUG] 25-10-01 23:50:52 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:52 [selectVariantDetail:135] - ==> Parameters: peanut-butter-cup-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:52 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'peanut-butter-cup-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:52 [resultsettable:610] - 
|------|-------------------------------------------------------------|------|----------------------------|--------|----------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                       |id    |slug                        |name_ko |description_ko                          |is_new |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------|------|----------------------------|--------|----------------------------------------|-------|-----|----------------|--------|
|30011 |고소한 피넛(땅콩) 버터 아이스크림에 달콤하고 짭조름한 피넛(땅콩) 버터 초콜릿이 콕콕 박혀있는 아이스크림. |20011 |peanut-butter-cup-ice-cream |피넛 버터 컵 |고소한 피넛버터 아이스크림에 피넛버터 초콜릿이 콕콕 박혀있는 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------|------|----------------------------|--------|----------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:52 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:52 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:52 [selectVariantMedia:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:52 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30011
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:52 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                            |alt_ko         |sort_order |
|----------|-------------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/packshot/main.png        |피넛 버터 컵 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/01-tower.png     |null           |1          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/02-envirolid.jpg |null           |2          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/03-scooped.jpg   |null           |3          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/04-enviro.jpg    |null           |4          |
|GALLERY   |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg      |null           |5          |
|NUTRITION |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml    |0          |
|----------|-------------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-01 23:50:52 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:52 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:52 [selectVariantGallery:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:52 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30011
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:52 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                            |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|-------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:52 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:52 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:52 [selectVariantIngredients:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:52 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30011

[INFO ] 25-10-01 23:50:52 [resultsettable:610] - 
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                |smartlabel_url                                                                                                 |
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|유크림, 탈지농축우유, 설탕 시럽 (설탕, 정제수), 정제수, 땅콩, 설탕, 코코넛유, 계란 노른자, 부분 지방질 땅콩 가루, 땅콩기름, 우유, 코코아 (알칼리 처리), 소금, 구아검, 대두 레시틴, 바닐라 추출물, 카라기난 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100811-0002-en-US-1675809822278/index.html |
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:52 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:52 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:52 [selectVariantSourcing:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:52 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30011
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:52 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:52 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-01 23:50:52 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:52 [selectVariantCerts:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:52 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30011
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:52 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:52 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:52 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:52 [selectRecommendations:135] - ==> Parameters: 30011(Long)
[INFO ] 25-10-01 23:50:52 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30011
ORDER BY r.slot

[INFO ] 25-10-01 23:50:52 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30012 |pistachio-pistachio-ice-cream        |피스타치오 피스타치오 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg        |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30009 |mint-chocolate-cookie-ice-cream      |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:52 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:52 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:52 [selectAvailableCategories:135] - ==> Parameters: 20011(Long)
[INFO ] 25-10-01 23:50:52 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20011
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:52 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30011 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:52 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:52 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:52 [findNextVariant:135] - ==> Parameters: 30011(Long), 30011(Long), 30011(Long), 30011(Long), 30011(Long), 30011(Long)
[INFO ] 25-10-01 23:50:52 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30011))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30011)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30011)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30011)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30011)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30011)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:52 [resultsettable:610] - 
|------|------------------------------|-----|
|id    |slug                          |slug |
|------|------------------------------|-----|
|30012 |pistachio-pistachio-ice-cream |pint |
|------|------------------------------|-----|

[DEBUG] 25-10-01 23:50:52 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:52 [MyInterceptor:122] - running time: 70(ms)
[INFO ] 25-10-01 23:50:53 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:53 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:53 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/pistachio-pistachio-ice-cream/pint
[INFO ] 25-10-01 23:50:53 [MyInterceptor:101] - - REFERER : time=796, url=http://localhost:8080/flavours/peanut-butter-cup-ice-cream/pint
[DEBUG] 25-10-01 23:50:53 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:53 [selectVariantDetail:135] - ==> Parameters: pistachio-pistachio-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'pistachio-pistachio-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------|------|------------------------------|------------|---------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                         |id    |slug                          |name_ko     |description_ko                   |is_new |slug |list_slug       |name_ko |
|------|-------------------------------------------------------------------------------|------|------------------------------|------------|---------------------------------|-------|-----|----------------|--------|
|30012 |이름만으로도 우리가 피스타치오를 얼마나 사랑하는지 알 수 있습니다. 하지만 우리의 말을 그대로 받아들이지 말고, 맛 자체를 말하도록 하세요! |20012 |pistachio-pistachio-ice-cream |피스타치오 피스타치오 |가볍게 로스팅한 피스타치오가 들어있는 피스타치오 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-------------------------------------------------------------------------------|------|------------------------------|------------|---------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:53 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:53 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:53 [selectVariantMedia:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30012
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------------|-------------|-----------|
|role      |url                                                                              |alt_ko       |sort_order |
|----------|---------------------------------------------------------------------------------|-------------|-----------|
|PACKSHOT  |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/packshot/main.png        |피스타치오 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/01-tower.avif    |null         |1          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/02-envirolid.jpg |null         |2          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/03-scooped.jpg   |null         |3          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/04-enviro.jpg    |null         |4          |
|GALLERY   |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg      |null         |5          |
|NUTRITION |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml  |0          |
|----------|---------------------------------------------------------------------------------|-------------|-----------|

[DEBUG] 25-10-01 23:50:53 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:53 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:53 [selectVariantGallery:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30012
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                              |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/01-tower.avif    |null   |1          |
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/pistachio-pistachio-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|---------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:53 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:53 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:53 [selectVariantIngredients:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30012

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|ingredients_ko                                                                                   |smartlabel_url                                                        |
|-------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|아이스크림믹스 [유크림, 탈지우유, 설탕시럽 (설탕, 정제수), 정제수, 가당난황, 구아검, 카라기난], 로스티드피스 타치오 [피스타치오, 코코넛유, 소금], 피스타치오향료 |https://smartlabel.unileverusa.com/076840101184-0002-en-US/index.html |
|-------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:53 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:53 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:53 [selectVariantSourcing:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30012
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:53 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-01 23:50:53 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:53 [selectVariantCerts:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30012
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:53 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:53 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:53 [selectRecommendations:135] - ==> Parameters: 30012(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30012
ORDER BY r.slot

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30011 |peanut-butter-cup-ice-cream          |피넛 버터 컵     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/peanut-butter-cup-ice-cream/pint/gallery/05-hero.jpg          |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30009 |mint-chocolate-cookie-ice-cream      |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:53 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:53 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:53 [selectAvailableCategories:135] - ==> Parameters: 20012(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20012
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30012 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:53 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:53 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:53 [findNextVariant:135] - ==> Parameters: 30012(Long), 30012(Long), 30012(Long), 30012(Long), 30012(Long), 30012(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30012))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30012)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30012)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30012)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30012)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30012)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|------|---------------------|-----|
|id    |slug                 |slug |
|------|---------------------|-----|
|30002 |half-baked-ice-cream |pint |
|------|---------------------|-----|

[DEBUG] 25-10-01 23:50:53 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:53 [MyInterceptor:122] - running time: 66(ms)
[INFO ] 25-10-01 23:50:53 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:53 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:53 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/half-baked-ice-cream/pint
[INFO ] 25-10-01 23:50:53 [MyInterceptor:101] - - REFERER : time=611, url=http://localhost:8080/flavours/pistachio-pistachio-ice-cream/pint
[DEBUG] 25-10-01 23:50:53 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:53 [selectVariantDetail:135] - ==> Parameters: half-baked-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'half-baked-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                                                                                                                                                                                         |id    |slug                 |name_ko |description_ko                                   |is_new |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|-----|----------------|--------|
|30002 |우리는 스쿱샵에 들릴 때 마다 우리의 친구들이 가장 맛있을 법한 새롭고 쿨한 콤보를 만들기 위해 다양한 맛의 조합을 시도하는 것을 알게 되었습니다. 그때 우리는 이것이 정말 엄청난 아이디어라고 생각 했어요. 그래서 우리는 여러분이 사랑하는 벤앤제리스의 맛과 절묘하게 어우러진 새로운 맛을 찾기 위해 여러분이 새롭게 조합한 맛을 함께 섞어 보았습니다. 여러분은 우리가 엉뚱하다고 말할지도 모르겠지만, 우리는 말할 수 있어요. 이건 하프 베이크드 라고 해! Enjoy! 벤앤제리스를 사랑하는 모든 이들에게 감사해요. |20002 |half-baked-ice-cream |하프베이크드® |초코칩 쿠키도우와 퍼지 브라우니의 청크가 절묘하게 어우러진 초콜릿 & 바닐라 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:53 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:53 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:53 [selectVariantMedia:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30002
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|----------|------------------------------------------------------------------------|--------------|-----------|
|role      |url                                                                     |alt_ko        |sort_order |
|----------|------------------------------------------------------------------------|--------------|-----------|
|PACKSHOT  |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png        |하프베이크드 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/01-tower.png     |null          |1          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/02-envirolid.jpg |null          |2          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/03-scooped.jpg   |null          |3          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/04-enviro.jpg    |null          |4          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg      |null          |5          |
|NUTRITION |/assets/img/flavours/half-baked-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml   |0          |
|----------|------------------------------------------------------------------------|--------------|-----------|

[DEBUG] 25-10-01 23:50:53 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:53 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:53 [selectVariantGallery:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30002
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|--------|------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                     |alt_ko |sort_order |
|--------|------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:53 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:53 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:53 [selectVariantIngredients:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30002

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                     |smartlabel_url                                                                                                           |
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽, 탈지농축우유, 정제수, 설탕, 밀가루, 코코아분말, 갈색 설탕, 가당난황, 대두유, 버터, 계란, 전화당, 초콜릿 리커, 바닐라 추출물, 소금, 계란 흰자, 구아검, 카라기난, 당밀, 코코아버터, 천연향료, 맥아분말 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840101320-0002-en-US-1669212157071/index.html#nutrition |
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:53 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:53 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:53 [selectVariantSourcing:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30002
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|----------------|--------------------------------------------------------------|
|name_ko         |icon_url                                                      |
|----------------|--------------------------------------------------------------|
|Non-GMO         |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif         |
|Fairtrade       |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif       |
|Free Range Eggs |/assets/img/misc/90003_Free-range_Eggs_VLS_Simpler_Icons.webp |
|----------------|--------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:53 [selectVariantSourcing:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:53 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:53 [selectVariantCerts:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30002
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:50:53 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:53 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:53 [selectRecommendations:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30002
ORDER BY r.slot

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                            |sortorder |
|------|--------------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------------|----------|
|30005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png |5         |
|30003 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg     |5         |
|30009 |mint-chocolate-cookie-ice-cream       |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg       |5         |
|------|--------------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:53 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:53 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:53 [selectAvailableCategories:135] - ==> Parameters: 20002(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20002
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30002 |
|SCOOP |scoop-shop |스쿱 샵    |30036 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:53 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:53 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:53 [findNextVariant:135] - ==> Parameters: 30002(Long), 30002(Long), 30002(Long), 30002(Long), 30002(Long), 30002(Long)
[INFO ] 25-10-01 23:50:53 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30002))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30002)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30002)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30002)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30002)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30002)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:53 [resultsettable:610] - 
|------|-------------------|-----|
|id    |slug               |slug |
|------|-------------------|-----|
|30008 |karamel-sutra-core |pint |
|------|-------------------|-----|

[DEBUG] 25-10-01 23:50:53 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:53 [MyInterceptor:122] - running time: 87(ms)
[INFO ] 25-10-01 23:50:54 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:54 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:54 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/karamel-sutra-core/pint
[INFO ] 25-10-01 23:50:54 [MyInterceptor:101] - - REFERER : time=529, url=http://localhost:8080/flavours/half-baked-ice-cream/pint
[DEBUG] 25-10-01 23:50:54 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:54 [selectVariantDetail:135] - ==> Parameters: karamel-sutra-core(String), pint(String)
[INFO ] 25-10-01 23:50:54 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'karamel-sutra-core'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:50:54 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------|--------|-------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                 |id    |slug               |name_ko |description_ko                       |is_new |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------|--------|-------------------------------------|-------|-----|----------------|--------|
|30008 |벤앤제리스 Core를 통해 최고의 아이스크림을 경험해보세요. 원초적인 충동이 카라멜 수트라의 중심에 있는 부드러운 카라멜로 이끌든 퍼지 칩으로 이끌든, 당신은 카라멜 수트라 맛에 빠져들거에요. 글루텐 프리 제품. |20008 |karamel-sutra-core |카라멜 수트라 |퍼지 칩과 부드러운 카라멜이 들어있는 초콜릿 & 카라멜 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------|------|-------------------|--------|-------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:50:54 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:54 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:54 [selectVariantMedia:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-01 23:50:54 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30008
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:54 [resultsettable:610] - 
|----------|----------------------------------------------------------------------|------------------|-----------|
|role      |url                                                                   |alt_ko            |sort_order |
|----------|----------------------------------------------------------------------|------------------|-----------|
|PACKSHOT  |/assets/img/flavours/karamel-sutra-core/pint/packshot/main.png        |카라멜 수트라 코어 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/01-tower.png     |null              |1          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/02-envirolid.jpg |null              |2          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/03-scooped.jpg   |null              |3          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/04-enviro.jpg    |null              |4          |
|GALLERY   |/assets/img/flavours/karamel-sutra-core/pint/gallery/05-hero.jpg      |null              |5          |
|NUTRITION |/assets/img/flavours/karamel-sutra-core/pint/nutrition/473ml.png      |영양성분표 473ml       |0          |
|----------|----------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-01 23:50:54 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:50:54 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:54 [selectVariantGallery:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-01 23:50:54 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30008
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:54 [resultsettable:610] - 
|--------|----------------------------------------------------------------------|-------|-----------|
|role    |url                                                                   |alt_ko |sort_order |
|--------|----------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/karamel-sutra-core/pint/gallery/05-hero.jpg      |null   |5          |
|--------|----------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:54 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:54 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:54 [selectVariantIngredients:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-01 23:50:54 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30008

[INFO ] 25-10-01 23:50:54 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                     |smartlabel_url                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지우유, 설탕시럽 (설탕, 정제수), 정제수, 설탕, 우유, 옥수수 시럽, 코코아, 달걀 노른자, 코코넛유, 버터 (크림, 소금), 코코아분말, 유지방, 펙틴, 구아검, 베이킹 소다, 락타아제, 대두 레시틴, 바닐라 추출물, 소금, 카라기난, 천연향료. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840101542-0002-en-US-1675805403456/index.html#nutrition |
|---------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:54 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:54 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:54 [selectVariantSourcing:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-01 23:50:54 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30008
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:54 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:54 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:54 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:54 [selectVariantCerts:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-01 23:50:54 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30008
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:54 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:54 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:54 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:54 [selectRecommendations:135] - ==> Parameters: 30008(Long)
[INFO ] 25-10-01 23:50:54 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30008
ORDER BY r.slot

[INFO ] 25-10-01 23:50:54 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|30009 |mint-chocolate-cookie-ice-cream      |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg      |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:54 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:54 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:54 [selectAvailableCategories:135] - ==> Parameters: 20008(Long)
[INFO ] 25-10-01 23:50:54 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20008
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:54 [resultsettable:610] - 
|-----|-----|--------|------|
|code |slug |name_ko |id    |
|-----|-----|--------|------|
|PINT |pint |파인트     |30008 |
|-----|-----|--------|------|

[DEBUG] 25-10-01 23:50:54 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:54 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:54 [findNextVariant:135] - ==> Parameters: 30008(Long), 30008(Long), 30008(Long), 30008(Long), 30008(Long), 30008(Long)
[INFO ] 25-10-01 23:50:54 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30008))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30008)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30008)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30008)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30008)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30008)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:54 [resultsettable:610] - 
|------|------------------------|---------|
|id    |slug                    |slug     |
|------|------------------------|---------|
|30023 |cherry-garcia-ice-cream |mini-cup |
|------|------------------------|---------|

[DEBUG] 25-10-01 23:50:54 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:54 [MyInterceptor:122] - running time: 73(ms)
[INFO ] 25-10-01 23:50:55 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:55 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:55 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/mini-cup
[INFO ] 25-10-01 23:50:55 [MyInterceptor:101] - - REFERER : time=769, url=http://localhost:8080/flavours/karamel-sutra-core/pint
[DEBUG] 25-10-01 23:50:55 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:55 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), mini-cup(String)
[INFO ] 25-10-01 23:50:55 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'mini-cup'

[INFO ] 25-10-01 23:50:55 [resultsettable:610] - 
|------|--------------------------------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|---------|---------------|--------|
|id    |variant_description_ko                                                                                                                |id    |slug                    |name_ko  |description_ko           |is_new |slug     |list_slug      |name_ko |
|------|--------------------------------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|---------|---------------|--------|
|30023 |기타리스트인 제리 가르시아 (Jerry Garcia)와 그레이트 풀 데드 (Grateful Dead) 팬들에게 헌사하는 벤앤제리스의 대표 메뉴. 록 전설의 이름을 딴 최초의 아이스크림이자 벤앤제리스의 팬들이 추천하는 가장 유명한 맛입니다. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |mini-cup |ice-cream-cups |미니컵     |
|------|--------------------------------------------------------------------------------------------------------------------------------------|------|------------------------|---------|-------------------------|-------|---------|---------------|--------|

[DEBUG] 25-10-01 23:50:55 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:55 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:55 [selectVariantMedia:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-01 23:50:55 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30023
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:55 [resultsettable:610] - 
|----------|---------------------------------------------------------------------------|---------------|-----------|
|role      |url                                                                        |alt_ko         |sort_order |
|----------|---------------------------------------------------------------------------|---------------|-----------|
|PACKSHOT  |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/packshot/main.png    |체리 가르시아 미니컵 팩샷 |0          |
|GALLERY   |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/gallery/01-tower.png |null           |1          |
|NUTRITION |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/nutrition/120ml.png  |영양성분표 120ml    |0          |
|----------|---------------------------------------------------------------------------|---------------|-----------|

[DEBUG] 25-10-01 23:50:55 [selectVariantMedia:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:55 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:55 [selectVariantGallery:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-01 23:50:55 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30023
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:55 [resultsettable:610] - 
|--------|---------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                        |alt_ko |sort_order |
|--------|---------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/mini-cup/gallery/01-tower.png |null   |1          |
|--------|---------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:55 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:55 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:55 [selectVariantIngredients:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-01 23:50:55 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30023

[INFO ] 25-10-01 23:50:55 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                   |smartlabel_url                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840200153-0003-en-US-1701785653440/index.html#nutrition |
|---------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:55 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:55 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:55 [selectVariantSourcing:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-01 23:50:55 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30023
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:55 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:55 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:55 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:55 [selectVariantCerts:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-01 23:50:55 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30023
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:55 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:50:55 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:55 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:55 [selectRecommendations:135] - ==> Parameters: 30023(Long)
[INFO ] 25-10-01 23:50:55 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30023
ORDER BY r.slot

[INFO ] 25-10-01 23:50:55 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30001 |chunky-monkey-ice-cream              |청키 몽키®      |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chunky-monkey-ice-cream/pint/gallery/05-hero.jpg              |5         |
|30004 |strawberry-cheesecake-ice-cream      |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png      |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:55 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:55 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:55 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-01 23:50:55 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:55 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:55 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:55 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:55 [findNextVariant:135] - ==> Parameters: 30023(Long), 30023(Long), 30023(Long), 30023(Long), 30023(Long), 30023(Long)
[INFO ] 25-10-01 23:50:55 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30023))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30023)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30023)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30023)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30023)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30023)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:55 [resultsettable:610] - 
|------|--------------------------------------|---------|
|id    |slug                                  |slug     |
|------|--------------------------------------|---------|
|30022 |chocolate-chip-cookie-dough-ice-cream |mini-cup |
|------|--------------------------------------|---------|

[DEBUG] 25-10-01 23:50:55 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:55 [MyInterceptor:122] - running time: 82(ms)
[INFO ] 25-10-01 23:50:56 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:56 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:56 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup
[INFO ] 25-10-01 23:50:56 [MyInterceptor:101] - - REFERER : time=826, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/mini-cup
[DEBUG] 25-10-01 23:50:56 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:56 [selectVariantDetail:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String), mini-cup(String)
[INFO ] 25-10-01 23:50:56 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
  AND c.slug = 'mini-cup'

[INFO ] 25-10-01 23:50:56 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|---------|---------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |slug     |list_slug      |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|---------|---------------|--------|
|30022 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |mini-cup |ice-cream-cups |미니컵     |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|---------|---------------|--------|

[DEBUG] 25-10-01 23:50:56 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:56 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:56 [selectVariantMedia:135] - ==> Parameters: 30022(Long)
[INFO ] 25-10-01 23:50:56 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30022
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:56 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                      |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/packshot/main.png    |초콜릿 칩 쿠키 도우 미니컵 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/gallery/01-tower.png |null               |1          |
|NUTRITION |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/nutrition/120ml.png  |영양성분표 120ml        |0          |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:56 [selectVariantMedia:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:56 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:56 [selectVariantGallery:135] - ==> Parameters: 30022(Long)
[INFO ] 25-10-01 23:50:56 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30022
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:56 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                      |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup/gallery/01-tower.png |null   |1          |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:56 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:56 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:56 [selectVariantIngredients:135] - ==> Parameters: 30022(Long)
[INFO ] 25-10-01 23:50:56 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30022

[INFO ] 25-10-01 23:50:56 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url                                                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840200276-0002-en-US-1701803145903/index.html#nutrition |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:56 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:56 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:56 [selectVariantSourcing:135] - ==> Parameters: 30022(Long)
[INFO ] 25-10-01 23:50:56 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30022
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:56 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:56 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:56 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:56 [selectVariantCerts:135] - ==> Parameters: 30022(Long)
[INFO ] 25-10-01 23:50:56 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30022
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:56 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:50:56 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:56 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:56 [selectRecommendations:135] - ==> Parameters: 30022(Long)
[INFO ] 25-10-01 23:50:56 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30022
ORDER BY r.slot

[INFO ] 25-10-01 23:50:56 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30013 |vanilla-ice-cream                    |바닐라         |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                    |5         |
|30002 |half-baked-ice-cream                 |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:56 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:56 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:56 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-01 23:50:56 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:56 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:56 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:56 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:56 [findNextVariant:135] - ==> Parameters: 30022(Long), 30022(Long), 30022(Long), 30022(Long), 30022(Long), 30022(Long)
[INFO ] 25-10-01 23:50:56 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30022))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30022)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30022)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30022)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30022)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30022)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:56 [resultsettable:610] - 
|------|----------------------------------|---------|
|id    |slug                              |slug     |
|------|----------------------------------|---------|
|30021 |chocolate-fudge-brownie-ice-cream |mini-cup |
|------|----------------------------------|---------|

[DEBUG] 25-10-01 23:50:56 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:56 [MyInterceptor:122] - running time: 74(ms)
[INFO ] 25-10-01 23:50:57 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:57 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:57 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/mini-cup
[INFO ] 25-10-01 23:50:57 [MyInterceptor:101] - - REFERER : time=726, url=http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/mini-cup
[DEBUG] 25-10-01 23:50:57 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:57 [selectVariantDetail:135] - ==> Parameters: chocolate-fudge-brownie-ice-cream(String), mini-cup(String)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-fudge-brownie-ice-cream'
  AND c.slug = 'mini-cup'

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|---------|---------------|--------|
|id    |variant_description_ko                                      |id    |slug                              |name_ko     |description_ko         |is_new |slug     |list_slug      |name_ko |
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|---------|---------------|--------|
|30021 |풍부한 맛을 지닌 다크 초콜릿에 브라우니 퍼지 덩어리를 절묘하게 배합한 아이스크림입니다. 꿈꿔왔던 그 맛. |20003 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |퍼지 브라우니가 들어간 초콜릿 아이스크림 |false  |mini-cup |ice-cream-cups |미니컵     |
|------|------------------------------------------------------------|------|----------------------------------|------------|-----------------------|-------|---------|---------------|--------|

[DEBUG] 25-10-01 23:50:57 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:57 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:57 [selectVariantMedia:135] - ==> Parameters: 30021(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30021
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                  |alt_ko             |sort_order |
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/packshot/main.png    |초콜릿 퍼지 브라우니 미니컵 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/gallery/01-tower.png |null               |1          |
|NUTRITION |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/nutrition/120ml.png  |영양성분표 120ml        |0          |
|----------|-------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:50:57 [selectVariantMedia:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:57 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:57 [selectVariantGallery:135] - ==> Parameters: 30021(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30021
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                  |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/mini-cup/gallery/01-tower.png |null   |1          |
|--------|-------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:57 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:57 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:57 [selectVariantIngredients:135] - ==> Parameters: 30021(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30021

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                               |smartlabel_url                                                                                                           |
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 액상당, 농축 탈지유, 물, 코코아, 설탕, 밀가루, 대두유, 계란 노른자, 전화당, 계란, 계란 흰자, 농후제(구아검, 카라기난), 설탕, 바닐라 추출물, 팽창제(중탄산나트륨), 맥아분 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840200160-0002-en-US-1701801458882/index.html#nutrition |
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:57 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:57 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:57 [selectVariantSourcing:135] - ==> Parameters: 30021(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30021
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Greyston Brownies             |/assets/img/misc/90007_Greyston_Brownies_VLS_Simpler_Icons.png              |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:57 [selectVariantSourcing:135] - <==      Total: 6
[DEBUG] 25-10-01 23:50:57 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:57 [selectVariantCerts:135] - ==> Parameters: 30021(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30021
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Halal        |/assets/img/misc/91001_Halal_Dietary_Icon.avif       |
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:57 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:57 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:57 [selectRecommendations:135] - ==> Parameters: 30021(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30021
ORDER BY r.slot

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|
|id    |slug                            |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                      |sortorder |
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|
|30009 |mint-chocolate-cookie-ice-cream |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg |5         |
|30002 |half-baked-ice-cream            |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg            |5         |
|30004 |strawberry-cheesecake-ice-cream |스트로베리 치즈케이크 |true   |pint |ice-cream-pints |파인트     |/assets/img/flavours/strawberry-cheesecake-ice-cream/pint/gallery/05-hero.png |5         |
|------|--------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:57 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:57 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:57 [selectAvailableCategories:135] - ==> Parameters: 20003(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20003
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30003 |
|MINI_CUP |mini-cup   |미니컵     |30021 |
|SCOOP    |scoop-shop |스쿱 샵    |30034 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:57 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:57 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:57 [findNextVariant:135] - ==> Parameters: 30021(Long), 30021(Long), 30021(Long), 30021(Long), 30021(Long), 30021(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30021))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30021)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30021)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30021)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30021)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30021)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|------|-------------------------------------|-----------|
|id    |slug                                 |slug       |
|------|-------------------------------------|-----------|
|30039 |new-york-super-fudge-chunk-ice-cream |scoop-shop |
|------|-------------------------------------|-----------|

[DEBUG] 25-10-01 23:50:57 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:57 [MyInterceptor:122] - running time: 85(ms)
[INFO ] 25-10-01 23:50:57 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:57 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:57 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[INFO ] 25-10-01 23:50:57 [MyInterceptor:101] - - REFERER : time=584, url=http://localhost:8080/flavours/chocolate-fudge-brownie-ice-cream/mini-cup
[DEBUG] 25-10-01 23:50:57 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:57 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                          |id    |slug                                 |name_ko     |description_ko                              |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|
|30039 |오늘부턴 나도 뉴요커! 고소한 아몬드, 호두와 풍부한 초콜릿의 맛이 당신에게 잊을 수 없는 순간을 선물합니다. 뉴욕의 풍부하고 깊은 맛을 사랑하는 사람과 함께 즐겨보세요! |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:50:57 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:57 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:57 [selectVariantMedia:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30039
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                       |alt_ko            |sort_order |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png    |뉴욕 수퍼 퍼지 청크 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-01 23:50:57 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:57 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:57 [selectVariantGallery:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30039
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                       |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:57 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:57 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:57 [selectVariantIngredients:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30039

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                |smartlabel_url |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |null           |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:50:57 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:57 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:57 [selectVariantSourcing:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30039
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:57 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:57 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:57 [selectVariantCerts:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30039
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:57 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:57 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:57 [selectRecommendations:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30039
ORDER BY r.slot

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|30035 |chunky-monkey-ice-cream               |청키 몽키®      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |0         |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |0         |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:57 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:57 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:57 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:57 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:57 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:57 [findNextVariant:135] - ==> Parameters: 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long)
[INFO ] 25-10-01 23:50:57 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30039))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30039)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:57 [resultsettable:610] - 
|------|-------------------------------|-----------|
|id    |slug                           |slug       |
|------|-------------------------------|-----------|
|30038 |mint-chocolate-chunk-ice-cream |scoop-shop |
|------|-------------------------------|-----------|

[DEBUG] 25-10-01 23:50:57 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:57 [MyInterceptor:122] - running time: 60(ms)
[INFO ] 25-10-01 23:50:58 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:58 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:58 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/mint-chocolate-chunk-ice-cream/scoop-shop
[INFO ] 25-10-01 23:50:58 [MyInterceptor:101] - - REFERER : time=673, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:50:58 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:58 [selectVariantDetail:135] - ==> Parameters: mint-chocolate-chunk-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:50:58 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'mint-chocolate-chunk-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:50:58 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------------------------------------------------|------|-------------------------------|----------|--------------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                    |id    |slug                           |name_ko   |description_ko                        |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------------------------------------------------|------|-------------------------------|----------|--------------------------------------|-------|-----------|------------------------|--------|
|30038 |민트 초코 덕후들은 주목! 벤앤제리스 아이스크림 맛의 비결이 무엇일까요? 벤앤제리스는 성장호르몬을 맞지 않은 친환경적인 젖소들을 사랑합니다. 그들이 만들어낸 우유로 만든 아이스크림과 민트, 그리고 덩어리 채 들어있는 초콜릿 칩이 기대되지 않나요? |20016 |mint-chocolate-chunk-ice-cream |민트 초콜릿 청크 |민트 아이스크림 베이스에 초콜릿 칩이 덩어리 채 들어있는 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------------------------------------------------|------|-------------------------------|----------|--------------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:50:58 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:58 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:58 [selectVariantMedia:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:50:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30038
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:58 [resultsettable:610] - 
|---------|---------------------------------------------------------------------------------|----------------|-----------|
|role     |url                                                                              |alt_ko          |sort_order |
|---------|---------------------------------------------------------------------------------|----------------|-----------|
|PACKSHOT |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png |민트 초콜릿 청크 스쿱 팩샷 |0          |
|---------|---------------------------------------------------------------------------------|----------------|-----------|

[DEBUG] 25-10-01 23:50:58 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:58 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:58 [selectVariantGallery:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:50:58 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30038
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:58 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 23:50:58 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:58 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:58 [selectVariantIngredients:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:50:58 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30038

[INFO ] 25-10-01 23:50:58 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                 |smartlabel_url |
|---------------------------------------------------------------------------------------------------------------|---------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 퍼지 덩어리[설탕, 코코넛 오일, (알칼리로 처리한) 코코아, 코코아, 유지방, 대두 레시틴, 천연착향료], 계란 노른자, 천연착향료, 구아검, 카라기난. |null           |
|---------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:50:58 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:58 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:58 [selectVariantSourcing:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:50:58 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30038
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:58 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:58 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:58 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:58 [selectVariantCerts:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:50:58 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30038
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:58 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:50:58 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:58 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:58 [selectRecommendations:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:50:58 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30038
ORDER BY r.slot

[INFO ] 25-10-01 23:50:58 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30032 |chocolate-ice-cream                  |초콜릿         |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                  |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30031 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png              |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:58 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:58 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:58 [selectAvailableCategories:135] - ==> Parameters: 20016(Long)
[INFO ] 25-10-01 23:50:58 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20016
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:58 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30038 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:58 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:58 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:58 [findNextVariant:135] - ==> Parameters: 30038(Long), 30038(Long), 30038(Long), 30038(Long), 30038(Long), 30038(Long)
[INFO ] 25-10-01 23:50:58 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30038))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30038)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30038)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30038)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30038)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30038)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:58 [resultsettable:610] - 
|------|------------------|-----------|
|id    |slug              |slug       |
|------|------------------|-----------|
|30041 |vanilla-ice-cream |scoop-shop |
|------|------------------|-----------|

[DEBUG] 25-10-01 23:50:58 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:58 [MyInterceptor:122] - running time: 85(ms)
[INFO ] 25-10-01 23:50:59 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:59 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:59 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/vanilla-ice-cream/scoop-shop
[INFO ] 25-10-01 23:50:59 [MyInterceptor:101] - - REFERER : time=641, url=http://localhost:8080/flavours/mint-chocolate-chunk-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:50:59 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:59 [selectVariantDetail:135] - ==> Parameters: vanilla-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'vanilla-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------|-------------------------------------------------------------------------------------------------------------------|------|------------------|--------|---------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                             |id    |slug              |name_ko |description_ko |is_new |slug       |list_slug               |name_ko |
|------|-------------------------------------------------------------------------------------------------------------------|------|------------------|--------|---------------|-------|-----------|------------------------|--------|
|30041 |홈메이드 보다 더 부드러운, 바닐라 아이스크림! 벤앤제리스의 바닐라 빈이 소규모 농부들에 의해 키워진다는 것을 아시나요? 당신의 현명한 선택이 소작농과 농업 사회에 긍정적인 변화의 씨앗이 될 수 있습니다! |20013 |vanilla-ice-cream |바닐라     |바닐라 아이스크림      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|-------------------------------------------------------------------------------------------------------------------|------|------------------|--------|---------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:50:59 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:59 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:59 [selectVariantMedia:135] - ==> Parameters: 30041(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30041
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|---------|-----------------------------------------------------------------------|----------|-----------|
|role     |url                                                                    |alt_ko    |sort_order |
|---------|-----------------------------------------------------------------------|----------|-----------|
|PACKSHOT |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png    |바닐라 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/vanilla-ice-cream/scoop-shop/gallery/01-tower.png |null      |1          |
|---------|-----------------------------------------------------------------------|----------|-----------|

[DEBUG] 25-10-01 23:50:59 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:59 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:59 [selectVariantGallery:135] - ==> Parameters: 30041(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30041
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------|-------|-----------|
|role    |url                                                                    |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/vanilla-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|-----------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:50:59 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:59 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:59 [selectVariantIngredients:135] - ==> Parameters: 30041(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30041

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|---------------------------------------------------------------|---------------|
|ingredients_ko                                                 |smartlabel_url |
|---------------------------------------------------------------|---------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 계란 노른자, 설탕, 구아검, 바닐라 추출물, 바닐라 빈, 카라기난. |null           |
|---------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:50:59 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:59 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:59 [selectVariantSourcing:135] - ==> Parameters: 30041(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30041
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:59 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:59 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:59 [selectVariantCerts:135] - ==> Parameters: 30041(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30041
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:50:59 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:59 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:59 [selectRecommendations:135] - ==> Parameters: 30041(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30041
ORDER BY r.slot

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|30038 |mint-chocolate-chunk-ice-cream        |민트 초콜릿 청크   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |0         |
|30032 |chocolate-ice-cream                   |초콜릿         |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:59 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:59 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:59 [selectAvailableCategories:135] - ==> Parameters: 20013(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20013
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30013 |
|SCOOP |scoop-shop |스쿱 샵    |30041 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:59 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:50:59 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:59 [findNextVariant:135] - ==> Parameters: 30041(Long), 30041(Long), 30041(Long), 30041(Long), 30041(Long), 30041(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30041))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30041)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30041)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30041)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30041)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30041)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------|----------------------------------|-----------|
|id    |slug                              |slug       |
|------|----------------------------------|-----------|
|30043 |sweet-cream-and-cookies-ice-cream |scoop-shop |
|------|----------------------------------|-----------|

[DEBUG] 25-10-01 23:50:59 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:59 [MyInterceptor:122] - running time: 64(ms)
[INFO ] 25-10-01 23:50:59 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:50:59 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:50:59 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop
[INFO ] 25-10-01 23:50:59 [MyInterceptor:101] - - REFERER : time=627, url=http://localhost:8080/flavours/vanilla-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:50:59 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:50:59 [selectVariantDetail:135] - ==> Parameters: sweet-cream-and-cookies-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'sweet-cream-and-cookies-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------|---------------------------------------------------------------------|------|----------------------------------|----------|--------------------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                               |id    |slug                              |name_ko   |description_ko                              |is_new |slug       |list_slug               |name_ko |
|------|---------------------------------------------------------------------|------|----------------------------------|----------|--------------------------------------------|-------|-----------|------------------------|--------|
|30043 |농장에서 신선한 우유와 크림, 그리고 벤앤제리스가 선택한 스페셜한 청크를 함께 맛보세요! 당신의 하루가 달콤하게 변할거예요 |20019 |sweet-cream-and-cookies-ice-cream |스위트 크림&쿠키 |바닐라 아이스크림 베이스에 초코 쿠키와 스위트 크림이 듬뿍 들어있는 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|---------------------------------------------------------------------|------|----------------------------------|----------|--------------------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:50:59 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:59 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:50:59 [selectVariantMedia:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30043
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------------|----------------|-----------|
|role     |url                                                                                 |alt_ko          |sort_order |
|---------|------------------------------------------------------------------------------------|----------------|-----------|
|PACKSHOT |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png |스위트 크림&쿠키 스쿱 팩샷 |0          |
|---------|------------------------------------------------------------------------------------|----------------|-----------|

[DEBUG] 25-10-01 23:50:59 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:59 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:50:59 [selectVariantGallery:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30043
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 23:50:59 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:59 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:50:59 [selectVariantIngredients:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30043

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                               |smartlabel_url |
|-------------------------------------------------------------------------------------------------------------|---------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 설탕, 밀가루, 계란 노른자, 코코넛 오일, (알칼리로 처리한)코코아, 해바라기유, 소금, 베이킹 소다, 천연착향료, 구아검, 대두 레시틴, 카라기난. |null           |
|-------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:50:59 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:59 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:50:59 [selectVariantSourcing:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30043
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:50:59 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:50:59 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:50:59 [selectVariantCerts:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30043
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:50:59 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:50:59 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:50:59 [selectRecommendations:135] - ==> Parameters: 30043(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30043
ORDER BY r.slot

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------|----------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------------|----------|
|id    |slug                              |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                            |sortorder |
|------|----------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------------|----------|
|30034 |chocolate-fudge-brownie-ice-cream |초콜릿 퍼지 브라우니 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png |0         |
|30032 |chocolate-ice-cream               |초콜릿         |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png               |0         |
|30038 |mint-chocolate-chunk-ice-cream    |민트 초콜릿 청크   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png    |0         |
|------|----------------------------------|------------|-------|-----------|------------------------|--------|------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:50:59 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:50:59 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:50:59 [selectAvailableCategories:135] - ==> Parameters: 20019(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20019
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30043 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:50:59 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:50:59 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:50:59 [findNextVariant:135] - ==> Parameters: 30043(Long), 30043(Long), 30043(Long), 30043(Long), 30043(Long), 30043(Long)
[INFO ] 25-10-01 23:50:59 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30043))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30043)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30043)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30043)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30043)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30043)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:50:59 [resultsettable:610] - 
|------|---------------------|-----------|
|id    |slug                 |slug       |
|------|---------------------|-----------|
|30040 |strawberry-ice-cream |scoop-shop |
|------|---------------------|-----------|

[DEBUG] 25-10-01 23:50:59 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:50:59 [MyInterceptor:122] - running time: 92(ms)
[INFO ] 25-10-01 23:51:00 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:00 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:00 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/strawberry-ice-cream/scoop-shop
[INFO ] 25-10-01 23:51:00 [MyInterceptor:101] - - REFERER : time=553, url=http://localhost:8080/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:51:00 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:51:00 [selectVariantDetail:135] - ==> Parameters: strawberry-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:51:00 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'strawberry-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:51:00 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-----------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                           |id    |slug                 |name_ko |description_ko                     |is_new |slug       |list_slug               |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-----------------------------------|-------|-----------|------------------------|--------|
|30040 |딸기에 퐁당! 상큼한 딸기 맛 볼 준비되었나요? 벤앤제리스는 성장호르몬을 맞지 않은 친환경적인 젖소를 사랑합니다. 부드럽고 신선한 우유와 풍부한 딸기 청크가 가득한 신선한 맛의 벤앤제리스를 즐겨보세요! |20017 |strawberry-ice-cream |스트로베리   |딸기 아이스크림 베이스에 딸기 과육이 듬뿍 들어있는 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|-----------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-----------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:00 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:00 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:00 [selectVariantMedia:135] - ==> Parameters: 30040(Long)
[INFO ] 25-10-01 23:51:00 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30040
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:00 [resultsettable:610] - 
|---------|-----------------------------------------------------------------------|------------|-----------|
|role     |url                                                                    |alt_ko      |sort_order |
|---------|-----------------------------------------------------------------------|------------|-----------|
|PACKSHOT |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png |스트로베리 스쿱 팩샷 |0          |
|---------|-----------------------------------------------------------------------|------------|-----------|

[DEBUG] 25-10-01 23:51:00 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:00 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:00 [selectVariantGallery:135] - ==> Parameters: 30040(Long)
[INFO ] 25-10-01 23:51:00 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30040
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:00 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 23:51:00 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:00 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:00 [selectVariantIngredients:135] - ==> Parameters: 30040(Long)
[INFO ] 25-10-01 23:51:00 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30040

[INFO ] 25-10-01 23:51:00 [resultsettable:610] - 
|---------------------------------------------------|---------------|
|ingredients_ko                                     |smartlabel_url |
|---------------------------------------------------|---------------|
|크림, 탈지유, 딸기, 액상당(설탕, 물), 물, 설탕, 계란 노른자, 구아검, 카라기난. |null           |
|---------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:00 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:00 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:00 [selectVariantSourcing:135] - ==> Parameters: 30040(Long)
[INFO ] 25-10-01 23:51:00 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30040
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:00 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:00 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:51:00 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:00 [selectVariantCerts:135] - ==> Parameters: 30040(Long)
[INFO ] 25-10-01 23:51:00 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30040
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:00 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:51:00 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:00 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:00 [selectRecommendations:135] - ==> Parameters: 30040(Long)
[INFO ] 25-10-01 23:51:00 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30040
ORDER BY r.slot

[INFO ] 25-10-01 23:51:00 [resultsettable:610] - 
|------|------------------------|---------|-------|-----------|------------------------|--------|--------------------------------------------------------------------------|----------|
|id    |slug                    |name_ko  |is_new |slug       |list_slug               |name_ko |imageurl                                                                  |sortorder |
|------|------------------------|---------|-------|-----------|------------------------|--------|--------------------------------------------------------------------------|----------|
|30031 |cherry-garcia-ice-cream |체리 가르시아® |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png |0         |
|30032 |chocolate-ice-cream     |초콜릿      |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png     |0         |
|30041 |vanilla-ice-cream       |바닐라      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png       |0         |
|------|------------------------|---------|-------|-----------|------------------------|--------|--------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:00 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:00 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:00 [selectAvailableCategories:135] - ==> Parameters: 20017(Long)
[INFO ] 25-10-01 23:51:00 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20017
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:00 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30040 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:00 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:00 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:00 [findNextVariant:135] - ==> Parameters: 30040(Long), 30040(Long), 30040(Long), 30040(Long), 30040(Long), 30040(Long)
[INFO ] 25-10-01 23:51:00 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30040))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30040)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30040)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30040)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30040)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30040)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:00 [resultsettable:610] - 
|------|------------------------|-----------|
|id    |slug                    |slug       |
|------|------------------------|-----------|
|30035 |chunky-monkey-ice-cream |scoop-shop |
|------|------------------------|-----------|

[DEBUG] 25-10-01 23:51:00 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:00 [MyInterceptor:122] - running time: 75(ms)
[INFO ] 25-10-01 23:51:01 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:01 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:01 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chunky-monkey-ice-cream/scoop-shop
[INFO ] 25-10-01 23:51:01 [MyInterceptor:101] - - REFERER : time=692, url=http://localhost:8080/flavours/strawberry-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:51:01 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:51:01 [selectVariantDetail:135] - ==> Parameters: chunky-monkey-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:51:01 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chunky-monkey-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:51:01 [resultsettable:610] - 
|------|--------------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                        |id    |slug                    |name_ko |description_ko           |is_new |slug       |list_slug               |name_ko |
|------|--------------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|-----------|------------------------|--------|
|30035 |원숭이만 바나나에 반하나? 벤앤제리스도 바나나에 반했다! 고소한 넛츠와 달콤한 초콜릿, 그리고 바나나 아이스크림이 이루는 환상적인 조화! 벤앤제리스에서만 느낄 수 있는 특별한 맛을 지금 맛보세요! |20001 |chunky-monkey-ice-cream |청키 몽키®  |호두 퍼지 덩어리가 들어간 바나나 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|--------------------------------------------------------------------------------------------------------------|------|------------------------|--------|-------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:01 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:01 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:01 [selectVariantMedia:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-01 23:51:01 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30035
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:01 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------|------------|-----------|
|role     |url                                                                           |alt_ko      |sort_order |
|---------|------------------------------------------------------------------------------|------------|-----------|
|PACKSHOT |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png     |청키 몽키 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/gallery/01-tower.avif |null        |1          |
|---------|------------------------------------------------------------------------------|------------|-----------|

[DEBUG] 25-10-01 23:51:01 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:01 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:01 [selectVariantGallery:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-01 23:51:01 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30035
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:01 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                           |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/gallery/01-tower.avif |null   |1          |
|--------|------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:51:01 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:01 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:01 [selectVariantIngredients:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-01 23:51:01 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30035

[INFO ] 25-10-01 23:51:01 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                             |smartlabel_url |
|-----------------------------------------------------------------------------------------------------------|---------------|
|크림, 탈지우유, 설탕시럽(설탕, 정제수), 정제수, 설탕, 코코아, 코코아분말, 대두유, 난황, 수수설탕, 전란, 전란액, 소금, 구아검, 카라기난, 바닐라추출물, 맥아분말, 탄산수소나트륨 |null           |
|-----------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:01 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:01 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:01 [selectVariantSourcing:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-01 23:51:01 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30035
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:01 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:01 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:51:01 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:01 [selectVariantCerts:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-01 23:51:01 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30035
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:01 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:51:01 [selectVariantCerts:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:01 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:01 [selectRecommendations:135] - ==> Parameters: 30035(Long)
[INFO ] 25-10-01 23:51:01 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30035
ORDER BY r.slot

[INFO ] 25-10-01 23:51:01 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|30039 |new-york-super-fudge-chunk-ice-cream  |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |0         |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |0         |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:01 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:01 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:01 [selectAvailableCategories:135] - ==> Parameters: 20001(Long)
[INFO ] 25-10-01 23:51:01 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20001
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:01 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30001 |
|SCOOP |scoop-shop |스쿱 샵    |30035 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:01 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:01 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:01 [findNextVariant:135] - ==> Parameters: 30035(Long), 30035(Long), 30035(Long), 30035(Long), 30035(Long), 30035(Long)
[INFO ] 25-10-01 23:51:01 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30035))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30035)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30035)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30035)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30035)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30035)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:01 [resultsettable:610] - 
|------|------------------------|-----------|
|id    |slug                    |slug       |
|------|------------------------|-----------|
|30031 |cherry-garcia-ice-cream |scoop-shop |
|------|------------------------|-----------|

[DEBUG] 25-10-01 23:51:01 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:01 [MyInterceptor:122] - running time: 96(ms)
[INFO ] 25-10-01 23:51:04 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:04 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:04 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop
[INFO ] 25-10-01 23:51:04 [MyInterceptor:101] - - REFERER : time=3249, url=http://localhost:8080/flavours/chunky-monkey-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:51:04 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:51:04 [selectVariantDetail:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:51:04 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:51:04 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |slug       |list_slug               |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----------|------------------------|--------|
|30033 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:04 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:04 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:04 [selectVariantMedia:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:51:04 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30033
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:04 [resultsettable:610] - 
|---------|-------------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                        |alt_ko            |sort_order |
|---------|-------------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png    |초콜릿 칩 쿠키 도우 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|-------------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-01 23:51:04 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:04 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:04 [selectVariantGallery:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:51:04 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30033
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:04 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                        |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|-------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:51:04 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:04 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:04 [selectVariantIngredients:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:51:04 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30033

[INFO ] 25-10-01 23:51:04 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |null           |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:04 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:04 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:04 [selectVariantSourcing:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:51:04 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30033
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:04 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:04 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:51:04 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:04 [selectVariantCerts:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:51:04 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30033
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:04 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:51:04 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:04 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:04 [selectRecommendations:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:51:04 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30033
ORDER BY r.slot

[INFO ] 25-10-01 23:51:04 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30041 |vanilla-ice-cream                    |바닐라         |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                    |0         |
|30036 |half-baked-ice-cream                 |하프베이크드®     |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                 |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:04 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:04 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:04 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-01 23:51:04 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:04 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:04 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:04 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:04 [findNextVariant:135] - ==> Parameters: 30033(Long), 30033(Long), 30033(Long), 30033(Long), 30033(Long), 30033(Long)
[INFO ] 25-10-01 23:51:04 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30033))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30033)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30033)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30033)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30033)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30033)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:04 [resultsettable:610] - 
|------|----------------------------------|-----------|
|id    |slug                              |slug       |
|------|----------------------------------|-----------|
|30034 |chocolate-fudge-brownie-ice-cream |scoop-shop |
|------|----------------------------------|-----------|

[DEBUG] 25-10-01 23:51:04 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:04 [MyInterceptor:122] - running time: 92(ms)
[INFO ] 25-10-01 23:51:07 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:07 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:07 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[INFO ] 25-10-01 23:51:07 [MyInterceptor:101] - - REFERER : time=2633, url=http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:51:07 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:51:07 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:51:07 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:51:07 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                          |id    |slug                                 |name_ko     |description_ko                              |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|
|30039 |오늘부턴 나도 뉴요커! 고소한 아몬드, 호두와 풍부한 초콜릿의 맛이 당신에게 잊을 수 없는 순간을 선물합니다. 뉴욕의 풍부하고 깊은 맛을 사랑하는 사람과 함께 즐겨보세요! |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:07 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:07 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:07 [selectVariantMedia:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:07 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30039
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:07 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                       |alt_ko            |sort_order |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png    |뉴욕 수퍼 퍼지 청크 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-01 23:51:07 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:07 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:07 [selectVariantGallery:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:07 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30039
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:07 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                       |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:51:07 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:07 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:07 [selectVariantIngredients:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:07 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30039

[INFO ] 25-10-01 23:51:07 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                |smartlabel_url |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |null           |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:07 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:07 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:07 [selectVariantSourcing:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:07 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30039
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:07 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:07 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:51:07 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:07 [selectVariantCerts:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:07 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30039
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:07 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:51:07 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:07 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:07 [selectRecommendations:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:07 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30039
ORDER BY r.slot

[INFO ] 25-10-01 23:51:07 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|30035 |chunky-monkey-ice-cream               |청키 몽키®      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |0         |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |0         |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:07 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:07 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:07 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-01 23:51:07 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:07 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:07 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:07 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:07 [findNextVariant:135] - ==> Parameters: 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long)
[INFO ] 25-10-01 23:51:07 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30039))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30039)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:07 [resultsettable:610] - 
|------|-------------------------------|-----------|
|id    |slug                           |slug       |
|------|-------------------------------|-----------|
|30038 |mint-chocolate-chunk-ice-cream |scoop-shop |
|------|-------------------------------|-----------|

[DEBUG] 25-10-01 23:51:07 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:07 [MyInterceptor:122] - running time: 88(ms)
[INFO ] 25-10-01 23:51:10 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:10 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:10 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/cherry-garcia-ice-cream/scoop-shop
[INFO ] 25-10-01 23:51:10 [MyInterceptor:101] - - REFERER : time=2743, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:51:10 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:51:10 [selectVariantDetail:135] - ==> Parameters: cherry-garcia-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:51:10 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'cherry-garcia-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:51:10 [resultsettable:610] - 
|------|-----------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                               |id    |slug                    |name_ko  |description_ko           |is_new |slug       |list_slug               |name_ko |
|------|-----------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----------|------------------------|--------|
|30031 |전세계 기타리스트 제리 가르시아와 그레이트풀 데드 팬들에게 바치는 먹을 수 있는 최고의 찬사. |20006 |cherry-garcia-ice-cream |체리 가르시아® |체리 퍼지 플레이크가 들어간 체리 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|-----------------------------------------------------|------|------------------------|---------|-------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:10 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:10 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:10 [selectVariantMedia:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-01 23:51:10 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30031
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:10 [resultsettable:610] - 
|---------|-----------------------------------------------------------------------------|--------------|-----------|
|role     |url                                                                          |alt_ko        |sort_order |
|---------|-----------------------------------------------------------------------------|--------------|-----------|
|PACKSHOT |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png    |체리 가르시아 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/gallery/01-tower.png |null          |1          |
|---------|-----------------------------------------------------------------------------|--------------|-----------|

[DEBUG] 25-10-01 23:51:10 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:10 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:10 [selectVariantGallery:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-01 23:51:10 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30031
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:10 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                          |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|-----------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:51:10 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:10 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:10 [selectVariantIngredients:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-01 23:51:10 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30031

[INFO ] 25-10-01 23:51:10 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                   |smartlabel_url |
|---------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 체리, 설탕, 계란 노른자, 코코넛 오일, (알칼리로 처리한) 코코아, 과일 및 채소 농축액(색소), 코코아 파우더, 구아검, 천연착향료, 레몬 농축액, 카라기난, 유지방, 대두 레시틴. |null           |
|---------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:10 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:10 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:10 [selectVariantSourcing:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-01 23:51:10 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30031
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:10 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:10 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:51:10 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:10 [selectVariantCerts:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-01 23:51:10 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30031
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:10 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:51:10 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:10 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:10 [selectRecommendations:135] - ==> Parameters: 30031(Long)
[INFO ] 25-10-01 23:51:10 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30031
ORDER BY r.slot

[INFO ] 25-10-01 23:51:10 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30035 |chunky-monkey-ice-cream              |청키 몽키®      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png              |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30032 |chocolate-ice-cream                  |초콜릿         |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                  |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:10 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:10 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:10 [selectAvailableCategories:135] - ==> Parameters: 20006(Long)
[INFO ] 25-10-01 23:51:10 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20006
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:10 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30006 |
|MINI_CUP |mini-cup   |미니컵     |30023 |
|SCOOP    |scoop-shop |스쿱 샵    |30031 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:10 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:10 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:10 [findNextVariant:135] - ==> Parameters: 30031(Long), 30031(Long), 30031(Long), 30031(Long), 30031(Long), 30031(Long)
[INFO ] 25-10-01 23:51:10 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30031))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30031)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30031)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30031)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30031)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30031)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:10 [resultsettable:610] - 
|------|--------------------|-----------|
|id    |slug                |slug       |
|------|--------------------|-----------|
|30032 |chocolate-ice-cream |scoop-shop |
|------|--------------------|-----------|

[DEBUG] 25-10-01 23:51:10 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:10 [MyInterceptor:122] - running time: 70(ms)
[INFO ] 25-10-01 23:51:12 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:12 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:12 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-ice-cream/scoop-shop
[INFO ] 25-10-01 23:51:12 [MyInterceptor:101] - - REFERER : time=2548, url=http://localhost:8080/flavours/cherry-garcia-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:51:12 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:51:12 [selectVariantDetail:135] - ==> Parameters: chocolate-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:51:12 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:51:12 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                                |id    |slug                |name_ko |description_ko |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|30032 |저희 초콜릿 아이스크림은 공정무역 인증® 코코아에서 초콜릿 맛을 얻습니다. 공정무역은 코코아 재배자들이 그들의 수확에 대한 공정한 가격을 보장하고, 그들이 그들의 땅과 생계를 보호하고, 그들의 가족을 위해 제공하고, 그들의 미래에 투자할 수 있도록 합니다. 즐기세요! |20014 |chocolate-ice-cream |초콜릿     |초콜릿 아이스크림      |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:12 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:12 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:12 [selectVariantMedia:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:12 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30032
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:12 [resultsettable:610] - 
|---------|----------------------------------------------------------------------|----------|-----------|
|role     |url                                                                   |alt_ko    |sort_order |
|---------|----------------------------------------------------------------------|----------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png |초콜릿 스쿱 팩샷 |0          |
|---------|----------------------------------------------------------------------|----------|-----------|

[DEBUG] 25-10-01 23:51:12 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:12 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:12 [selectVariantGallery:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:12 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30032
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:12 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 23:51:12 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:12 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:12 [selectVariantIngredients:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:12 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30032

[INFO ] 25-10-01 23:51:12 [resultsettable:610] - 
|--------------------------------------------------------|---------------|
|ingredients_ko                                          |smartlabel_url |
|--------------------------------------------------------|---------------|
|유크림, 설탕시럽(설탕, 정제수), 탈지농축우유, 정제수, 코코아분말, 가당난황, 구아검, 카라기난 |null           |
|--------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:12 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:12 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:12 [selectVariantSourcing:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:12 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30032
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:12 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:12 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-01 23:51:12 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:12 [selectVariantCerts:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:12 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30032
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:12 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:51:12 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:12 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:12 [selectRecommendations:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:12 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30032
ORDER BY r.slot

[INFO ] 25-10-01 23:51:12 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30038 |mint-chocolate-chunk-ice-cream       |민트 초콜릿 청크   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png       |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30031 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png              |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:12 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:12 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:12 [selectAvailableCategories:135] - ==> Parameters: 20014(Long)
[INFO ] 25-10-01 23:51:12 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20014
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:12 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30032 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:12 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:12 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:12 [findNextVariant:135] - ==> Parameters: 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long)
[INFO ] 25-10-01 23:51:12 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30032))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30032)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:12 [resultsettable:610] - 
|------|--------------------------------------|-----------|
|id    |slug                                  |slug       |
|------|--------------------------------------|-----------|
|30033 |chocolate-chip-cookie-dough-ice-cream |scoop-shop |
|------|--------------------------------------|-----------|

[DEBUG] 25-10-01 23:51:12 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:12 [MyInterceptor:122] - running time: 84(ms)
[INFO ] 25-10-01 23:51:16 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:16 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:16 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/mint-chocolate-chunk-ice-cream/scoop-shop
[INFO ] 25-10-01 23:51:16 [MyInterceptor:101] - - REFERER : time=3291, url=http://localhost:8080/flavours/chocolate-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:51:16 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:51:16 [selectVariantDetail:135] - ==> Parameters: mint-chocolate-chunk-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:51:16 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'mint-chocolate-chunk-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:51:16 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------------------------------------------------|------|-------------------------------|----------|--------------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                    |id    |slug                           |name_ko   |description_ko                        |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------------------------------------------------|------|-------------------------------|----------|--------------------------------------|-------|-----------|------------------------|--------|
|30038 |민트 초코 덕후들은 주목! 벤앤제리스 아이스크림 맛의 비결이 무엇일까요? 벤앤제리스는 성장호르몬을 맞지 않은 친환경적인 젖소들을 사랑합니다. 그들이 만들어낸 우유로 만든 아이스크림과 민트, 그리고 덩어리 채 들어있는 초콜릿 칩이 기대되지 않나요? |20016 |mint-chocolate-chunk-ice-cream |민트 초콜릿 청크 |민트 아이스크림 베이스에 초콜릿 칩이 덩어리 채 들어있는 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------------------------------------------------|------|-------------------------------|----------|--------------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:16 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:16 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:16 [selectVariantMedia:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:51:16 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30038
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:16 [resultsettable:610] - 
|---------|---------------------------------------------------------------------------------|----------------|-----------|
|role     |url                                                                              |alt_ko          |sort_order |
|---------|---------------------------------------------------------------------------------|----------------|-----------|
|PACKSHOT |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png |민트 초콜릿 청크 스쿱 팩샷 |0          |
|---------|---------------------------------------------------------------------------------|----------------|-----------|

[DEBUG] 25-10-01 23:51:16 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:16 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:16 [selectVariantGallery:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:51:16 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30038
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:16 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 23:51:16 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:16 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:16 [selectVariantIngredients:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:51:16 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30038

[INFO ] 25-10-01 23:51:16 [resultsettable:610] - 
|---------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                 |smartlabel_url |
|---------------------------------------------------------------------------------------------------------------|---------------|
|크림, 탈지유, 액상당(설탕, 물), 물, 퍼지 덩어리[설탕, 코코넛 오일, (알칼리로 처리한) 코코아, 코코아, 유지방, 대두 레시틴, 천연착향료], 계란 노른자, 천연착향료, 구아검, 카라기난. |null           |
|---------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:16 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:16 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:16 [selectVariantSourcing:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:51:16 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30038
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:16 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:16 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:51:16 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:16 [selectVariantCerts:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:51:16 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30038
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:16 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:51:16 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:16 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:16 [selectRecommendations:135] - ==> Parameters: 30038(Long)
[INFO ] 25-10-01 23:51:16 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30038
ORDER BY r.slot

[INFO ] 25-10-01 23:51:16 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30032 |chocolate-ice-cream                  |초콜릿         |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                  |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30031 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png              |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:16 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:16 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:16 [selectAvailableCategories:135] - ==> Parameters: 20016(Long)
[INFO ] 25-10-01 23:51:16 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20016
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:16 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30038 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:16 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:16 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:16 [findNextVariant:135] - ==> Parameters: 30038(Long), 30038(Long), 30038(Long), 30038(Long), 30038(Long), 30038(Long)
[INFO ] 25-10-01 23:51:16 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30038))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30038)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30038)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30038)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30038)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30038)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:16 [resultsettable:610] - 
|------|------------------|-----------|
|id    |slug              |slug       |
|------|------------------|-----------|
|30041 |vanilla-ice-cream |scoop-shop |
|------|------------------|-----------|

[DEBUG] 25-10-01 23:51:16 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:16 [MyInterceptor:122] - running time: 62(ms)
[INFO ] 25-10-01 23:51:18 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:18 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:18 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-ice-cream/scoop-shop
[INFO ] 25-10-01 23:51:18 [MyInterceptor:101] - - REFERER : time=2148, url=http://localhost:8080/flavours/mint-chocolate-chunk-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:51:18 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:51:18 [selectVariantDetail:135] - ==> Parameters: chocolate-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:51:18 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:51:18 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                                                                                |id    |slug                |name_ko |description_ko |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|
|30032 |저희 초콜릿 아이스크림은 공정무역 인증® 코코아에서 초콜릿 맛을 얻습니다. 공정무역은 코코아 재배자들이 그들의 수확에 대한 공정한 가격을 보장하고, 그들이 그들의 땅과 생계를 보호하고, 그들의 가족을 위해 제공하고, 그들의 미래에 투자할 수 있도록 합니다. 즐기세요! |20014 |chocolate-ice-cream |초콜릿     |초콜릿 아이스크림      |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|------|--------------------|--------|---------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:18 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:18 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:18 [selectVariantMedia:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:18 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30032
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:18 [resultsettable:610] - 
|---------|----------------------------------------------------------------------|----------|-----------|
|role     |url                                                                   |alt_ko    |sort_order |
|---------|----------------------------------------------------------------------|----------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png |초콜릿 스쿱 팩샷 |0          |
|---------|----------------------------------------------------------------------|----------|-----------|

[DEBUG] 25-10-01 23:51:18 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:18 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:18 [selectVariantGallery:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:18 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30032
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:18 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 23:51:18 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:18 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:18 [selectVariantIngredients:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:18 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30032

[INFO ] 25-10-01 23:51:18 [resultsettable:610] - 
|--------------------------------------------------------|---------------|
|ingredients_ko                                          |smartlabel_url |
|--------------------------------------------------------|---------------|
|유크림, 설탕시럽(설탕, 정제수), 탈지농축우유, 정제수, 코코아분말, 가당난황, 구아검, 카라기난 |null           |
|--------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:18 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:18 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:18 [selectVariantSourcing:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:18 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30032
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:18 [resultsettable:610] - 
|---------------|-------------------------------------------------------------|
|name_ko        |icon_url                                                     |
|---------------|-------------------------------------------------------------|
|Non-GMO        |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif        |
|Cage-Free Eggs |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp |
|Fairtrade      |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif      |
|Caring Dairy   |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif   |
|---------------|-------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:18 [selectVariantSourcing:135] - <==      Total: 4
[DEBUG] 25-10-01 23:51:18 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:18 [selectVariantCerts:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:18 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30032
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:18 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:51:18 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:18 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:18 [selectRecommendations:135] - ==> Parameters: 30032(Long)
[INFO ] 25-10-01 23:51:18 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30032
ORDER BY r.slot

[INFO ] 25-10-01 23:51:18 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30038 |mint-chocolate-chunk-ice-cream       |민트 초콜릿 청크   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png       |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|30031 |cherry-garcia-ice-cream              |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png              |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:18 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:18 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:18 [selectAvailableCategories:135] - ==> Parameters: 20014(Long)
[INFO ] 25-10-01 23:51:18 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20014
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:18 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30032 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:18 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:18 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:18 [findNextVariant:135] - ==> Parameters: 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long), 30032(Long)
[INFO ] 25-10-01 23:51:18 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30032))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30032)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30032)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30032)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:18 [resultsettable:610] - 
|------|--------------------------------------|-----------|
|id    |slug                                  |slug       |
|------|--------------------------------------|-----------|
|30033 |chocolate-chip-cookie-dough-ice-cream |scoop-shop |
|------|--------------------------------------|-----------|

[DEBUG] 25-10-01 23:51:18 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:18 [MyInterceptor:122] - running time: 85(ms)
[INFO ] 25-10-01 23:51:20 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:20 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:20 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/ice-cream-shop-flavours
[INFO ] 25-10-01 23:51:20 [MyInterceptor:101] - - REFERER : time=2179, url=http://localhost:8080/flavours/chocolate-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:51:20 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 23:51:20 [existsCategorySlug:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-01 23:51:20 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'ice-cream-shop-flavours'

[INFO ] 25-10-01 23:51:20 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|1        |
|---------|

[DEBUG] 25-10-01 23:51:20 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:20 [selectByCategory:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, f.name_ko as flavourNameKo, f.is_new as isNew, f.flavour_type_id as flavourTypeId, c.list_slug as categoryListSlug, c.name_ko as categoryNameKo, vm.url as imageUrl FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm ON vm.variant_id = v.id AND vm.role = 'PACKSHOT' WHERE v.is_active = 1 AND c.list_slug = ? ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END), f.flavour_type_id ASC, f.name_ko ASC
[DEBUG] 25-10-01 23:51:20 [selectByCategory:135] - ==> Parameters: ice-cream-shop-flavours(String)
[INFO ] 25-10-01 23:51:20 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       f.name_ko as flavourNameKo,
       f.is_new as isNew,
       f.flavour_type_id as flavourTypeId,
       c.list_slug as categoryListSlug,
       c.name_ko as categoryNameKo,
       vm.url as imageUrl
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
LEFT JOIN variant_media vm
       ON vm.variant_id = v.id AND vm.role = 'PACKSHOT'
WHERE v.is_active = 1
  AND c.list_slug = 'ice-cream-shop-flavours'
ORDER BY (CASE WHEN f.is_new = 1 THEN 0 ELSE 1 END),
         f.flavour_type_id ASC,
         f.name_ko ASC

[INFO ] 25-10-01 23:51:20 [resultsettable:610] - 
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|id    |slug                                  |name_ko         |is_new |flavour_type_id |list_slug               |name_ko |url                                                                                     |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|
|30032 |chocolate-ice-cream                   |초콜릿             |true   |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                   |
|30039 |new-york-super-fudge-chunk-ice-cream  |뉴욕 수퍼 퍼지 청크     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png  |
|30038 |mint-chocolate-chunk-ice-cream        |민트 초콜릿 청크       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/mint-chocolate-chunk-ice-cream/scoop-shop/packshot/main.png        |
|30041 |vanilla-ice-cream                     |바닐라             |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                     |
|30043 |sweet-cream-and-cookies-ice-cream     |스위트 크림&쿠키       |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/sweet-cream-and-cookies-ice-cream/scoop-shop/packshot/main.png     |
|30040 |strawberry-ice-cream                  |스트로베리           |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/strawberry-ice-cream/scoop-shop/packshot/main.png                  |
|30035 |chunky-monkey-ice-cream               |청키 몽키®          |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®        |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |
|30034 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니     |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/scoop-shop/packshot/main.png     |
|30036 |half-baked-ice-cream                  |하프베이크드®         |false  |1               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                  |
|30037 |lemonade-sorbet                       |레모네이드 소르베       |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                       |
|30042 |berry-berry-extraordinary-sorbet      |베리베리 엑스트라 오디너리® |false  |3               |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png      |
|------|--------------------------------------|----------------|-------|----------------|------------------------|--------|----------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:20 [selectByCategory:135] - <==      Total: 13
[INFO ] 25-10-01 23:51:20 [MyInterceptor:122] - running time: 51(ms)
[INFO ] 25-10-01 23:51:23 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:23 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:23 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/berry-berry-extraordinary-sorbet/
[INFO ] 25-10-01 23:51:23 [MyInterceptor:101] - - REFERER : time=2853, url=http://localhost:8080/flavours/ice-cream-shop-flavours
[DEBUG] 25-10-01 23:51:23 [existsCategorySlug:135] - ==>  Preparing: SELECT COUNT(*) FROM category WHERE list_slug = ?
[DEBUG] 25-10-01 23:51:23 [existsCategorySlug:135] - ==> Parameters: berry-berry-extraordinary-sorbet(String)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT COUNT(*)
    FROM category
    WHERE list_slug = 'berry-berry-extraordinary-sorbet'

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|---------|
|count(*) |
|---------|
|0        |
|---------|

[DEBUG] 25-10-01 23:51:23 [existsCategorySlug:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:23 [selectVariantDetailDefault:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? ORDER BY c.priority ASC LIMIT 1
[DEBUG] 25-10-01 23:51:23 [selectVariantDetailDefault:135] - ==> Parameters: berry-berry-extraordinary-sorbet(String)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT v.id         AS variantId,
       v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'berry-berry-extraordinary-sorbet'
ORDER BY c.priority ASC
LIMIT 1

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|------|------------------------------------------------------------------------|------|---------------------------------|----------------|---------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                  |id    |slug                             |name_ko         |description_ko                   |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------|------|---------------------------------|----------------|---------------------------------|-------|-----------|------------------------|--------|
|30042 |벤앤제리스만의 특별한 베리 맛, 흔하게 맛 볼 수 없는 기쁨의 맛! 상큼한 베리의 조합은 당신이 생각한 무엇보다도 놀라울 거예요 |20018 |berry-berry-extraordinary-sorbet |베리베리 엑스트라 오디너리® |블루베리와 라즈베리 등 각종 베리류가 듬뿍 들어있는 소르베 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------|------|---------------------------------|----------------|---------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:23 [selectVariantDetailDefault:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:23 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:23 [selectVariantMedia:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30042
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|---------|-----------------------------------------------------------------------------------|---------------------|-----------|
|role     |url                                                                                |alt_ko               |sort_order |
|---------|-----------------------------------------------------------------------------------|---------------------|-----------|
|PACKSHOT |/assets/img/flavours/berry-berry-extraordinary-sorbet/scoop-shop/packshot/main.png |베리베리 엑스트라 오디너리 스쿱 팩샷 |0          |
|---------|-----------------------------------------------------------------------------------|---------------------|-----------|

[DEBUG] 25-10-01 23:51:23 [selectVariantMedia:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:23 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:23 [selectVariantGallery:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30042
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|-----|----|-------|-----------|
|role |url |alt_ko |sort_order |
|-----|----|-------|-----------|
|-----|----|-------|-----------|

[DEBUG] 25-10-01 23:51:23 [selectVariantGallery:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:23 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:23 [selectVariantIngredients:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30042

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                          |smartlabel_url |
|----------------------------------------------------------------------------------------------------------------------------------------|---------------|
|물, 액상당(설탕, 물), 블루베리 농축 퓨레, 라즈베리 퓨레, 고형 옥수수 시럽, 블루베리 농축액, 설탕, 이눌린(이눌린, 설탕, 과당, 포도당), 블루베리 농축액, 레몬 농축액, 펙틴, 로커스트빈검, 덱스트로오스, 엘더베리 농축액(색소). |null           |
|----------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:23 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:23 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:23 [selectVariantSourcing:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30042
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:23 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:51:23 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:23 [selectVariantCerts:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30042
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:51:23 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:23 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:23 [selectRecommendations:135] - ==> Parameters: 30042(Long)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30042
ORDER BY r.slot

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30037 |lemonade-sorbet                      |레모네이드 소르베   |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/lemonade-sorbet/scoop-shop/packshot/main.png                      |0         |
|30032 |chocolate-ice-cream                  |초콜릿         |true   |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-ice-cream/scoop-shop/packshot/main.png                  |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:23 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:23 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:23 [selectAvailableCategories:135] - ==> Parameters: 20018(Long)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20018
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|SCOOP |scoop-shop |스쿱 샵    |30042 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:23 [selectAvailableCategories:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:23 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:23 [findNextVariant:135] - ==> Parameters: 30042(Long), 30042(Long), 30042(Long), 30042(Long), 30042(Long), 30042(Long)
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30042))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30042)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30042)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30042)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30042)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30042)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|---|-----|-----|
|id |slug |slug |
|---|-----|-----|
|---|-----|-----|

[DEBUG] 25-10-01 23:51:23 [findNextVariant:135] - <==      Total: 0
[DEBUG] 25-10-01 23:51:23 [findFirstVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:23 [findFirstVariant:135] - ==> Parameters: 
[INFO ] 25-10-01 23:51:23 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:23 [resultsettable:610] - 
|------|-------------------------------------|-----|
|id    |slug                                 |slug |
|------|-------------------------------------|-----|
|30010 |new-york-super-fudge-chunk-ice-cream |pint |
|------|-------------------------------------|-----|

[DEBUG] 25-10-01 23:51:23 [findFirstVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:23 [MyInterceptor:122] - running time: 85(ms)
[INFO ] 25-10-01 23:51:59 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:51:59 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:51:59 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[INFO ] 25-10-01 23:51:59 [MyInterceptor:101] - - REFERER : time=35620, url=http://localhost:8080/flavours/berry-berry-extraordinary-sorbet/
[DEBUG] 25-10-01 23:51:59 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:51:59 [selectVariantDetail:135] - ==> Parameters: new-york-super-fudge-chunk-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:51:59 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'new-york-super-fudge-chunk-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:51:59 [resultsettable:610] - 
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                          |id    |slug                                 |name_ko     |description_ko                              |is_new |slug       |list_slug               |name_ko |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|
|30039 |오늘부턴 나도 뉴요커! 고소한 아몬드, 호두와 풍부한 초콜릿의 맛이 당신에게 잊을 수 없는 순간을 선물합니다. 뉴욕의 풍부하고 깊은 맛을 사랑하는 사람과 함께 즐겨보세요! |20010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |화이트 & 다크 퍼지 청크, 피칸, 호두, 아몬드가 들어있는 초콜릿 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|------------------------------------------------------------------------------------------------|------|-------------------------------------|------------|--------------------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:51:59 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:59 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:51:59 [selectVariantMedia:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30039
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:51:59 [resultsettable:610] - 
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                       |alt_ko            |sort_order |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png    |뉴욕 수퍼 퍼지 청크 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|------------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-01 23:51:59 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:59 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:51:59 [selectVariantGallery:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:59 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30039
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:51:59 [resultsettable:610] - 
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                       |alt_ko |sort_order |
|--------|------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:51:59 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:59 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:51:59 [selectVariantIngredients:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:59 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30039

[INFO ] 25-10-01 23:51:59 [resultsettable:610] - 
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                |smartlabel_url |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 설탕시럽 (설탕, 정제수), 탈지우유, 정제수, 코코아, 설탕, 코코넛유, 피칸, 구운 아몬드 (아몬드, 땅콩유), 달걀 노른자, 코코아, 유지방, 소금, 콩레시틴, 바닐라 추출물, 구아검, 버터유, 땅콩유, 버터 (크림), 천연조미료, 카라기난 |null           |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:51:59 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:51:59 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:51:59 [selectVariantSourcing:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:59 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30039
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:51:59 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:51:59 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:51:59 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:51:59 [selectVariantCerts:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:59 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30039
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:51:59 [resultsettable:610] - 
|-------------|-----------------------------------------------------|
|name_ko      |icon_url                                             |
|-------------|-----------------------------------------------------|
|Kosher Dairy |/assets/img/misc/91002_Kosher_Dairy_Dietary_Icon.png |
|Gluten Free  |/assets/img/misc/91003_Gluten-free_Dietary_Icon.png  |
|-------------|-----------------------------------------------------|

[DEBUG] 25-10-01 23:51:59 [selectVariantCerts:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:59 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:51:59 [selectRecommendations:135] - ==> Parameters: 30039(Long)
[INFO ] 25-10-01 23:51:59 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30039
ORDER BY r.slot

[INFO ] 25-10-01 23:51:59 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                                |sortorder |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|
|30035 |chunky-monkey-ice-cream               |청키 몽키®      |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chunky-monkey-ice-cream/scoop-shop/packshot/main.png               |0         |
|30031 |cherry-garcia-ice-cream               |체리 가르시아®    |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/cherry-garcia-ice-cream/scoop-shop/packshot/main.png               |0         |
|30033 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png |0         |
|------|--------------------------------------|------------|-------|-----------|------------------------|--------|----------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:51:59 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:51:59 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:51:59 [selectAvailableCategories:135] - ==> Parameters: 20010(Long)
[INFO ] 25-10-01 23:51:59 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20010
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:51:59 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30010 |
|SCOOP |scoop-shop |스쿱 샵    |30039 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:51:59 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:51:59 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:51:59 [findNextVariant:135] - ==> Parameters: 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long), 30039(Long)
[INFO ] 25-10-01 23:51:59 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30039))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30039)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30039)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30039)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:51:59 [resultsettable:610] - 
|------|-------------------------------|-----------|
|id    |slug                           |slug       |
|------|-------------------------------|-----------|
|30038 |mint-chocolate-chunk-ice-cream |scoop-shop |
|------|-------------------------------|-----------|

[DEBUG] 25-10-01 23:51:59 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:51:59 [MyInterceptor:122] - running time: 119(ms)
[INFO ] 25-10-01 23:52:02 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:52:02 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:52:02 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop
[INFO ] 25-10-01 23:52:02 [MyInterceptor:101] - - REFERER : time=3070, url=http://localhost:8080/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:52:02 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:52:02 [selectVariantDetail:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String), scoop-shop(String)
[INFO ] 25-10-01 23:52:02 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
  AND c.slug = 'scoop-shop'

[INFO ] 25-10-01 23:52:02 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----------|------------------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |slug       |list_slug               |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----------|------------------------|--------|
|30033 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----------|------------------------|--------|

[DEBUG] 25-10-01 23:52:02 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:52:02 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:52:02 [selectVariantMedia:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:52:02 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30033
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:52:02 [resultsettable:610] - 
|---------|-------------------------------------------------------------------------------------------|------------------|-----------|
|role     |url                                                                                        |alt_ko            |sort_order |
|---------|-------------------------------------------------------------------------------------------|------------------|-----------|
|PACKSHOT |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/packshot/main.png    |초콜릿 칩 쿠키 도우 스쿱 팩샷 |0          |
|GALLERY  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/gallery/01-tower.png |null              |1          |
|---------|-------------------------------------------------------------------------------------------|------------------|-----------|

[DEBUG] 25-10-01 23:52:02 [selectVariantMedia:135] - <==      Total: 2
[DEBUG] 25-10-01 23:52:02 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:52:02 [selectVariantGallery:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:52:02 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30033
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:52:02 [resultsettable:610] - 
|--------|-------------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                        |alt_ko |sort_order |
|--------|-------------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop/gallery/01-tower.png |null   |1          |
|--------|-------------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:52:02 [selectVariantGallery:135] - <==      Total: 1
[DEBUG] 25-10-01 23:52:02 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:52:02 [selectVariantIngredients:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:52:02 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30033

[INFO ] 25-10-01 23:52:02 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |null           |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|

[DEBUG] 25-10-01 23:52:02 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:52:02 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:52:02 [selectVariantSourcing:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:52:02 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30033
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:52:02 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:52:02 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:52:02 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:52:02 [selectVariantCerts:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:52:02 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30033
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:52:02 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:52:02 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:52:02 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:52:02 [selectRecommendations:135] - ==> Parameters: 30033(Long)
[INFO ] 25-10-01 23:52:02 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30033
ORDER BY r.slot

[INFO ] 25-10-01 23:52:02 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug       |list_slug               |name_ko |imageurl                                                                               |sortorder |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|
|30041 |vanilla-ice-cream                    |바닐라         |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/vanilla-ice-cream/scoop-shop/packshot/main.png                    |0         |
|30036 |half-baked-ice-cream                 |하프베이크드®     |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/half-baked-ice-cream/scoop-shop/packshot/main.png                 |0         |
|30039 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |scoop-shop |ice-cream-shop-flavours |스쿱 샵    |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/scoop-shop/packshot/main.png |0         |
|------|-------------------------------------|------------|-------|-----------|------------------------|--------|---------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:52:02 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:52:02 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:52:02 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-01 23:52:02 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:52:02 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:52:02 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:52:02 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:52:02 [findNextVariant:135] - ==> Parameters: 30033(Long), 30033(Long), 30033(Long), 30033(Long), 30033(Long), 30033(Long)
[INFO ] 25-10-01 23:52:02 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30033))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30033)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30033)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30033)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30033)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30033)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:52:02 [resultsettable:610] - 
|------|----------------------------------|-----------|
|id    |slug                              |slug       |
|------|----------------------------------|-----------|
|30034 |chocolate-fudge-brownie-ice-cream |scoop-shop |
|------|----------------------------------|-----------|

[DEBUG] 25-10-01 23:52:02 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:52:02 [MyInterceptor:122] - running time: 90(ms)
[INFO ] 25-10-01 23:52:04 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:52:04 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:52:04 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/pint
[INFO ] 25-10-01 23:52:04 [MyInterceptor:101] - - REFERER : time=2258, url=http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/scoop-shop
[DEBUG] 25-10-01 23:52:04 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:52:04 [selectVariantDetail:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:52:04 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:52:04 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|30005 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:52:04 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:52:04 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:52:04 [selectVariantMedia:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:04 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30005
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:52:04 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                      |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png        |초콜릿 칩 쿠키 도우 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null               |5          |
|NUTRITION |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:52:04 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:52:04 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:52:04 [selectVariantGallery:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:04 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30005
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:52:04 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                      |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null   |5          |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:52:04 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:52:04 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:52:04 [selectVariantIngredients:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:04 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30005

[INFO ] 25-10-01 23:52:04 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100583-0002-en-US-1669211882662/index.html |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:52:04 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:52:04 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:52:04 [selectVariantSourcing:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:04 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30005
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:52:04 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:52:04 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:52:04 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:52:04 [selectVariantCerts:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:04 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30005
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:52:04 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:52:04 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:52:04 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:52:04 [selectRecommendations:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:04 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30005
ORDER BY r.slot

[INFO ] 25-10-01 23:52:04 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30013 |vanilla-ice-cream                    |바닐라         |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                    |5         |
|30002 |half-baked-ice-cream                 |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:52:04 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:52:04 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:52:04 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-01 23:52:04 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:52:04 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:52:04 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:52:04 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:52:04 [findNextVariant:135] - ==> Parameters: 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long)
[INFO ] 25-10-01 23:52:04 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30005))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30005)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:52:04 [resultsettable:610] - 
|------|----------------------------------|-----|
|id    |slug                              |slug |
|------|----------------------------------|-----|
|30003 |chocolate-fudge-brownie-ice-cream |pint |
|------|----------------------------------|-----|

[DEBUG] 25-10-01 23:52:04 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:52:04 [MyInterceptor:122] - running time: 120(ms)
[INFO ] 25-10-01 23:52:08 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:52:08 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:52:08 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/half-baked-ice-cream/pint
[INFO ] 25-10-01 23:52:08 [MyInterceptor:101] - - REFERER : time=3533, url=http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/pint
[DEBUG] 25-10-01 23:52:08 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:52:08 [selectVariantDetail:135] - ==> Parameters: half-baked-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:52:08 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'half-baked-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:52:08 [resultsettable:610] - 
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                                                                                                                                                                                                                         |id    |slug                 |name_ko |description_ko                                   |is_new |slug |list_slug       |name_ko |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|-----|----------------|--------|
|30002 |우리는 스쿱샵에 들릴 때 마다 우리의 친구들이 가장 맛있을 법한 새롭고 쿨한 콤보를 만들기 위해 다양한 맛의 조합을 시도하는 것을 알게 되었습니다. 그때 우리는 이것이 정말 엄청난 아이디어라고 생각 했어요. 그래서 우리는 여러분이 사랑하는 벤앤제리스의 맛과 절묘하게 어우러진 새로운 맛을 찾기 위해 여러분이 새롭게 조합한 맛을 함께 섞어 보았습니다. 여러분은 우리가 엉뚱하다고 말할지도 모르겠지만, 우리는 말할 수 있어요. 이건 하프 베이크드 라고 해! Enjoy! 벤앤제리스를 사랑하는 모든 이들에게 감사해요. |20002 |half-baked-ice-cream |하프베이크드® |초코칩 쿠키도우와 퍼지 브라우니의 청크가 절묘하게 어우러진 초콜릿 & 바닐라 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|---------------------|--------|-------------------------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:52:08 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:52:08 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:52:08 [selectVariantMedia:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:52:08 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30002
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:52:08 [resultsettable:610] - 
|----------|------------------------------------------------------------------------|--------------|-----------|
|role      |url                                                                     |alt_ko        |sort_order |
|----------|------------------------------------------------------------------------|--------------|-----------|
|PACKSHOT  |/assets/img/flavours/half-baked-ice-cream/pint/packshot/main.png        |하프베이크드 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/01-tower.png     |null          |1          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/02-envirolid.jpg |null          |2          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/03-scooped.jpg   |null          |3          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/04-enviro.jpg    |null          |4          |
|GALLERY   |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg      |null          |5          |
|NUTRITION |/assets/img/flavours/half-baked-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml   |0          |
|----------|------------------------------------------------------------------------|--------------|-----------|

[DEBUG] 25-10-01 23:52:08 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:52:08 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:52:08 [selectVariantGallery:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:52:08 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30002
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:52:08 [resultsettable:610] - 
|--------|------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                     |alt_ko |sort_order |
|--------|------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg      |null   |5          |
|--------|------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:52:08 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:52:08 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:52:08 [selectVariantIngredients:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:52:08 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30002

[INFO ] 25-10-01 23:52:08 [resultsettable:610] - 
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                     |smartlabel_url                                                                                                           |
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|크림, 설탕시럽, 탈지농축우유, 정제수, 설탕, 밀가루, 코코아분말, 갈색 설탕, 가당난황, 대두유, 버터, 계란, 전화당, 초콜릿 리커, 바닐라 추출물, 소금, 계란 흰자, 구아검, 카라기난, 당밀, 코코아버터, 천연향료, 맥아분말 |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840101320-0002-en-US-1669212157071/index.html#nutrition |
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:52:08 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:52:08 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:52:08 [selectVariantSourcing:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:52:08 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30002
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:52:08 [resultsettable:610] - 
|----------------|--------------------------------------------------------------|
|name_ko         |icon_url                                                      |
|----------------|--------------------------------------------------------------|
|Non-GMO         |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif         |
|Fairtrade       |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif       |
|Free Range Eggs |/assets/img/misc/90003_Free-range_Eggs_VLS_Simpler_Icons.webp |
|----------------|--------------------------------------------------------------|

[DEBUG] 25-10-01 23:52:08 [selectVariantSourcing:135] - <==      Total: 3
[DEBUG] 25-10-01 23:52:08 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:52:08 [selectVariantCerts:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:52:08 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30002
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:52:08 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:52:08 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:52:08 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:52:08 [selectRecommendations:135] - ==> Parameters: 30002(Long)
[INFO ] 25-10-01 23:52:08 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30002
ORDER BY r.slot

[INFO ] 25-10-01 23:52:08 [resultsettable:610] - 
|------|--------------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------------|----------|
|id    |slug                                  |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                            |sortorder |
|------|--------------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------------|----------|
|30005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png |5         |
|30003 |chocolate-fudge-brownie-ice-cream     |초콜릿 퍼지 브라우니 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/chocolate-fudge-brownie-ice-cream/pint/gallery/05-hero.jpg     |5         |
|30009 |mint-chocolate-cookie-ice-cream       |민트 초콜릿 칩 쿠키 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/mint-chocolate-cookie-ice-cream/pint/gallery/05-hero.jpg       |5         |
|------|--------------------------------------|------------|-------|-----|----------------|--------|------------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:52:08 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:52:08 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:52:08 [selectAvailableCategories:135] - ==> Parameters: 20002(Long)
[INFO ] 25-10-01 23:52:08 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20002
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:52:08 [resultsettable:610] - 
|------|-----------|--------|------|
|code  |slug       |name_ko |id    |
|------|-----------|--------|------|
|PINT  |pint       |파인트     |30002 |
|SCOOP |scoop-shop |스쿱 샵    |30036 |
|------|-----------|--------|------|

[DEBUG] 25-10-01 23:52:08 [selectAvailableCategories:135] - <==      Total: 2
[DEBUG] 25-10-01 23:52:08 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:52:08 [findNextVariant:135] - ==> Parameters: 30002(Long), 30002(Long), 30002(Long), 30002(Long), 30002(Long), 30002(Long)
[INFO ] 25-10-01 23:52:08 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30002))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30002)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30002)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30002)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30002)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30002)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:52:08 [resultsettable:610] - 
|------|-------------------|-----|
|id    |slug               |slug |
|------|-------------------|-----|
|30008 |karamel-sutra-core |pint |
|------|-------------------|-----|

[DEBUG] 25-10-01 23:52:08 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:52:08 [MyInterceptor:122] - running time: 87(ms)
[INFO ] 25-10-01 23:52:12 [MyInterceptor:47] - ---------- new client connect ----------
[INFO ] 25-10-01 23:52:12 [MyInterceptor:67] - [Client] 0:0:0:0:0:0:0:1, Mac, Mac OS X 10.15, Chrome 139.0
[INFO ] 25-10-01 23:52:12 [MyInterceptor:85] - [GET] http://localhost:8080/flavours/chocolate-chip-cookie-dough-ice-cream/pint
[INFO ] 25-10-01 23:52:12 [MyInterceptor:101] - - REFERER : time=3826, url=http://localhost:8080/flavours/half-baked-ice-cream/pint
[DEBUG] 25-10-01 23:52:12 [selectVariantDetail:135] - ==>  Preparing: SELECT v.id AS variantId, v.variant_description_ko AS variantDescriptionKo, f.id AS flavourId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.description_ko AS flavourDescriptionKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND f.slug = ? AND c.slug = ?
[DEBUG] 25-10-01 23:52:12 [selectVariantDetail:135] - ==> Parameters: chocolate-chip-cookie-dough-ice-cream(String), pint(String)
[INFO ] 25-10-01 23:52:12 [sqlonly:228] - SELECT v.id         AS variantId,
      v.variant_description_ko     AS variantDescriptionKo,
       f.id         AS flavourId,
       f.slug       AS flavourSlug,
       f.name_ko    AS flavourNameKo,
       f.description_ko AS flavourDescriptionKo,
       f.is_new     AS isNew,
       c.slug       AS categorySlug,
       c.list_slug  AS categoryListSlug,
       c.name_ko    AS categoryNameKo
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND f.slug = 'chocolate-chip-cookie-dough-ice-cream'
  AND c.slug = 'pint'

[INFO ] 25-10-01 23:52:12 [resultsettable:610] - 
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|id    |variant_description_ko                                                                        |id    |slug                                  |name_ko     |description_ko                     |is_new |slug |list_slug       |name_ko |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|
|30005 |크리미 바닐라 아이스크림이 커다란 초콜릿 칩 쿠키 도우 덩어리를 부드럽게 감싸며 조화를 이룹니다. 요즘은 그렇게 생각하지 않지만, 1984년에는 혁명적인 맛이었습니다. |20005 |chocolate-chip-cookie-dough-ice-cream |초콜릿 칩 쿠키 도우 |초콜릿 칩 쿠키 도우의 퍼지 덩어리가 들어간 바닐라 아이스크림 |false  |pint |ice-cream-pints |파인트     |
|------|----------------------------------------------------------------------------------------------|------|--------------------------------------|------------|-----------------------------------|-------|-----|----------------|--------|

[DEBUG] 25-10-01 23:52:12 [selectVariantDetail:135] - <==      Total: 1
[DEBUG] 25-10-01 23:52:12 [selectVariantMedia:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? ORDER BY role, sort_order
[DEBUG] 25-10-01 23:52:12 [selectVariantMedia:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:12 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
  FROM variant_media
  WHERE variant_id = 30005
  ORDER BY role, sort_order

[INFO ] 25-10-01 23:52:12 [resultsettable:610] - 
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|role      |url                                                                                      |alt_ko             |sort_order |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|
|PACKSHOT  |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/packshot/main.png        |초콜릿 칩 쿠키 도우 파인트 팩샷 |0          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null               |1          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null               |2          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null               |3          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null               |4          |
|GALLERY   |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null               |5          |
|NUTRITION |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/nutrition/473ml.png      |영양성분표 473ml        |0          |
|----------|-----------------------------------------------------------------------------------------|-------------------|-----------|

[DEBUG] 25-10-01 23:52:12 [selectVariantMedia:135] - <==      Total: 7
[DEBUG] 25-10-01 23:52:12 [selectVariantGallery:135] - ==>  Preparing: SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder FROM variant_media WHERE variant_id = ? AND role = 'GALLERY' ORDER BY sort_order
[DEBUG] 25-10-01 23:52:12 [selectVariantGallery:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:12 [sqlonly:228] - SELECT role, url, alt_ko AS altKo, sort_order AS sortOrder
FROM variant_media
WHERE variant_id = 30005
  AND role = 'GALLERY'
ORDER BY sort_order

[INFO ] 25-10-01 23:52:12 [resultsettable:610] - 
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|role    |url                                                                                      |alt_ko |sort_order |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/01-tower.png     |null   |1          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/02-envirolid.jpg |null   |2          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/03-scooped.jpg   |null   |3          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/04-enviro.jpg    |null   |4          |
|GALLERY |/assets/img/flavours/chocolate-chip-cookie-dough-ice-cream/pint/gallery/05-hero.png      |null   |5          |
|--------|-----------------------------------------------------------------------------------------|-------|-----------|

[DEBUG] 25-10-01 23:52:12 [selectVariantGallery:135] - <==      Total: 5
[DEBUG] 25-10-01 23:52:12 [selectVariantIngredients:135] - ==>  Preparing: SELECT ingredients_ko as ingredientsKo, smartlabel_url as smartlabelUrl FROM variant_ingredients WHERE variant_id = ?
[DEBUG] 25-10-01 23:52:12 [selectVariantIngredients:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:12 [sqlonly:228] - SELECT ingredients_ko as ingredientsKo,
       smartlabel_url as smartlabelUrl
FROM variant_ingredients
WHERE variant_id = 30005

[INFO ] 25-10-01 23:52:12 [resultsettable:610] - 
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|ingredients_ko                                                                                                                                                     |smartlabel_url                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|크림, 농축 탈지유, 액상당, 물, 표백하지 않은 밀가루, 설탕, 황설탕, 계란 노른자, 버터, 대두유, 계란, 코코넛 오일, 카카오 매스, 바닐라 추출물, 코코아 파우더, 소금, 농후제(구아검, 카라기난), 당밀, 코코아 버터, 천연착향료, 천연조미료, 버터 오일, 유화제(대두 레시틴). |https://smartlabel.scanbuy.com/3kDXaw4KiY2GQD9DU6973N/preview/076840100583-0002-en-US-1669211882662/index.html |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:52:12 [selectVariantIngredients:135] - <==      Total: 1
[DEBUG] 25-10-01 23:52:12 [selectVariantSourcing:135] - ==>  Preparing: SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl FROM variant_sourcing vs JOIN sourcing_feature sf ON vs.feature_id = sf.id WHERE vs.variant_id = ? ORDER BY vs.sort_order
[DEBUG] 25-10-01 23:52:12 [selectVariantSourcing:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:12 [sqlonly:228] - SELECT sf.name_ko as nameKo, sf.icon_url as iconUrl
FROM variant_sourcing vs
JOIN sourcing_feature sf ON vs.feature_id = sf.id
WHERE vs.variant_id = 30005
ORDER BY vs.sort_order

[INFO ] 25-10-01 23:52:12 [resultsettable:610] - 
|------------------------------|----------------------------------------------------------------------------|
|name_ko                       |icon_url                                                                    |
|------------------------------|----------------------------------------------------------------------------|
|Non-GMO                       |/assets/img/misc/90001_Non-GMO_VLS_Simpler_Icons.avif                       |
|Cage-Free Eggs                |/assets/img/misc/90002_Cage-free_Eggs_VLS_Simpler_Icons.webp                |
|Fairtrade                     |/assets/img/misc/90004_Fairtrade_VLS_Simpler_Icons.avif                     |
|Caring Dairy                  |/assets/img/misc/90005_Caring_Dairy_VLS_Simpler_Icons.avif                  |
|Responsibly Sourced Packaging |/assets/img/misc/90006_Responsibly_Sourced_Packaging_VLS_Simpler_Icons.avif |
|------------------------------|----------------------------------------------------------------------------|

[DEBUG] 25-10-01 23:52:12 [selectVariantSourcing:135] - <==      Total: 5
[DEBUG] 25-10-01 23:52:12 [selectVariantCerts:135] - ==>  Preparing: SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl FROM variant_cert vc JOIN dietary_cert dc ON vc.cert_id = dc.id WHERE vc.variant_id = ? ORDER BY vc.sort_order
[DEBUG] 25-10-01 23:52:12 [selectVariantCerts:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:12 [sqlonly:228] - SELECT dc.name_ko as nameKo, dc.icon_url as iconUrl
FROM variant_cert vc
JOIN dietary_cert dc ON vc.cert_id = dc.id
WHERE vc.variant_id = 30005
ORDER BY vc.sort_order

[INFO ] 25-10-01 23:52:12 [resultsettable:610] - 
|--------|---------|
|name_ko |icon_url |
|--------|---------|
|--------|---------|

[DEBUG] 25-10-01 23:52:12 [selectVariantCerts:135] - <==      Total: 0
[DEBUG] 25-10-01 23:52:12 [selectRecommendations:135] - ==>  Preparing: SELECT v.id AS variantId, f.slug AS flavourSlug, f.name_ko AS flavourNameKo, f.is_new AS isNew, c.slug AS categorySlug, c.list_slug AS categoryListSlug, c.name_ko AS categoryNameKo, COALESCE(vm_g5.url, vm_p.url) AS imageUrl, COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder FROM variant_reco r JOIN product_variant v ON r.target_variant_id = v.id JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id LEFT JOIN variant_media vm_p ON vm_p.variant_id = v.id AND vm_p.role = 'PACKSHOT' LEFT JOIN variant_media vm_g5 ON vm_g5.variant_id = v.id AND vm_g5.role = 'GALLERY' AND vm_g5.gallery_num_prefix = 5 WHERE r.source_variant_id = ? ORDER BY r.slot
[DEBUG] 25-10-01 23:52:12 [selectRecommendations:135] - ==> Parameters: 30005(Long)
[INFO ] 25-10-01 23:52:12 [sqlonly:228] - SELECT
    v.id AS variantId,
    f.slug AS flavourSlug,
    f.name_ko AS flavourNameKo,
    f.is_new AS isNew,
    c.slug AS categorySlug,
    c.list_slug AS categoryListSlug,
    c.name_ko AS categoryNameKo,

    COALESCE(vm_g5.url, vm_p.url)       AS imageUrl,
    COALESCE(vm_g5.sort_order, vm_p.sort_order) AS sortOrder

FROM variant_reco r
JOIN product_variant v ON r.target_variant_id = v.id
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id

LEFT JOIN variant_media vm_p
       ON vm_p.variant_id = v.id
      AND vm_p.role = 'PACKSHOT'

LEFT JOIN variant_media vm_g5
       ON vm_g5.variant_id = v.id
      AND vm_g5.role = 'GALLERY'
      AND vm_g5.gallery_num_prefix = 5

WHERE r.source_variant_id = 30005
ORDER BY r.slot

[INFO ] 25-10-01 23:52:12 [resultsettable:610] - 
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|id    |slug                                 |name_ko     |is_new |slug |list_slug       |name_ko |imageurl                                                                           |sortorder |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|
|30013 |vanilla-ice-cream                    |바닐라         |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/vanilla-ice-cream/pint/gallery/05-hero.jpg                    |5         |
|30002 |half-baked-ice-cream                 |하프베이크드®     |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/half-baked-ice-cream/pint/gallery/05-hero.jpg                 |5         |
|30010 |new-york-super-fudge-chunk-ice-cream |뉴욕 수퍼 퍼지 청크 |false  |pint |ice-cream-pints |파인트     |/assets/img/flavours/new-york-super-fudge-chunk-ice-cream/pint/gallery/05-hero.jpg |5         |
|------|-------------------------------------|------------|-------|-----|----------------|--------|-----------------------------------------------------------------------------------|----------|

[DEBUG] 25-10-01 23:52:12 [selectRecommendations:135] - <==      Total: 3
[DEBUG] 25-10-01 23:52:12 [selectAvailableCategories:135] - ==>  Preparing: SELECT c.code, c.slug AS slug, c.name_ko AS nameKo, v.id AS variantId FROM product_variant v JOIN category c ON v.category_id = c.id WHERE v.flavour_id = ? AND v.is_active = 1 ORDER BY c.priority
[DEBUG] 25-10-01 23:52:12 [selectAvailableCategories:135] - ==> Parameters: 20005(Long)
[INFO ] 25-10-01 23:52:12 [sqlonly:228] - SELECT c.code,
       c.slug       AS slug,
       c.name_ko    AS nameKo,
       v.id         AS variantId
FROM product_variant v
JOIN category c ON v.category_id = c.id
WHERE v.flavour_id = 20005
  AND v.is_active = 1
ORDER BY c.priority

[INFO ] 25-10-01 23:52:12 [resultsettable:610] - 
|---------|-----------|--------|------|
|code     |slug       |name_ko |id    |
|---------|-----------|--------|------|
|PINT     |pint       |파인트     |30005 |
|MINI_CUP |mini-cup   |미니컵     |30022 |
|SCOOP    |scoop-shop |스쿱 샵    |30033 |
|---------|-----------|--------|------|

[DEBUG] 25-10-01 23:52:12 [selectAvailableCategories:135] - <==      Total: 3
[DEBUG] 25-10-01 23:52:12 [findNextVariant:135] - ==>  Preparing: SELECT v.id as variantId, f.slug as flavourSlug, c.slug as categorySlug FROM product_variant v JOIN flavour f ON v.flavour_id = f.id JOIN category c ON v.category_id = c.id WHERE v.is_active = 1 AND ( (c.priority > (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?)) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id > (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) OR ( c.priority = (SELECT c2.priority FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id JOIN category c2 ON pv2.category_id = c2.id WHERE pv2.id = ?) AND f.flavour_type_id = (SELECT f2.flavour_type_id FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) AND f.name_ko > (SELECT f2.name_ko FROM product_variant pv2 JOIN flavour f2 ON pv2.flavour_id = f2.id WHERE pv2.id = ?) ) ) ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC LIMIT 1
[DEBUG] 25-10-01 23:52:12 [findNextVariant:135] - ==> Parameters: 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long), 30005(Long)
[INFO ] 25-10-01 23:52:12 [sqlonly:228] - SELECT v.id as variantId,
       f.slug as flavourSlug,
       c.slug as categorySlug
FROM product_variant v
JOIN flavour f ON v.flavour_id = f.id
JOIN category c ON v.category_id = c.id
WHERE v.is_active = 1
  AND (
    (c.priority > (SELECT c2.priority
                   FROM product_variant pv2
                   JOIN flavour f2 ON pv2.flavour_id = f2.id
                   JOIN category c2 ON pv2.category_id = c2.id
                   WHERE pv2.id = 30005))
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id > (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
    )
    OR (
      c.priority = (SELECT c2.priority
                    FROM product_variant pv2
                    JOIN flavour f2 ON pv2.flavour_id = f2.id
                    JOIN category c2 ON pv2.category_id = c2.id
                    WHERE pv2.id = 30005)
      AND f.flavour_type_id = (SELECT f2.flavour_type_id
                               FROM product_variant pv2
                               JOIN flavour f2 ON pv2.flavour_id = f2.id
                               WHERE pv2.id = 30005)
      AND f.name_ko > (SELECT f2.name_ko
                       FROM product_variant pv2
                       JOIN flavour f2 ON pv2.flavour_id = f2.id
                       WHERE pv2.id = 30005)
    )
  )
ORDER BY c.priority ASC, f.flavour_type_id ASC, f.name_ko ASC
LIMIT 1

[INFO ] 25-10-01 23:52:12 [resultsettable:610] - 
|------|----------------------------------|-----|
|id    |slug                              |slug |
|------|----------------------------------|-----|
|30003 |chocolate-fudge-brownie-ice-cream |pint |
|------|----------------------------------|-----|

[DEBUG] 25-10-01 23:52:12 [findNextVariant:135] - <==      Total: 1
[INFO ] 25-10-01 23:52:12 [MyInterceptor:122] - running time: 76(ms)
